<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MARKSZのBlog</title>
  <subtitle>Do what you love,Love what you do</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://molunerfinn.com/"/>
  <updated>2017-01-29T12:15:07.000Z</updated>
  <id>https://molunerfinn.com/</id>
  
  <author>
    <name>Molunerfinn</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>一周一部好电影IV【WEEK148】总有一天</title>
    <link href="https://molunerfinn.com/PerfectMoviePerWeek4/"/>
    <id>https://molunerfinn.com/PerfectMoviePerWeek4/</id>
    <published>2017-01-29T12:15:00.000Z</published>
    <updated>2017-01-29T12:15:07.000Z</updated>
    
    <content type="html">&lt;p&gt;2017-01-29 WEEK148 总有一天 &lt;/p&gt;
&lt;p&gt;总有一天——————————————Der kommer en dag&lt;br&gt;&lt;img src=&quot;https://img.piegg.cn/week148.jpg?imageslim&quot; alt=&quot;总有一天&quot; title=&quot;总有一天&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演：杰斯珀·W·尼尔森&lt;/li&gt;
&lt;li&gt;主演：拉斯·米克尔森/苏菲·格拉宝/哈拉尔德·凯泽·赫尔曼/艾伯特·鲁德贝克·林哈特/劳里斯·斯科夫高·安德森/拉斯·兰特/索伦·希特-拉森/大卫·丹席克/松佳·里奇特/索比亚格·侯菲尔德/雅各布·B·恩格曼/&lt;/li&gt;
&lt;li&gt;片长：110分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.7/10(from8,721users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.7/10(from688users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。首先祝大家2017年，新年快乐！&lt;/p&gt;
&lt;p&gt;作为2017年农历新年推荐的第一部电影，必然是质量上乘的。这部来自丹麦的电影，改编自真实故事，发人深省而又感人肺腑。&lt;/p&gt;
&lt;p&gt;看这部电影的同时，可以联想国内类似的杨永信“电疗戒网瘾”的例子。只不过，杨永信是当代的例子，而本片里的情况出现在上世纪60年代的丹麦。无助，绝望，乃至内心扭曲。在故事发生的学校里，你可以看到一群“行尸走肉”般，被“驯服”的孩子。有苦说不出，反抗无力，孤立无助。在这种环境下，还要遭受禽兽老师的摧残，校长、助理的掌掴。而唯一带有良知的老师却也只是看不下去而辞职。一切似乎没有办法逆转，一切似乎都显得那么黑暗。&lt;/p&gt;
&lt;p&gt;而两个小主人公却是从头至尾给本片注入了灵魂。注入了追求自由，敢于反抗，友善热心的灵魂。我最感动的一个画面是哥哥拿一个“私藏”的巧克力给弟弟吃的时候，弟弟只吃了一口就分给眼馋的同伴们——哪怕这些同伴前一秒还在奚落他。融入集体是不容易的，融入一个这样“黑暗”的集体更是不容易。不过是兄弟俩给这群孩子带去了希望，带去了光明。&lt;/p&gt;
&lt;p&gt;总有一天，这到底是哪一天呢？不知道，但是虽然孩子们遭受了种种令人愤慨的折磨，总归是有正义降临的那天。这一天的风景是多么美，这一天的阳光是多么灿烂。也许此时此刻还有无数类似的孤儿院、学校有类似的情况，但是你不知道。没有亲身经历，你永远不知道，哪怕总有一天，你也不知道是哪一天。好电影，值得一看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2017-01-19 WEEK147 攻壳机动队 &lt;/p&gt;
&lt;p&gt;攻壳机动队——————————————攻殻機動隊&lt;br&gt;&lt;img src=&quot;https://img.piegg.cn/week147.jpg&quot; alt=&quot;攻壳机动队&quot; title=&quot;攻壳机动队&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：押井守&lt;/li&gt;
&lt;li&gt;主演：田中敦子/大塚明夫/山寺宏一/大木民夫/家弓家正/仲野裕/&lt;/li&gt;
&lt;li&gt;片长：83分钟&lt;/li&gt;
&lt;li&gt;影  片类型：动作/科幻/动画/悬疑/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.9/10(from43,836users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.0/10(from85,436users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。本周给大家推荐的是一部很早以前的动画电影——《攻壳机动队》。相信不少人已经看过或者听过这部作品的名字。直到我自己22年后看到这部电影，真的觉得依然思想很伟大。&lt;/p&gt;
&lt;p&gt;作为一部科幻动画电影，它将思考放在了现在都未达到的公元2029年。人类文明没有达到非常逆天的程度却也诞生了机器与灵魂结合的“人”，而在此之上，极具思辨的观点，灵魂和躯体之间到底有没有具体关系，灵魂能不能超脱躯体？自我意识的存在依赖于什么。。等等。&lt;/p&gt;
&lt;p&gt;这部电影披着一层动画的壳，但是思考问题深度却远远超过壳本身。据说《黑客帝国》也深深收到它的影响，可想而知这部电影的伟大之处。而它的英文名也发人深省《Ghost in Shell》，躯壳下的灵魂。如果你是个喜爱烧脑的，喜欢思考这类高深哲学的人，那么它绝对是不容错过的。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2017-01-09 WEEK146 白日梦想家 &lt;/p&gt;
&lt;p&gt;白日梦想家——————————————The Secret Life of Walter Mitty&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week146.jpg&quot; alt=&quot;白日梦想家&quot; title=&quot;白日梦想家&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：本·斯蒂勒&lt;/li&gt;
&lt;li&gt;主演：本·斯蒂勒/克里斯汀·韦格/亚当·斯科特/雪莉·麦克雷恩/西恩·潘/凯瑟琳·哈恩/泰伦斯·伯尼·海恩斯 /保罗·菲兹杰拉德/格蕾丝·雷克斯/乔恩·戴利/乔伊·斯洛特尼克&lt;/li&gt;
&lt;li&gt;片长：114分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧/冒险&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.3/10(from124,623users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.3/10(from243,738users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。本周给大家推荐的是一部轻松诙谐的喜剧电影《白日梦想家》。但是本片的中文翻译其实并不是特别能很好的描述本片的主题。如果叫做《白日冒险家》可能更好一点？&lt;/p&gt;
&lt;p&gt;我很喜欢本片的宣传语：&lt;code&gt;Stop Dreaming,Start Living&lt;/code&gt;（不要做白日梦了，拥抱生活吧）。主人公是个爱做白日梦的公司职员，说是整天沉浸在自己的意淫的世界里也不为过。不过因为一起突发事件他却不得不&lt;code&gt;To see the world&lt;/code&gt;，于是开始了正片。喜欢本片的人大概跟我一样吧，影片的风景确实拍的相当漂亮，而且故事一串接着一串，虽然有些夸张有些巧合，但是不可否认观影体验相当棒！我最喜欢的片段是主人公溜着滑板沿着公路俯冲而下的片段，那个片段看着真的感觉，这才是生活啊，这才是&lt;code&gt;Start Living&lt;/code&gt;啊。&lt;/p&gt;
&lt;p&gt;不出意料的Happy Ending，也给本片观众灌了一碗大鸡汤。Anyway，如果是想茶余饭后放松心情，喝喝鸡汤，看看风景，享受生活，那么本片绝对是不二之选。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2017-01-02 WEEK145 45周年 &lt;/p&gt;
&lt;p&gt;45周年——————————————45 Years&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week145.jpg&quot; alt=&quot;45周年&quot; title=&quot;45周年&quot;&gt;&lt;br&gt;&lt;!--more--&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：安德鲁·海格&lt;/li&gt;
&lt;li&gt;主演：夏洛特·兰普林/多莉·韦尔斯/汤姆·康特奈/杰拉丁妮·詹姆斯/山姆·亚历山大/麦克斯·路德/大卫·西布利/汉娜·查尔莫斯/理查德·坎宁汉姆/米歇尔·芬奇/保罗·戈德史密斯&lt;/li&gt;
&lt;li&gt;片长：95分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/爱情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.7/10(from19,384users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.1/10(from21,005users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。最近推电影的时间总是乱糟糟的，这段时间比较忙，之后会逐步走回正规的，十分抱歉！&lt;/p&gt;
&lt;p&gt;新年给大家推荐的第一部电影，是来自英国的《45周年》。这部电影讲述了两位老人的爱情故事——或者说是爱情悲剧故事？影片从即将迎来结婚45周年之前的6天开始说起，一起突发的事件，打破了45年来的“平静”。按理说能够相扶相伴了45年的老夫老妻，感情应该是十分深厚了。然而在本片的故事设定下，却让一切都打碎。如果说《消失的爱人》这部电影让你后怕不以但是仔细想想生活中发生类似的事情的情况毕竟还是少数，那么这部电影就会给所有的情侣一个警钟——毕竟它太有可能了，并且真的时常就在我们的周围发生类似的事。&lt;/p&gt;
&lt;p&gt;虽然是50年被冰封的记忆，却始终无法消融。用一生的真情换来一生的替代，想必换作是谁都无法接受吧。影片的最后，伴随着极富隐喻的音乐的落幕，女主迅速的抽手，让一切的“美好”彻底破碎，为之动容。本片的两位主演不愧是老戏骨，张弛有度而且让你感慨万分。好电影，值得一看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-12-26 WEEK144 窃听风暴&lt;/p&gt;
&lt;p&gt;窃听风暴——————————————Das Leben der Anderen&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week144.jpg&quot; alt=&quot;窃听风暴&quot; title=&quot;窃听风暴&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：弗洛里安·亨克尔·冯·多纳斯马&lt;/li&gt;
&lt;li&gt;主演：乌尔里希·穆埃/马蒂娜·戈黛特/塞巴斯蒂安·科赫/乌尔里奇·图克尔/托马斯·席尔梅&lt;/li&gt;
&lt;li&gt;片长：137分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/悬疑&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.1/10(from195,431users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.5/10(from268,134users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。本期给大家带来的又是一部来自德国的电影《窃听风暴》这部电影从一个很“刁钻”的角度切入，向我们还原了当时的东德残酷的社会现实。&lt;/p&gt;
&lt;p&gt;在那个年代，东德有很多秘密警察，负责监视、监听人民的一举一动。有可能一句玩笑话，一个不经意的举动就让他们遭到牢狱之灾。而本片正是通过一个监听特工的视角，去描绘了当时的社会是多么灰暗，高层是多么腐朽。而在这监听的过程中的人性的转变亦是本片最精华最感人的部分——&lt;/p&gt;
&lt;p&gt;主演乌尔里希·穆埃生动地演绎了一个国家机器下的特工从坚定不移地遵守指令到“良心”发现-》感受到了什么是黑暗，什么才是真正的自由和民主的转变。&lt;/p&gt;
&lt;p&gt;去翻阅本片的背景故事的时候有两则小故事让我非常震惊：&lt;/p&gt;
&lt;p&gt;1.东诺士马克的电影用了很多当初东德的机关大楼实地拍摄， 但是监狱博物馆的馆长却拒绝了他拍摄的请求。原因？馆长说，因为东诺士马克的剧本不符合史实:整个东德历史，像魏斯乐那样“良心发现”的秘密警察，对不起，一个都没有。&lt;br&gt;2.主演乌尔里希·穆埃的前妻，曾经也是秘密警察的线民，长期监控自己的丈夫，而这些记录是在两德统一之后，主演去翻看自己的档案的时候才发现的。&lt;/p&gt;
&lt;p&gt;这是一部献给好人的奏鸣曲，好电影，值得观看。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;2017-01-29 WEEK148 总有一天 &lt;/p&gt;
&lt;p&gt;总有一天——————————————Der kommer en dag&lt;br&gt;&lt;img src=&quot;https://img.piegg.cn/week148.jpg?imageslim&quot; alt=&quot;总有一天&quot; title=&quot;总有一天&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E6%97%A5%E5%BF%97/"/>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E6%97%A5%E5%BF%97/%E5%91%A8%E7%94%B5/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>2016小结</title>
    <link href="https://molunerfinn.com/2016/"/>
    <id>https://molunerfinn.com/2016/</id>
    <published>2017-01-27T08:11:00.000Z</published>
    <updated>2017-01-27T09:08:34.000Z</updated>
    
    <content type="html">&lt;p&gt;终于又到了一年一度的春节啦。旧的一年的总结当然是要放在农历新年之前啦，这才是过年吧。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;列个小清单吧。&lt;/p&gt;
&lt;h1 id=&quot;过去的一年&quot;&gt;过去的一年&lt;/h1&gt;&lt;h2 id=&quot;技术成果&quot;&gt;技术成果&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;2016.2.22 北邮人十大&lt;a href=&quot;https://github.com/Molunerfinn/Nodejs-ByrTopTen&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;爬虫&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.3.20 北邮人十大&lt;a href=&quot;http://topten.piegg.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;日报&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.5.30 福建北邮人服务&lt;a href=&quot;http://fj.piegg.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;系统&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.6 北邮人论坛Markdown显示&lt;a href=&quot;https://github.com/Molunerfinn/bbs-markdown&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;实现&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.6 北邮人论坛快速&lt;a href=&quot;https://github.com/Molunerfinn/vue-mobile-learning-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;注册页&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.10 &lt;a href=&quot;https://github.com/Molunerfinn/markline.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;markline.js&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.11 ~ 2017.2 菠萝车族后台系统&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2016.12 Element-ui主题语法&lt;a href=&quot;https://github.com/Molunerfinn/theme-default&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;解析&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2017.1 &lt;a href=&quot;https://github.com/Molunerfinn/vue-koa-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vue-Koa-Demo&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&quot;技术栈成长&quot;&gt;技术栈成长&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Nodejs应用&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Express-&amp;gt;Koa&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mongodb &amp;amp; MySQL&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Canvas&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OO编程思想&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Vue1 -&amp;gt; Vue2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;事件驱动-&amp;gt;数据驱动&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ES3 -&amp;gt; ES6&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;组件化构建&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;2017年，其实还有不少东西需要继续努力。&lt;/p&gt;
&lt;h2 id=&quot;期望、目标&quot;&gt;期望、目标&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;算法&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;数据结构&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Three.js -&amp;gt; 浏览器3D建模&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;回归JS语言基础&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;学会玩Webpack2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;持续的项目开源&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Python简单入门&lt;/strong&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;好吧其实还有一些做了一点点就因为其他事（没时间、忘了）夭折的东西。总得来说，通过上面这些项目，2016年技术栈是逐渐成长的一年，慢慢的从15年一个前端的萌新，啥都不懂，到现在能知道要学什么，该学什么，缺什么，需要补什么的入门级选手了。&lt;/p&gt;
&lt;p&gt;2016年决定读研，主要还是因为深感自己计算机的基础知识还是很薄弱，尤其是对于算法、数据结构的知识几乎为空。这也是需要在这在学校多出来的3年里补上的。作为前端工程师毕竟是个工程师，所以基础还是需要扎实的。&lt;/p&gt;
&lt;p&gt;除开技术，关于自己的成长，也要写写。&lt;/p&gt;
&lt;p&gt;过去的一年，&lt;a href=&quot;http://teamsz.xyz&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;TEAM-SZ&lt;/a&gt;团队从只有最初的几个到目前的19人，在团队内花费了不少心血，也总算是初见起色。对于技术的热情依然还是要继续，对于一起实现我们喜欢的东西依然还是要充满动力。相信能够坚持在团队里持续有自己的输出的一定能学到不少东西。&lt;/p&gt;
&lt;p&gt;过去的一年，上完了本科生涯最后一节课，最后一个小学期，领完本科生涯最后一笔奖学金，深感自己对于本科的专业确实并不是特别喜欢。也很高兴能够找到现在的研究生实验室，跟一群同样热情、技术过硬的小伙伴继续学习继续度过后面的几年。&lt;/p&gt;
&lt;p&gt;过去的一年，体重并没有跟以前一样在学校就瘦下去，而是维持了比较稳定的体重，不过运动量并没有太多，这点需要提高。健康状态还算可以接受，不过就是白头发越来越多，这也是需要深切关注的。&lt;/p&gt;
&lt;p&gt;过去的一年，当然最重要的事还是遇到了生命里的另一半，遇到了互相喜欢，互相关心的另一半。虽然才在一起没多久，但是每天都过得很开心，希望能够和你一直走下去~&lt;/p&gt;
&lt;p&gt;2017，还需努力。新年快乐，梦想加油~&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;终于又到了一年一度的春节啦。旧的一年的总结当然是要放在农历新年之前啦，这才是过年吧。&lt;/p&gt;
    
    </summary>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="随笔" scheme="https://molunerfinn.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>全栈开发实战：用Vue2+Koa1开发完整的前后端项目</title>
    <link href="https://molunerfinn.com/Vue+Koa/"/>
    <id>https://molunerfinn.com/Vue+Koa/</id>
    <published>2017-01-17T07:06:00.000Z</published>
    <updated>2017-02-03T12:54:12.550Z</updated>
    
    <content type="html">&lt;h2 id=&quot;简介&quot;&gt;简介&lt;/h2&gt;&lt;p&gt;本文从一名新手的角度（默认对Vue有了解，对Koa或者Express有了解）出发，从0开始构建一个数据通过Koa提供API的形式获取，页面通过Vue渲染的完整的前端项目。可以了解到Vue构建单页面的一些知识以及前端路由的使用、Koa如何提供API接口，如何进行访问过滤（路由）、验证（JSON-WEB-TOKEN）以及Sequelize操作MySQL数据库的一些知识和技巧，希望能够作为一篇入门全栈开发的文章吧。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;写在前面&quot;&gt;写在前面&lt;/h2&gt;&lt;p&gt;我曾经写过一篇&lt;a href=&quot;https://molunerfinn.com/nodejs-2/&quot;&gt;文章&lt;/a&gt;，是用express和mongodb入门Nodejs的前后端开发，这篇文章里简单的做了一个小demo，能够让你读写mongodb数据库，并且从数据库里将数据读取出来显示到页面上。算是一个简单的读写小demo吧，也算是服务端渲染的一次初尝试。并且我还写过用nodejs写简单小爬虫的&lt;a href=&quot;https://molunerfinn.com/nodejs-1/&quot;&gt;文章&lt;/a&gt;，用爬虫来获取数据写入数据库。通过以上的的方法我用express写了一个小网站，记录并显示北邮人论坛每天的十大的&lt;a href=&quot;http://topten.piegg.cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;内容&lt;/a&gt;。挺好玩的对吧，可以把想要做的事用代码来实现。&lt;/p&gt;
&lt;p&gt;后来我接触到了Koa，并开始了学习，从express迁移到Koa其实曲线还算是比较平滑的。不过用Koa的方式也还是采用服务端渲染页面的方式。而且我发现目前网络上少有写过用Koa构建的前后端分离的应用、网站文章，我最近做的一个项目里需要用到的方式就是用Vue构建页面，数据的获取全部走后端API的形式，也就是所谓的前后端分离吧。正好在这过程中走了不少的坑，包括数据库的使用上也算是个新手，所以写篇文章记录一下，用同样的思路和方法构建一个简单的Todolist，欢迎讨论，轻拍~&lt;/p&gt;
&lt;h2 id=&quot;项目架构&quot;&gt;项目架构&lt;/h2&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── LICENSE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── README&lt;span class=&quot;class&quot;&gt;.md&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── &lt;span class=&quot;class&quot;&gt;.env&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;// 环境变量配置文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── app&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;// Koa入口文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── build &lt;span class=&quot;comment&quot;&gt;// vue-cli 生成，用于webpack监听、构建&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── build&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── check-versions&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── dev-client&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── dev-server&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── utils&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── webpack&lt;span class=&quot;class&quot;&gt;.base&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.conf&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── webpack&lt;span class=&quot;class&quot;&gt;.dev&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.conf&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   └── webpack&lt;span class=&quot;class&quot;&gt;.prod&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.conf&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── config &lt;span class=&quot;comment&quot;&gt;// vue-cli 生成&amp;amp;自己加的一些配置文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── default&lt;span class=&quot;class&quot;&gt;.conf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── dev&lt;span class=&quot;class&quot;&gt;.env&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── index&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   └── prod&lt;span class=&quot;class&quot;&gt;.env&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── dist &lt;span class=&quot;comment&quot;&gt;// Vue build 后的文件夹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── index&lt;span class=&quot;class&quot;&gt;.html&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 入口文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   └── static &lt;span class=&quot;comment&quot;&gt;// 静态资源&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── index&lt;span class=&quot;class&quot;&gt;.html&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// vue-cli生成，用于容纳Vue组件的主html文件。单页应用就只有一个html&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── package&lt;span class=&quot;class&quot;&gt;.json&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// npm的依赖、项目信息文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── server &lt;span class=&quot;comment&quot;&gt;// Koa后端，用于提供Api&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── config &lt;span class=&quot;comment&quot;&gt;// 配置文件夹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── controllers &lt;span class=&quot;comment&quot;&gt;// controller-控制器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── models &lt;span class=&quot;comment&quot;&gt;// model-模型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── routes &lt;span class=&quot;comment&quot;&gt;// route-路由&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   └── schema &lt;span class=&quot;comment&quot;&gt;// schema-数据库表结构&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;├── src &lt;span class=&quot;comment&quot;&gt;// vue-cli 生成&amp;amp;自己添加的utils工具类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── App&lt;span class=&quot;class&quot;&gt;.vue&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 主文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── assets &lt;span class=&quot;comment&quot;&gt;// 相关静态资源存放&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── components &lt;span class=&quot;comment&quot;&gt;// 单文件组件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   ├── main&lt;span class=&quot;class&quot;&gt;.js&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 引入Vue等资源、挂载Vue的入口js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;│   └── utils &lt;span class=&quot;comment&quot;&gt;// 工具文件夹-封装的可复用的方法、功能&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;└── yarn&lt;span class=&quot;class&quot;&gt;.lock&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 用yarn自动生成的lock文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看起来好像很复杂的样子，其实很大一部分文件夹的结构是&lt;code&gt;vue-cli&lt;/code&gt;这个工具帮我们生成的。而我们需要额外添加的主要是Koa的入口文件以及一个&lt;code&gt;server&lt;/code&gt;文件夹用于Koa提供API。这样的话，在获取数据的方面就可以走Koa所提供的API，而Vue只需关心怎么把这些数据渲染到页面上就好了。&lt;/p&gt;
&lt;h2 id=&quot;项目用到的一些关键依赖&quot;&gt;项目用到的一些关键依赖&lt;/h2&gt;&lt;p&gt;以下依赖的版本都是本文所写的时候的版本，或者更旧一些&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vue.js(v2.1.8)&lt;/li&gt;
&lt;li&gt;Vue-Router(v2.1.1)&lt;/li&gt;
&lt;li&gt;Axios(v0.15.3)&lt;/li&gt;
&lt;li&gt;Element(v1.1.2)&lt;/li&gt;
&lt;li&gt;Koa.js(v1.2.4) // 没采用Koa2&lt;/li&gt;
&lt;li&gt;Koa-Router@5.4\Koa-jwt\Koa-static等一系列Koa中间件&lt;/li&gt;
&lt;li&gt;Mysql(v2.12.0) // nodejs的mysql驱动，并不是mysql本身版本（项目采用mysql5.6）&lt;/li&gt;
&lt;li&gt;Sequelize(v3.28.0) // 操作数据库的ORM&lt;/li&gt;
&lt;li&gt;Yarn(v0.18.1) // 比起npm更快一些&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;剩下依赖可以参考本文最后给出的项目demo仓库。&lt;/p&gt;
&lt;h2 id=&quot;项目启动&quot;&gt;项目启动&lt;/h2&gt;&lt;p&gt;Nodejs与npm的安装不再叙述（希望大家装上的node版本大于等于6.x，不然还需要加上–harmony标志才可以开启es6），默认读者已经掌握npm安装依赖的方法。首先全局安装&lt;code&gt;npm i vue-cli -g&lt;/code&gt;，当然本项目基本上是采用&lt;code&gt;yarn&lt;/code&gt;，所以也可以&lt;code&gt;yarn global add vue-cli&lt;/code&gt;。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips: 可以给yarn换上淘宝源，速度更快: &lt;code&gt;yarn config set registry &amp;quot;https://registry.npm.taobao.org&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后我们初始化一个&lt;code&gt;Vue2的webpack&lt;/code&gt;的模板：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;vue init webpack demo&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips: 上面的demo可以填写你自己的项目名称&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后进行一些基本配置选择之后，你就可以得到一个基本的&lt;code&gt;vue-cli&lt;/code&gt;生成的项目结构。&lt;/p&gt;
&lt;p&gt;接着我们进入&lt;code&gt;vue-cli&lt;/code&gt;生成的目录，安装&lt;code&gt;Vue&lt;/code&gt;的项目依赖并安装&lt;code&gt;Koa&lt;/code&gt;的项目依赖：&lt;code&gt;yarn &amp;amp;&amp;amp; yarn add koa koa-router@5.4 koa-logger koa-json koa-bodyparser&lt;/code&gt;，（注意是安装&lt;code&gt;koa-router&lt;/code&gt;的5.4版，因为7.X版本是支持Koa2的）然后进行一些基本目录建立：&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;vue-cli&lt;/code&gt;生成的&lt;code&gt;demo&lt;/code&gt;目录下，建立&lt;code&gt;server&lt;/code&gt;文件夹以及子文件夹：&lt;/p&gt;
&lt;figure class=&quot;highlight axapta&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;├── &lt;span class=&quot;keyword&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// Koa后端，用于提供Api&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ├── config &lt;span class=&quot;comment&quot;&gt;// 配置文件夹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ├── controllers &lt;span class=&quot;comment&quot;&gt;// controller-控制器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ├── models &lt;span class=&quot;comment&quot;&gt;// model-模型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ├── routes &lt;span class=&quot;comment&quot;&gt;// route-路由&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    └── schema &lt;span class=&quot;comment&quot;&gt;// schema-数据库表结构&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后在&lt;code&gt;demo&lt;/code&gt;文件夹下我们创建一个&lt;code&gt;app.js&lt;/code&gt;的文件，作为&lt;code&gt;Koa&lt;/code&gt;的启动文件。&lt;/p&gt;
&lt;p&gt;写入如下基本的内容就可以启动&lt;code&gt;Koa&lt;/code&gt;啦：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , koa = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-router&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , json = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-json&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-logger&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 引入各种依赖&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-bodyparser&#39;&lt;/span&gt;)());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(json());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(logger());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;next&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; start = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; ms = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt; - start;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;%s %s - %s&#39;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.method, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.url, ms); &lt;span class=&quot;comment&quot;&gt;// 显示执行的时间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.on(&lt;span class=&quot;string&quot;&gt;&#39;error&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, ctx&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;server error&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.listen(&lt;span class=&quot;number&quot;&gt;8889&lt;/span&gt;,() =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;Koa is listening in 8889&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = app;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后在控制台输入&lt;code&gt;node app.js&lt;/code&gt;，能看到输出&lt;code&gt;Koa is listening in 8889&lt;/code&gt;，则说明我们的&lt;code&gt;Koa&lt;/code&gt;已经启动成功了，并在8889端口监听。&lt;/p&gt;
&lt;h2 id=&quot;前端页面构建&quot;&gt;前端页面构建&lt;/h2&gt;&lt;p&gt;这个DEMO是做一个Todo-List，我们首先来做一个登录页面。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips: 为了方便构建页面和美观，本文采用的Vue2的前端UI框架是&lt;code&gt;element-ui&lt;/code&gt;。安装：&lt;code&gt;yarn add element-ui&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;模板引擎我习惯用&lt;code&gt;pug&lt;/code&gt;，CSS预处理我习惯用&lt;code&gt;stylus&lt;/code&gt;，当然每个人自己的习惯和喜好是不一样的，所以大家根据自己平时的喜好来就行了。&lt;/p&gt;
&lt;p&gt;为了方便大家查看代码，就不用&lt;code&gt;pug&lt;/code&gt;了，学习成本相对高一些。不过CSS用&lt;code&gt;stylus&lt;/code&gt;写起来简便，看起来也不会难懂，是我自己的习惯，所以还需要安装一下&lt;code&gt;yarn add stylus stylus-loader&lt;/code&gt;。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips: 安装stylus-loader是为了让webpack能够渲染stylus&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后要把&lt;code&gt;element-ui&lt;/code&gt;引入项目中。打开&lt;code&gt;src/main.js&lt;/code&gt;，将文件改写如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Vue &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;vue&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; App &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;./App&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; ElementUI &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;element-ui&#39;&lt;/span&gt; // 引入element-ui&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;element-ui/lib/theme-default/index.css&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Vue.use(ElementUI) // Vue全局使用&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;new Vue(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  el: &lt;span class=&quot;string&quot;&gt;&#39;#app&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  template: &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;App/&amp;gt;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  components: &amp;#123; App &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后我们在项目根目录下输入&lt;code&gt;npm run dev&lt;/code&gt;，启动开发模式，这个模式有webpack的热加载，也就是你写完代码，浏览器立即就能响应变化。&lt;/p&gt;
&lt;p&gt;为了实现响应式页面，我们要在项目目录下的&lt;code&gt;index.html&lt;/code&gt;的&lt;code&gt;head&lt;/code&gt;标签内加入以下&lt;code&gt;meta&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&amp;quot;&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;登录界面&quot;&gt;登录界面&lt;/h3&gt;&lt;p&gt;进入&lt;code&gt;src/components&lt;/code&gt;目录，新建一个&lt;code&gt;Login.vue&lt;/code&gt;的文件。然后我们来写第一个页面：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;content&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:xs&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;24&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:sm&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;&amp;#123;span: 6,offset: 9&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;title&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       欢迎登录 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;account&quot;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;账号&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;text&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;password&quot;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;密码&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;password&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;登录&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      account: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      password: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;lang&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;stylus&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;scoped&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;css&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.el-row&lt;/span&gt;&lt;span class=&quot;class&quot;&gt;.content&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;padding&lt;/span&gt; 16&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.title&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;font-size&lt;/span&gt; 28&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.el-input&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;margin&lt;/span&gt; 12&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt; 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.el-button&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;width&lt;/span&gt; 100%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;margin-top&lt;/span&gt; 12&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在这里就有一些值得注意的地方。首先是&lt;code&gt;template&lt;/code&gt;标签内的直接子元素最多只能挂载一个。也就是你不能这么写：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;否则会报错：&lt;code&gt;template syntax error Component template should contain exactly one root element&lt;/code&gt;，template下只能有一个根元素。不过为了写多个元素，你可以这样：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;同时注意到，在&lt;code&gt;Login.vue&lt;/code&gt;的&lt;code&gt;style&lt;/code&gt;标签内有个&lt;code&gt;scoped&lt;/code&gt;属性，这个属性能够使这些样式只在这个组件内生效（因为Webpack在渲染的时候会将这个组件内的元素自动打上一串形如&lt;code&gt;data-v-62a7f97e&lt;/code&gt;这样的属性，对于这些样式也会变成形如&lt;code&gt;.title[data-v-62a7f97e]{ font-size: 28px;}&lt;/code&gt;的样子，保证了不会和其他组件的样式冲突。&lt;/p&gt;
&lt;p&gt;页面写完之后，如果不把组件注册到Vue之下那么页面是不会显示的。因此这个时候需要把&lt;code&gt;APP.vue&lt;/code&gt;这个文件改写一下：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;app&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./assets/logo.png&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;Login&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;Login&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&amp;lt;!--使用Login组件--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Login &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;./components/Login&#39;&lt;/span&gt; // 引入Login组件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;export default &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  name: &lt;span class=&quot;string&quot;&gt;&#39;app&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  components: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Login // 注册组件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;css&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;id&quot;&gt;#app&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;font-family&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;string&quot;&gt;&#39;Avenir&#39;&lt;/span&gt;, Helvetica, Arial, sans-serif&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-webkit-font-smoothing&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; antialiased&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-moz-osx-font-smoothing&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; grayscale&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;text-align&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; center&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#2c3e50&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;margin-top&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;60px&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也就是把&lt;code&gt;Login&lt;/code&gt;这个组件注册到&lt;code&gt;Vue&lt;/code&gt;下，同时你再看浏览器，已经不再是&lt;code&gt;vue-cli&lt;/code&gt;默认生成的&lt;code&gt;Hello&lt;/code&gt;欢迎界面了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/login.png&quot; alt=&quot;Login&quot; title=&quot;Login&quot;&gt;&lt;/p&gt;
&lt;p&gt;接着我们写一下登录成功后的界面。&lt;/p&gt;
&lt;h3 id=&quot;TodoList页面&quot;&gt;TodoList页面&lt;/h3&gt;&lt;p&gt;还是在&lt;code&gt;src/components&lt;/code&gt;目录下，写一个叫做&lt;code&gt;TodoList.vue&lt;/code&gt;的文件。&lt;/p&gt;
&lt;p&gt;接着我们开始写一个TodoList：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;content&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:xs&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;&amp;#123;span:20,offset:2&amp;#125;&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:sm&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;&amp;#123;span:8,offset:8&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        欢迎：&amp;#123;&amp;#123;name&amp;#125;&amp;#125;！你的待办事项是：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;请输入待办事项&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;todos&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;keyup.enter.native&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;addTodos&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-tabs&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;activeName&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-tab-pane&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;label&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;待办事项&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;first&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:xs&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;24&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;!Done&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&amp;lt;!--v-if和v-for不能同时在一个元素内使用，因为Vue总会先执行v-for--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;(item, index) in list&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;todo-list&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item.status == false&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#123;&amp;#123; index + 1 &amp;#125;&amp;#125;. &amp;#123;&amp;#123; item.content &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;pull-right&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;small&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;finished(index)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;完成&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;small&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;:plain&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;true&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;danger&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;remove(index)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;删除&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-else-if&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;Done&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              暂无待办事项&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-tab-pane&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-tab-pane&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;label&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;已完成事项&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;second&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;count &amp;gt; 0&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;(item, index) in list&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;todo-list&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item.status == true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item finished&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &amp;#123;&amp;#123; index + 1 &amp;#125;&amp;#125;. &amp;#123;&amp;#123; item.content &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;pull-right&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;small&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;restore(index)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;还原&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-else&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            暂无已完成事项&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-tab-pane&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-tabs&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-col&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-row&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      name: &lt;span class=&quot;string&quot;&gt;&#39;Molunerfinn&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      todos: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      activeName: &lt;span class=&quot;string&quot;&gt;&#39;first&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      list:[],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      count: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  computed: &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 计算属性用于计算是否已经完成了所有任务&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Done()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; length = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[i].status == &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; ? count += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.count = count;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(count == length || length == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    addTodos() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos == &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        status: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        content: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list.push(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    finished(index) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$set(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[index],&lt;span class=&quot;string&quot;&gt;&#39;status&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 通过set的方法让数组的变动能够让Vue检测到&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        message: &lt;span class=&quot;string&quot;&gt;&#39;任务完成&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    remove(index) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list.splice(index,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        type: &lt;span class=&quot;string&quot;&gt;&#39;info&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        message: &lt;span class=&quot;string&quot;&gt;&#39;任务删除&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    restore(index) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$set(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[index],&lt;span class=&quot;string&quot;&gt;&#39;status&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        type: &lt;span class=&quot;string&quot;&gt;&#39;info&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        message: &lt;span class=&quot;string&quot;&gt;&#39;任务还原&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;lang&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;stylus&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;scoped&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;css&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.el-input&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;margin&lt;/span&gt; 20&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;auto&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.todo-list&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;width&lt;/span&gt; 100%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;margin-top&lt;/span&gt; 8&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;padding-bottom&lt;/span&gt; 8&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;border-bottom&lt;/span&gt; 1&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;solid&lt;/span&gt; &lt;span class=&quot;id&quot;&gt;#eee&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;overflow&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;hidden&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;text-align&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;left&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;class&quot;&gt;.item&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;font-size&lt;/span&gt; 20&lt;span class=&quot;tag&quot;&gt;px&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;amp;&lt;span class=&quot;class&quot;&gt;.finished&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;text-decoration&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;line-through&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;color&lt;/span&gt; &lt;span class=&quot;id&quot;&gt;#ddd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;class&quot;&gt;.pull-right&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;float&lt;/span&gt; &lt;span class=&quot;tag&quot;&gt;right&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;页面构建其实没有什么特别好说的，但是因为我自己有踩点坑，所以还是专门讲一下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;v-if&lt;/code&gt;和&lt;code&gt;v-for&lt;/code&gt;放在一个元素内同时使用，因为Vue总会先执行&lt;code&gt;v-for&lt;/code&gt;，所以导致&lt;code&gt;v-if&lt;/code&gt;不会被执行。替代地，你可以使用一个额外的&lt;code&gt;template&lt;/code&gt;元素用来放置&lt;code&gt;v-if&lt;/code&gt;或者&lt;code&gt;v-for&lt;/code&gt;从而达到同样的目的。这是相关的&lt;a href=&quot;https://github.com/vuejs/vue/issues/3106&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;issue&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;计算属性对于直接的数据比如&lt;code&gt;a: 2&lt;/code&gt; -&amp;gt; &lt;code&gt;a: 3&lt;/code&gt;这样的数据变动可以直接检测到。但是如果是本例中的&lt;code&gt;list&lt;/code&gt;的某一项的&lt;code&gt;status&lt;/code&gt;这个属性变化了，如果我们直接使用&lt;code&gt;list[index].status = true&lt;/code&gt;这样的写法的话，Vue将无法检测到数据变动。替代地，可以使用&lt;code&gt;set&lt;/code&gt;方法（全局是&lt;code&gt;Vue.set()&lt;/code&gt;，实例中是&lt;code&gt;this.$set()&lt;/code&gt;），通过&lt;code&gt;set&lt;/code&gt;方法可以让数据的变动变得可以被检测到。从而让计算属性能够捕捉到变化。可以参考官方文档对于响应式原理的&lt;a href=&quot;https://cn.vuejs.org/v2/guide/reactivity.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;描述&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/todolist.gif&quot; alt=&quot;Todolist&quot; title=&quot;Todolist&quot;&gt;&lt;/p&gt;
&lt;p&gt;写完&lt;code&gt;TodoList&lt;/code&gt;之后，我们需要将它和&lt;code&gt;vue-router&lt;/code&gt;配合起来，从而使这个单页应用能够进行页面跳转。&lt;/p&gt;
&lt;h3 id=&quot;页面路由&quot;&gt;页面路由&lt;/h3&gt;&lt;p&gt;由于不采用服务端渲染，所以页面路由走的是前端路由。安装一下&lt;code&gt;vue-router&lt;/code&gt;：&lt;code&gt;yarn add vue-router&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;安装好后，我们挂载一下路由。打开&lt;code&gt;main.js&lt;/code&gt;文件改写如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// src/main.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Vue &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;vue&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; App &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;./App&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; ElementUI &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;element-ui&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;element-ui/lib/theme-default/index.css&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; VueRouter &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;vue-router&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Vue.use(ElementUI);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Vue.use(VueRouter);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Login &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; `./components/Login`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; TodoList &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; `./components/TodoList`&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;const router =  new VueRouter(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  mode: &lt;span class=&quot;string&quot;&gt;&#39;history&#39;&lt;/span&gt;, // 开启HTML5的history模式，可以让地址栏的url长得跟正常页面跳转的url一样。（不过还需要后端配合，讲Koa的时候会说）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  base: __dirname, &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  routes: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      path: &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;,  // 默认首页打开是登录页&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      component: Login&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      path: &lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      component: TodoList&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      path: &lt;span class=&quot;string&quot;&gt;&#39;*&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      redirect: &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt; // 输入其他不存在的地址自动跳回首页&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;const app = new Vue(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router: router, // 启用router&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  render: h =&amp;gt; h(App) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;).$mount(&lt;span class=&quot;string&quot;&gt;&#39;#app&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;//挂载到id为app的元素上&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就把路由挂载好了，但是你打开页面发现好像还是没有什么变化。这是因为我们没有把路由视图放到页面上。现在我们改写一下&lt;code&gt;APP.vue&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- APP.vue --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;app&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;./assets/logo.png&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;router-view&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;router-view&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 原本的Login换成了router-view 这就是路由视图渲染的目标元素--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;template&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  name: &lt;span class=&quot;string&quot;&gt;&#39;app&#39;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 不需要再引入`Login`\`TodoList`组件了，因为在路由里已经注册了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;css&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;id&quot;&gt;#app&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;font-family&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;string&quot;&gt;&#39;Avenir&#39;&lt;/span&gt;, Helvetica, Arial, sans-serif&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-webkit-font-smoothing&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; antialiased&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-moz-osx-font-smoothing&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; grayscale&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;text-align&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; center&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#2c3e50&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;margin-top&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;60px&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后再看一下你的页面，这个时候你如果在地址栏后加上&lt;code&gt;/todolist&lt;/code&gt;那么就会跳转到&lt;code&gt;TodoList&lt;/code&gt;页面啦。&lt;/p&gt;
&lt;p&gt;不过我们如何通过点击登录按钮跳转到&lt;code&gt;TodoList&lt;/code&gt;呢？改写一下&lt;code&gt;Login.vue&lt;/code&gt;，就可以跳转了。&lt;/p&gt;
&lt;p&gt;只需要给登录的&lt;code&gt;button&lt;/code&gt;加一个方法即可：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Login.vue --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;······&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 给input增加键盘事件，当输入完密码回车也执行loginToDo方法 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;password&quot;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;密码&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  @&lt;span class=&quot;attribute&quot;&gt;keyup.enter.native&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;loginToDo&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-input&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 增加一个click方法 loginToDo --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;loginToDo&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;登录&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;······&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      account: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      password: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    loginToDo() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$router.push(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 编程式路由，通过push方法，改变路由。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后你就可以通过点击&lt;code&gt;登录&lt;/code&gt;按钮进行页面跳转了。并且你可以发现，页面地址从&lt;code&gt;localhost:8080&lt;/code&gt;变成了&lt;code&gt;localhost:8080/todolist&lt;/code&gt;，长得跟正常的url跳转一样。（但是实际上我们是单页应用，只是在应用内进行页面跳转而已，没有向后端额外请求）&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/login2todolist.gif&quot; alt=&quot;login2todolist&quot; title=&quot;login2todolist&quot;&gt;&lt;/p&gt;
&lt;p&gt;至此，我们已经完成了一个纯前端的单页应用，能够进行页面跳转，能够做简单的ToDoList的添加和删除和还原。当然这个东西只能算是个能看不能用的东西——因为登录系统有名无实、ToDoList只要页面刷新一下就没了。&lt;/p&gt;
&lt;p&gt;于是我们可以先把前端放一放。开启我们的后端之旅。&lt;/p&gt;
&lt;h2 id=&quot;后端环境搭建&quot;&gt;后端环境搭建&lt;/h2&gt;&lt;h3 id=&quot;MySQL&quot;&gt;MySQL&lt;/h3&gt;&lt;p&gt;之所以没有用Node界大家普遍喜爱的&lt;code&gt;Mongodb&lt;/code&gt;主要是因为之前我用过它，而没有用过&lt;code&gt;MySQL&lt;/code&gt;，本着学习的态度，我决定用用&lt;code&gt;MySQL&lt;/code&gt;。还有就是&lt;code&gt;Express + Mongodb&lt;/code&gt;的教程其实很早之前就已经满大街都是了。所以如果你觉得&lt;code&gt;Mongodb&lt;/code&gt;更合你的胃口，看完本文你完全可以用&lt;code&gt;Mongodb&lt;/code&gt;构建一个类似的应用。&lt;/p&gt;
&lt;p&gt;去&lt;code&gt;MySQL&lt;/code&gt;的&lt;a href=&quot;http://dev.mysql.com/downloads/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官网&lt;/a&gt;下载安装对应平台&lt;code&gt;MySQL&lt;/code&gt;的&lt;code&gt;Community Server&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;通常来说安装的步骤都是比较简单的。对于&lt;code&gt;MySQL&lt;/code&gt;的基本安装、开启步骤可以参考这篇&lt;a href=&quot;http://www.rathishkumar.in/2016/01/how-to-install-mysql-server-on-windows.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;，这篇是windows的。当然其他平台的安装也是很方便的，都有相应的包管理工具可以获取。值得注意的就是，安装完&lt;code&gt;MySQL&lt;/code&gt;之后你需要设定一下&lt;code&gt;root&lt;/code&gt;账户的密码。保证安全性。如果你漏了设定，或者你不知道怎么设定，可以参考这篇&lt;a href=&quot;https://www.howtoforge.com/setting-changing-resetting-mysql-root-passwords&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;因为我对&lt;code&gt;MySQL&lt;/code&gt;的SQL语句不是很熟悉，所以我需要一个可视化的工具来操作&lt;code&gt;MySQL&lt;/code&gt;。Windows上我用的是&lt;a href=&quot;http://www.heidisql.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HediSQL&lt;/a&gt;，macOS上我用的是&lt;a href=&quot;https://www.sequelpro.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sequel Pro&lt;/a&gt;。它们都是免费的。&lt;/p&gt;
&lt;p&gt;然后我们可以用这些可视化工具连上MySQL的server（默认端口是3306）之后，创建一个新的数据库，叫做&lt;code&gt;todolist&lt;/code&gt;。（当然你也可以用SQL语句:&lt;code&gt;CREATE DATABASE todolist&lt;/code&gt;，之后不再赘述）。&lt;/p&gt;
&lt;p&gt;接着我们可以来开始创建数据表了。&lt;/p&gt;
&lt;p&gt;我们需要创建两张表，一张是用户表，一张是待办事项表。用户表用于登录、验证，待办事项表用于展示我们的待办事项。&lt;/p&gt;
&lt;p&gt;创建一张&lt;code&gt;user&lt;/code&gt;表，其中&lt;code&gt;password&lt;/code&gt;我们稍后会进行&lt;code&gt;md5&lt;/code&gt;加密（取32位）。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;id&lt;/td&gt;
&lt;td&gt;int（自增）&lt;/td&gt;
&lt;td&gt;用户的id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;user_name&lt;/td&gt;
&lt;td&gt;CHAR(50)&lt;/td&gt;
&lt;td&gt;用户的名字&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;password&lt;/td&gt;
&lt;td&gt;CHAR(32)&lt;/td&gt;
&lt;td&gt;用户的密码&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;创建一张&lt;code&gt;list&lt;/code&gt;表，所需的字段是&lt;code&gt;id&lt;/code&gt;、&lt;code&gt;user_id&lt;/code&gt;、&lt;code&gt;content&lt;/code&gt;、&lt;code&gt;status&lt;/code&gt;即可。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字段&lt;/th&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;id&lt;/td&gt;
&lt;td&gt;int（自增）&lt;/td&gt;
&lt;td&gt;list的id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;user_id&lt;/td&gt;
&lt;td&gt;int(11)&lt;/td&gt;
&lt;td&gt;用户的id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;content&lt;/td&gt;
&lt;td&gt;CHAR(255)&lt;/td&gt;
&lt;td&gt;list的内容&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;status&lt;/td&gt;
&lt;td&gt;tinyint(1)&lt;/td&gt;
&lt;td&gt;list的状态&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;直接跟数据库打交道的部分基本就是这样了。&lt;/p&gt;
&lt;h3 id=&quot;Sequelize&quot;&gt;Sequelize&lt;/h3&gt;&lt;p&gt;跟数据库打交道的时候我们都需要一个好的操作数据库的工具，能够让我们用比较简单的方法来对数据库进行增删改查。对于&lt;code&gt;Mongodb&lt;/code&gt;来说大家熟悉的是&lt;a href=&quot;http://mongoosejs.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;Mongoose&lt;/code&gt;&lt;/a&gt;以及我用过一个相对更简单点的&lt;a href=&quot;https://github.com/Automattic/monk&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;Monk&lt;/code&gt;&lt;/a&gt;。对于&lt;code&gt;MySQL&lt;/code&gt;，我选用的是&lt;a href=&quot;https://github.com/sequelize/sequelize&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;Sequelize&lt;/code&gt;&lt;/a&gt;，它支持多种关系型数据库（&lt;code&gt;Sqlite&lt;/code&gt;、&lt;code&gt;MySQL&lt;/code&gt;、&lt;code&gt;Postgres&lt;/code&gt;等），它的操作基本都能返回一个&lt;code&gt;Promise&lt;/code&gt;对象，这样在Koa里面我们能够很方便地进行”同步”操作。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;更多关于Sequelize的用法，可以参考&lt;a href=&quot;http://docs.sequelizejs.com/en/latest/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文档&lt;/a&gt;，以及这两篇文章——&lt;a href=&quot;http://itbilu.com/nodejs/npm/VkYIaRPz-.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sequelize中文API文档&lt;/a&gt;、&lt;a href=&quot;https://segmentfault.com/a/1190000003987871&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sequelize和MySQL对照&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在用&lt;code&gt;Sequelize&lt;/code&gt;连接数据库之前我们需要把数据库的表结构用&lt;code&gt;sequelize-auto&lt;/code&gt;导出来。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;更多关于&lt;code&gt;sequelize-auto&lt;/code&gt;的使用可以参考&lt;a href=&quot;https://github.com/sequelize/sequelize-auto&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方介绍&lt;/a&gt;或者&lt;a href=&quot;http://itbilu.com/nodejs/npm/41mRdls_Z.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文章&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;由此我们需要分别安装这几个依赖：&lt;code&gt;yarn global add sequelize-auto &amp;amp;&amp;amp; yarn add sequelize mysql&lt;/code&gt;。 &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：上面用yarn安装的mysql是nodejs环境下的mysql驱动。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;进入&lt;code&gt;server&lt;/code&gt;的目录，执行如下语句&lt;code&gt;sequelize-auto -o &amp;quot;./schema&amp;quot; -d todolist -h 127.0.0.1 -u root -p 3306 -x XXXXX -e mysql&lt;/code&gt;，（其中 -o 参数后面的是输出的文件夹目录， -d 参数后面的是数据库名， -h 参数后面是数据库地址， -u 参数后面是数据库用户名， -p 参数后面是端口号， -x 参数后面是数据库密码，这个要根据自己的数据库密码来！ -e 参数后面指定数据库为mysql）&lt;/p&gt;
&lt;p&gt;然后就会在&lt;code&gt;schema&lt;/code&gt;文件夹下自动生成两个文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// user.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;sequelize, DataTypes&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; sequelize.define(&lt;span class=&quot;string&quot;&gt;&#39;user&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.INTEGER(&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;), &lt;span class=&quot;comment&quot;&gt;// 字段类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 是否允许为NULL&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      primaryKey: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 主键&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      autoIncrement: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 是否自增&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    user_name: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.CHAR(&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;), &lt;span class=&quot;comment&quot;&gt;// 最大长度为50的字符串&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    password: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.CHAR(&lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    tableName: &lt;span class=&quot;string&quot;&gt;&#39;user&#39;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 表名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// list.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;sequelize, DataTypes&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; sequelize.define(&lt;span class=&quot;string&quot;&gt;&#39;list&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.INTEGER(&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      primaryKey: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      autoIncrement: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    user_id: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.INTEGER(&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    content: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.CHAR(&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    status: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      type: DataTypes.INTEGER(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      allowNull: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    tableName: &lt;span class=&quot;string&quot;&gt;&#39;list&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;自动化工具省去了很多我们手动定义表结构的时间。同时注意到生成的数据库表结构文件都自动帮我们&lt;code&gt;module.exports&lt;/code&gt;出来了，所以很方便我们之后的引入。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;server&lt;/code&gt;目录下的&lt;code&gt;config&lt;/code&gt;目录下我们新建一个&lt;code&gt;db.js&lt;/code&gt;，用于初始化&lt;code&gt;Sequelize&lt;/code&gt;和数据库的连接。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// db.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Sequelize = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;sequelize&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 引入sequelize&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用url连接的形式进行连接，注意将root: 后面的&lt;span class=&quot;label&quot;&gt;XXXX改成自己数据库的密码&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Todolist = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Sequelize(&lt;span class=&quot;string&quot;&gt;&#39;mysql://root:XXXX@localhost/todolist&#39;&lt;/span&gt;,&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  define: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timestamps: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 取消Sequelzie自动给数据表加入时间戳（createdAt以及updatedAt）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Todolist &lt;span class=&quot;comment&quot;&gt;// 将Todolist暴露出接口方便Model调用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接着我们去&lt;code&gt;models&lt;/code&gt;文件夹里将数据库和表结构文件连接起来。在这个文件夹下新建一个&lt;code&gt;user.js&lt;/code&gt;的文件。我们先来写一个查询用户&lt;code&gt;id&lt;/code&gt;的东西。&lt;/p&gt;
&lt;p&gt;为此我们可以先在数据库里随意加一条数据：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/database-1.png&quot; alt=&quot;test&quot; title=&quot;test&quot;&gt;&lt;/p&gt;
&lt;p&gt;通常我们要查询一个用户id为1的数据，会很自然的想到类似如下的写法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userInfo = User.findOne(&amp;#123; where: &amp;#123; id: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125; &amp;#125;); &lt;span class=&quot;comment&quot;&gt;// 查询&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(userInfo); &lt;span class=&quot;comment&quot;&gt;// 输出结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;但是上面的写法实际上是行不通的。因为JS的特性让它的IO操作是异步的。而上面的写法，&lt;code&gt;userInfo&lt;/code&gt;将是返回的一个&lt;code&gt;Promise&lt;/code&gt;对象，而不是最终的&lt;code&gt;userInfo&lt;/code&gt;。如果又想用同步的写法获取异步IO操作得到的数据的话，通常情况下是不能直接得到的。但是在Koa里，由于有&lt;a href=&quot;https://github.com/tj/co&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;co&lt;/code&gt;&lt;/a&gt;的存在，让这一切变得十分简单。改写如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// models/user.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; db = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../config/db.js&#39;&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      userModel = &lt;span class=&quot;string&quot;&gt;&#39;../schema/user.js&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 引入user的表结构&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; TodolistDb = db.Todolist; &lt;span class=&quot;comment&quot;&gt;// 引入数据库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; User = TodolistDb.import(userModel); &lt;span class=&quot;comment&quot;&gt;// 用sequelize的import方法引入表结构，实例化了User。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getUserById = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 注意是function* 而不是function 对于需要yield操作的函数都需要这种generator函数。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userInfo = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; User.findOne(&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 用yield控制异步操作，将返回的Promise对象里的数据返回出来。也就实现了“同步”的写法获取异步IO操作的数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    where: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      id: id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; userInfo &lt;span class=&quot;comment&quot;&gt;// 返回数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getUserById  &lt;span class=&quot;comment&quot;&gt;// 导出getUserById的方法，将会在controller里调用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接着我们在&lt;code&gt;controllers&lt;/code&gt;写一个user的controller，来执行这个方法，并返回结果。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// controllers/user.js &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../models/user.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getUserInfo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.id; &lt;span class=&quot;comment&quot;&gt;// 获取url里传过来的参数里的id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; user.getUserById(id);  &lt;span class=&quot;comment&quot;&gt;// 通过yield “同步”地返回查询结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = result &lt;span class=&quot;comment&quot;&gt;// 将请求的结果放到response的body里返回&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  auth: (router) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    router.get(&lt;span class=&quot;string&quot;&gt;&#39;/user/:id&#39;&lt;/span&gt;, getUserInfo); &lt;span class=&quot;comment&quot;&gt;// 定义url的参数是id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;写完这个还不能直接请求，因为我们还没有定义路由，请求经过&lt;code&gt;Koa&lt;/code&gt;找不到这个路径是没有反应的。&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;routes&lt;/code&gt;文件夹下写一个&lt;code&gt;auth.js&lt;/code&gt;的文件。（其实&lt;code&gt;user&lt;/code&gt;表是用于登录的，所以走&lt;code&gt;auth&lt;/code&gt;）&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// routes/auth.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../controllers/user.js&#39;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; router = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-router&#39;&lt;/span&gt;)();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user.auth(router); &lt;span class=&quot;comment&quot;&gt;// 用user的auth方法引入router&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = router; &lt;span class=&quot;comment&quot;&gt;// 把router规则暴露出去&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至此我们已经接近完成我们的第一个API了，还缺最后一步，将这个路由规则“挂载”到Koa上去。&lt;/p&gt;
&lt;p&gt;回到根目录的&lt;code&gt;app.js&lt;/code&gt;，改写如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , koa = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-router&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , json = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-json&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-logger&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , auth = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./server/routes/auth.js&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 引入auth&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-bodyparser&#39;&lt;/span&gt;)());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(json());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(logger());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;next&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; start = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; ms = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt; - start;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;%s %s - %s&#39;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.method, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.url, ms);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.on(&lt;span class=&quot;string&quot;&gt;&#39;error&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, ctx&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;server error&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&#39;/auth&#39;&lt;/span&gt;, auth.routes()); &lt;span class=&quot;comment&quot;&gt;// 挂载到koa-router上，同时会让所有的auth的请求路径前面加上&#39;/auth&#39;的请求路径。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(koa.routes()); &lt;span class=&quot;comment&quot;&gt;// 将路由规则挂载到Koa上。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.listen(&lt;span class=&quot;number&quot;&gt;8889&lt;/span&gt;,() =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;Koa is listening in 8889&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = app;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;打开你的控制台，输入&lt;code&gt;node app.js&lt;/code&gt;，一切运行正常没有报错的话，大功告成，我们的第一个API已经构建完成！&lt;/p&gt;
&lt;p&gt;如何测试呢？&lt;/p&gt;
&lt;h3 id=&quot;API_Test&quot;&gt;API Test&lt;/h3&gt;&lt;p&gt;接口在跟跟前端对接之前，我们应该先进行一遍测试，防止出现问题。在测试接口的工具上，我推荐&lt;a href=&quot;https://www.getpostman.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;Postman&lt;/code&gt;&lt;/a&gt;，这个工具能够很好的模拟发送的各种请求，方便的查看响应结果，用来进行测试是最好不过了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/postman-1.png&quot; alt=&quot;Postman&quot;&gt;&lt;/p&gt;
&lt;p&gt;测试成功，我发送了正确的url请求，返回的结果也是我想看到的。我们看到返回的结果实际上是个JSON，这对于我们前后端来说都是十分方便处理的数据格式。&lt;/p&gt;
&lt;p&gt;但是如果我们代码出了问题，返回error了我们该怎么测试呢？如果说控制台能够反馈一定的信息，但是绝对不充分，并且我们很可能不知道哪步出错了导致最终结果出问题。&lt;/p&gt;
&lt;p&gt;所以我推荐用&lt;a href=&quot;https://code.visualstudio.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;VSCode&lt;/a&gt;这个工具来帮我们调试nodejs后端的代码。它能够添加断点，能够很方便地查看请求的信息。并且配合上&lt;a href=&quot;https://github.com/remy/nodemon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;nodemon&lt;/code&gt;&lt;/a&gt;这类的工具，调试简直不要更舒服。&lt;/p&gt;
&lt;p&gt;关于&lt;code&gt;VSCode&lt;/code&gt;的nodejs调试，可以参考官方的这篇&lt;a href=&quot;https://code.visualstudio.com/docs/editor/node-debugging&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;我自己是用Sublime写代码，用VSCode调试，哈哈。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;登录系统的实现&quot;&gt;登录系统的实现&lt;/h3&gt;&lt;p&gt;刚才实现的不过是一个简单的用户信息查询的接口，但是我们要实现的是一个登录系统，所以还需要做一些工作。&lt;/p&gt;
&lt;h4 id=&quot;JSON-WEB-TOKEN&quot;&gt;JSON-WEB-TOKEN&lt;/h4&gt;&lt;p&gt;基于cookie或者session的登录验证已经屡见不鲜，前段时间&lt;code&gt;JSON-WEB-TOKEN&lt;/code&gt;出来后很是风光了一把。引入了它之后，能够实现真正无状态的请求，而不是基于session和cookie的存储式的有状态验证。&lt;/p&gt;
&lt;p&gt;关于JSON-WEB-TOKEN的描述可以参考这篇&lt;a href=&quot;http://blog.leapoahead.com/2015/09/07/user-authentication-with-jwt/?utm_source=tuicool&amp;amp;utm_medium=referral&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;比较简单，我还推荐一篇&lt;a href=&quot;https://segmentfault.com/a/1190000005783306&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;，将如何使用JSON-WEB-TOKEN写得很清楚。&lt;/p&gt;
&lt;p&gt;另外可以在JSON-WEB-TOKEN的&lt;a href=&quot;https://jwt.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官网&lt;/a&gt;上感受一下。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips：JSON-WEB-TOKEN分三部分，头部信息+主体信息+密钥信息，其中主体传递的信息（是我们存放我们需要的信息的部分）是用BASE64编码的，所以很容易被解码，一定不能存放明文密码这种关键信息！替代地可以存放一些不是特别关键的信息，比如用户名这样能够做区分的信息。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;简单来说，运用了JSON-WEB-TOKEN的登录系统应该是这样的：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;用户在登录页输入账号密码，将账号密码（密码进行md5加密）发送请求给后端&lt;/li&gt;
&lt;li&gt;后端验证一下用户的账号和密码的信息，如果符合，就下发一个TOKEN返回给客户端。如果不符合就不发送TOKEN回去，返回验证错误信息。&lt;/li&gt;
&lt;li&gt;如果登录成功，客户端将TOKEN用某种方式存下来（SessionStorage、LocalStorage）,之后要请求其他资源的时候，在请求头（Header）里带上这个TOKEN进行请求。&lt;/li&gt;
&lt;li&gt;后端收到请求信息，先验证一下TOKEN是否有效，有效则下发请求的资源，无效则返回验证错误。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;通过这个TOKEN的方式，客户端和服务端之间的访问，是&lt;code&gt;无状态&lt;/code&gt;的：也就是服务端不知道你这个用户到底还在不在线，只要你发送的请求头里的TOKEN是正确的我就给你返回你想要的资源。这样能够不占用服务端宝贵的空间资源，而且如果涉及到服务器集群，如果服务器进行维护或者迁移或者需要CDN节点的分配的话，&lt;code&gt;无状态&lt;/code&gt;的设计显然维护成本更低。&lt;/p&gt;
&lt;p&gt;话不多说，我们来把&lt;code&gt;JSON-WEB-TOKEN&lt;/code&gt;用到我们的项目中。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yarn add koa-jwt&lt;/code&gt;，安装&lt;code&gt;Koa&lt;/code&gt;的&lt;code&gt;JSON-WEB-TOKEN&lt;/code&gt;库。&lt;/p&gt;
&lt;p&gt;我们需要在&lt;code&gt;models&lt;/code&gt;里的&lt;code&gt;user.js&lt;/code&gt;加一个方法，通过用户名查找用户：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// models/user.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ......&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 前面的省略了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 新增一个方法，通过用户名查找&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getUserByName = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;name&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userInfo = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; User.findOne(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    where: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      user_name: name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; userInfo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getUserById, &lt;span class=&quot;comment&quot;&gt;// 导出getUserById的方法，将会在controller里调用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getUserByName&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后我们写一下&lt;code&gt;controllers&lt;/code&gt;里的&lt;code&gt;user.js&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// controllers/user.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../models/user.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; jwt = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-jwt&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 引入koa-jwt&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getUserInfo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.id; &lt;span class=&quot;comment&quot;&gt;// 获取url里传过来的参数里的id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; user.getUserById(id);  &lt;span class=&quot;comment&quot;&gt;// 通过yield “同步”地返回查询结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = result &lt;span class=&quot;comment&quot;&gt;// 将请求的结果放到response的body里返回&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; postUserAuth = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; data = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.request.body; &lt;span class=&quot;comment&quot;&gt;// post过来的数据存在request.body里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userInfo = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; user.getUserByName(data.name);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(userInfo != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 如果查无此用户会返回null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(userInfo.password != data.password)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        success: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// success标志位是方便前端判断返回是正确与否&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        info: &lt;span class=&quot;string&quot;&gt;&#39;密码错误！&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 如果密码正确&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userToken = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        name: userInfo.user_name,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        id: userInfo.id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; secret = &lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 指定密钥，这是之后用来判断token合法性的标志&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; token = jwt.sign(userToken,secret); &lt;span class=&quot;comment&quot;&gt;// 签发token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        success: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        token: token, &lt;span class=&quot;comment&quot;&gt;// 返回token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      success: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      info: &lt;span class=&quot;string&quot;&gt;&#39;用户不存在！&#39;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 如果用户不存在返回用户不存在&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  auth: (router) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    router.get(&lt;span class=&quot;string&quot;&gt;&#39;/user/:id&#39;&lt;/span&gt;, getUserInfo); &lt;span class=&quot;comment&quot;&gt;// 定义url的参数是id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    router.post(&lt;span class=&quot;string&quot;&gt;&#39;/user&#39;&lt;/span&gt;, postUserAuth);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由此我们写完了用户认证的部分。接下去我们要改写一下前端登录的方法。&lt;/p&gt;
&lt;h4 id=&quot;引入Axios&quot;&gt;引入Axios&lt;/h4&gt;&lt;p&gt;之前在学&lt;code&gt;Vue&lt;/code&gt;的时候一直用的是&lt;a href=&quot;https://github.com/pagekit/vue-resource&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;vue-resource&lt;/code&gt;&lt;/a&gt;，不过后来&lt;code&gt;Vue2&lt;/code&gt;出来之后，Vue官方不再默认推荐它为官方的&lt;code&gt;ajax&lt;/code&gt;网络请求库了。替代地推荐了一些其他的库，比如就有我们今天要用的&lt;a href=&quot;https://github.com/mzabriskie/axios&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;axios&lt;/code&gt;&lt;/a&gt;。我之前也没有用过它，不过看完它的star和简要介绍&lt;code&gt;Promise based HTTP client for the browser and node.js&lt;/code&gt;，能够同时支持node和浏览器端的ajax请求工具（还是基于Promised的！），我想就有必要用一用啦。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yarn add axios&lt;/code&gt;，安装&lt;code&gt;axios&lt;/code&gt;。然后我们在&lt;code&gt;src/main.js&lt;/code&gt;里面引入&lt;code&gt;axios&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// scr/main.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; Axios &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;axios&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Vue.prototype.$http = Axios &lt;span class=&quot;comment&quot;&gt;// 类似于vue-resource的调用方法，之后可以在实例里直接用this.$http.get()等&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Login.vue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 省略前面的部分&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    loginToDo() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        name: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.account,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        password: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.password&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.post(&lt;span class=&quot;string&quot;&gt;&#39;/auth/user&#39;&lt;/span&gt;, obj) &lt;span class=&quot;comment&quot;&gt;// 将信息发送给后端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then((res) =&amp;gt; &amp;#123; &lt;span class=&quot;comment&quot;&gt;// axios返回的数据都在res.data里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.data.success)&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 如果成功&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,res.data.token); &lt;span class=&quot;comment&quot;&gt;// 用sessionStorage把token存下来&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 登录成功，显示提示语&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              message: &lt;span class=&quot;string&quot;&gt;&#39;登录成功！&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$router.push(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 进入todolist页面，登录成功&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(res.data.info); &lt;span class=&quot;comment&quot;&gt;// 登录失败，显示提示语&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 将token清空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;请求错误！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 将token清空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;密码md5加密&quot;&gt;密码md5加密&lt;/h4&gt;&lt;p&gt;同时，前端向后端发送的密码应当进行&lt;code&gt;md5&lt;/code&gt;加密。&lt;/p&gt;
&lt;p&gt;所以我们需要安装一下md5的库： &lt;code&gt;yarn add md5&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后在&lt;code&gt;Login.vue&lt;/code&gt;下把&lt;code&gt;loginToDo&lt;/code&gt;的方法修改一下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; md5 &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;md5&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;export default &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      account: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      password: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    loginToDo() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        name: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.account,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        password: md5(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.password) &lt;span class=&quot;comment&quot;&gt;// md5加密&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.post(&lt;span class=&quot;string&quot;&gt;&#39;/auth/user&#39;&lt;/span&gt;, obj) &lt;span class=&quot;comment&quot;&gt;// 将信息发送给后端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(res);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.data.success)&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 如果成功&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,res.data.token); &lt;span class=&quot;comment&quot;&gt;// 用sessionStorage把token存下来&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 登录成功，显示提示语&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              message: &lt;span class=&quot;string&quot;&gt;&#39;登录成功！&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$router.push(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 进入todolist页面，登录成功&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(res.data.info); &lt;span class=&quot;comment&quot;&gt;// 登录失败，显示提示语&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 将token清空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;请求错误！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sessionStorage.setItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;,&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 将token清空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因为我们数据库里还是存着明文的&lt;code&gt;123&lt;/code&gt;作为密码，现在要先将它md5化，32位md5加密后变为：&lt;code&gt;202cb962ac59075b964b07152d234b70&lt;/code&gt;，将其替换掉数据库里的&lt;code&gt;123&lt;/code&gt;。不做这步我们将无法登录。&lt;/p&gt;
&lt;p&gt;还没有大功告成，因为我们的界面跑在&lt;code&gt;8080&lt;/code&gt;端口，但是Koa提供的API跑在&lt;code&gt;8889&lt;/code&gt;端口，所以如果直接通过&lt;code&gt;/auth/user&lt;/code&gt;这个url去post是请求不到的。就算写成&lt;code&gt;localhost:8889/auth/user&lt;/code&gt;也会因为跨域问题导致请求失败。&lt;/p&gt;
&lt;p&gt;这个时候有两种最方便的解决办法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果是跨域，服务端只要在请求头上加上&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;CORS&lt;/code&gt;&lt;/a&gt;，客户端即可跨域发送请求。&lt;/li&gt;
&lt;li&gt;变成同域，即可解决跨域请求问题。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;第一种也很方便，采用&lt;a href=&quot;https://github.com/koajs/cors&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;code&gt;kcors&lt;/code&gt;&lt;/a&gt;即可解决。&lt;br&gt;不过为了之后部署方便，我们采用第二种，变成同域请求。&lt;/p&gt;
&lt;p&gt;打开根目录下的&lt;code&gt;config/index.js&lt;/code&gt;，找到&lt;code&gt;dev&lt;/code&gt;下的&lt;code&gt;proxyTable&lt;/code&gt;，利用这个&lt;code&gt;proxyTable&lt;/code&gt;我们能够将外部的请求通过&lt;code&gt;webpack&lt;/code&gt;转发给本地，也就能够将跨域请求变成同域请求了。&lt;/p&gt;
&lt;p&gt;将&lt;code&gt;proxyTable&lt;/code&gt;改写如下:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; proxyTable: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&#39;/auth&#39;&lt;/span&gt;:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    target: &lt;span class=&quot;string&quot;&gt;&#39;http://localhost:8889&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    changeOrigin: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&#39;/api&#39;&lt;/span&gt;:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    target: &lt;span class=&quot;string&quot;&gt;&#39;http://localhost:8889&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    changeOrigin: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面的意思是，我们在组件里请求的地址如果是&lt;code&gt;/api/xxxx&lt;/code&gt;实际上请求的是&lt;code&gt;http://localhost:8889/api/xxxx&lt;/code&gt;，但是由于&lt;code&gt;webpack&lt;/code&gt;帮我们代理了localhost的8889端口的服务，所以我们可以把实际是跨域的请求当做是同域下的接口来调用。&lt;/p&gt;
&lt;p&gt;此时重新启动一下&lt;code&gt;webpack&lt;/code&gt;：先&lt;code&gt;ctrl+c&lt;/code&gt;退出当前进程，然后&lt;code&gt;npm run dev&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;一切都万事了之后，我们可以看到如下激动人心的画面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/login2todolist-2.gif&quot; alt=&quot;login2todolist&quot; title=&quot;login2todolist&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;跳转拦截&quot;&gt;跳转拦截&lt;/h4&gt;&lt;p&gt;虽然我们现在能够成功登录系统了，但是还是存在一个问题：我在地址栏手动将地址改为&lt;code&gt;localhost:8080/todolist&lt;/code&gt;我还是能够成功跳转到登录后的界面啊。于是这就需要一个跳转拦截，当没有登录的时候，不管地址栏输入什么地址，最终都重新定向回登录页。&lt;/p&gt;
&lt;p&gt;这个时候，从后端给我们传回来的&lt;code&gt;token&lt;/code&gt;就派上大用处。有&lt;code&gt;token&lt;/code&gt;就说明我们的身份是经过验证的，否则就是非法的。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;vue-router&lt;/code&gt;提供了页面跳转的钩子，我们可以在&lt;code&gt;router&lt;/code&gt;跳转前进行验证，如果&lt;code&gt;token&lt;/code&gt;存在就跳转，如果不存在就返回登录页。&lt;/p&gt;
&lt;p&gt;参考路由的&lt;a href=&quot;https://router.vuejs.org/zh-cn/advanced/navigation-guards.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;导航钩子&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;打开&lt;code&gt;src/main.js&lt;/code&gt;，修改如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// src/main.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; router = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; VueRouter(&amp;#123;....&amp;#125;) &lt;span class=&quot;comment&quot;&gt;// 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;router.beforeEach((to,from,next) =&amp;gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; token = sessionStorage.getItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(to.path == &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;)&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 如果是跳转到登录页的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(token != &lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt; &amp;amp;&amp;amp; token != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 如果有token就转向todolist不返回登录页&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    next(); &lt;span class=&quot;comment&quot;&gt;// 否则跳转回登录页&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(token != &lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt; &amp;amp;&amp;amp; token != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next() &lt;span class=&quot;comment&quot;&gt;// 如果有token就正常转向&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 否则跳转回登录页&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Vue(&amp;#123;...&amp;#125;) &lt;span class=&quot;comment&quot;&gt;// 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;注意：一定要确保要调用 &lt;code&gt;next()&lt;/code&gt; 方法，否则钩子就不会被 resolved。&lt;/strong&gt;如果纯粹调用&lt;code&gt;next(path)&lt;/code&gt;这样的方法最终还是会回到&lt;code&gt;.beforeEach()&lt;/code&gt;这个钩子里面来，如果没有写对条件就有可能出现死循环，栈溢出的情况。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后我们就可以看到如下效果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/login2todolist-3.gif&quot; alt=&quot;login2todolist&quot; title=&quot;login2todolist&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tips：这种只判断token存不存在就通过的验证是很不安全的，此例只是做了一个演示，实际上还应该进行更深一层的判断，比如从token解包出来的信息里包含我们想要的信息才可以作为有效token，才可以登录。等等。本文只是做一个简要介绍。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;解析token&quot;&gt;解析token&lt;/h4&gt;&lt;p&gt;注意到我们在签发&lt;code&gt;token&lt;/code&gt;的时候，写过这样几句话：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/controllers/user.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userToken = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  name: userInfo.user_name,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  id: userInfo.id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; secret = &lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 指定密钥，这是之后用来判断token合法性的标志&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; token = jwt.sign(userToken,secret); &lt;span class=&quot;comment&quot;&gt;// 签发token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们将用户名和id打包进JWT的主体部分，同时我们解密的密钥是&lt;code&gt;vue-koa-demo&lt;/code&gt;。所以我们可以通过这个信息，来进行登录后的用户名显示，以及用来区别这个用户是谁，这个用户有哪些&lt;code&gt;Todolist&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;接下来在&lt;code&gt;Todolist&lt;/code&gt;页面进行token解析，从而让用户名显示为登录用户名。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// src/components/TodoList.vue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; jwt &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;jsonwebtoken&#39;&lt;/span&gt; // 我们安装koa-jwt的时候会自动下载这个依赖&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;export default &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  created()&amp;#123; // 组件创建时调用&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    const userInfo = this.getUserInfo(); &lt;span class=&quot;comment&quot;&gt;// 新增一个获取用户信息的方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(userInfo != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = userInfo.id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = userInfo.name;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      name: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 用户名改为空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      todos: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      activeName: &lt;span class=&quot;string&quot;&gt;&#39;first&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      list:[],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      count: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      id: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 新增用户id属性，用于区别用户&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  computed: &amp;#123;...&amp;#125;, &lt;span class=&quot;comment&quot;&gt;//省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    addTodos() &amp;#123;...&amp;#125;, &lt;span class=&quot;comment&quot;&gt;// 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    finished(index) &amp;#123;...&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    remove(index) &amp;#123;...&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    restore(index) &amp;#123;...&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getUserInfo()&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 获取用户信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; token = sessionStorage.getItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(token != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; token != &lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; decode = jwt.verify(token,&lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 解析token&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; decode &lt;span class=&quot;comment&quot;&gt;// decode解析出来实际上就是&amp;#123;name: &lt;span class=&quot;label&quot;&gt;XXX,id: XXX&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;于是你就可以看到：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/todolist-1.png&quot; alt=&quot;todolist&quot; title=&quot;todolist&quot;&gt;&lt;/p&gt;
&lt;p&gt;用户名已经不是我们之前默认的&lt;code&gt;Molunerfinn&lt;/code&gt;而是登录名&lt;code&gt;molunerfinn&lt;/code&gt;了。&lt;/p&gt;
&lt;h2 id=&quot;Todolist_增删改查的实现&quot;&gt;Todolist 增删改查的实现&lt;/h2&gt;&lt;p&gt;这个部分就是前后端协作了。我们要实现之前在纯前端部分实现的内容。我以最基本的两个方法来举例子：获取&lt;code&gt;Todolist&lt;/code&gt;以及增加&lt;code&gt;Todolist&lt;/code&gt;，剩下其实思路大同小异，我就提供代码和注释了，我相信也很容易懂。&lt;/p&gt;
&lt;h3 id=&quot;Token的发送&quot;&gt;Token的发送&lt;/h3&gt;&lt;p&gt;之前说了，用JSON-WEB-TOKEN之后，这个系统的验证就完全依靠token了。如果token正确就下发资源，如果资源不正确，就返回错误信息。&lt;/p&gt;
&lt;p&gt;因为我们用了&lt;code&gt;koa-jwt&lt;/code&gt;，所以只需要在每条请求头上加上&lt;code&gt;Authorization&lt;/code&gt;属性，值是&lt;code&gt;Bearer {token值}&lt;/code&gt;，然后让&lt;code&gt;Koa&lt;/code&gt;在接收请求之前验证一下token即可。但是如果每发一条请求就要手动写一句这个，太累了。于是我们可以做到全局&lt;code&gt;Header&lt;/code&gt;设定。&lt;/p&gt;
&lt;p&gt;打开&lt;code&gt;src/main.js&lt;/code&gt;，在路由跳转的钩子里加上这句：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// scr/main.json&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;router.beforeEach((to,from,next) =&amp;gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; token = sessionStorage.getItem(&lt;span class=&quot;string&quot;&gt;&#39;demo-token&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(to.path == &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;)&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(token != &lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt; &amp;amp;&amp;amp; token != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    next(); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(token != &lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt; &amp;amp;&amp;amp; token != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      Vue.prototype.$http.defaults.headers.common[&lt;span class=&quot;string&quot;&gt;&#39;Authorization&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;Bearer &#39;&lt;/span&gt; + token; &lt;span class=&quot;comment&quot;&gt;// 全局设定header的token验证，注意Bearer后有个空格&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      next(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就完成了token的客户端发送设定。&lt;/p&gt;
&lt;h3 id=&quot;Koa端对Token的验证&quot;&gt;Koa端对Token的验证&lt;/h3&gt;&lt;p&gt;接着我们实现两个简单的api，这两个api请求的路径就不是&lt;code&gt;/auth/xxx&lt;/code&gt;而是&lt;code&gt;/api/xxx&lt;/code&gt;了。我们还需要实现，访问&lt;code&gt;/api/*&lt;/code&gt;路径的请求都需要经过&lt;code&gt;koa-jwt&lt;/code&gt;的验证，而&lt;code&gt;/auth/*&lt;/code&gt;的请求不需要。&lt;/p&gt;
&lt;p&gt;首先去&lt;code&gt;models&lt;/code&gt;目录下新建一个&lt;code&gt;todolist.js&lt;/code&gt;的文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/models/todolist.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; db = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../config/db.js&#39;&lt;/span&gt;), &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      todoModel = &lt;span class=&quot;string&quot;&gt;&#39;../schema/list.js&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 引入todolist的表结构&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; TodolistDb = db.Todolist; &lt;span class=&quot;comment&quot;&gt;// 引入数据库&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Todolist = TodolistDb.import(todoModel); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getTodolistById = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&amp;#123;  &lt;span class=&quot;comment&quot;&gt;// 获取某个用户的全部todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; todolist = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; Todolist.findAll(&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 查找全部的todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    where: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      user_id: id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    attributes: [&lt;span class=&quot;string&quot;&gt;&#39;id&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;content&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;status&#39;&lt;/span&gt;] &lt;span class=&quot;comment&quot;&gt;// 只需返回这三个字段的结果即可&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; todolist &lt;span class=&quot;comment&quot;&gt;// 返回数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; createTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 给某个用户创建一条todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; Todolist.create(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    user_id: data.id, &lt;span class=&quot;comment&quot;&gt;// 用户的id，用来确定给哪个用户创建&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    content: data.content,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    status: data.status &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getTodolistById,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  createTodolist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接着去&lt;code&gt;controllers&lt;/code&gt;目录下新建一个&lt;code&gt;todolist.js&lt;/code&gt;的文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/controllers/todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; todolist = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../models/todolist.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; getTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 获取某个用户的所有todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.id; &lt;span class=&quot;comment&quot;&gt;// 获取url里传过来的参数里的id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; todolist.getTodolistById(id);  &lt;span class=&quot;comment&quot;&gt;// 通过yield “同步”地返回查询结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = result &lt;span class=&quot;comment&quot;&gt;// 将请求的结果放到response的body里返回&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; createTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 给某个用户创建一条todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; data = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.request.body; &lt;span class=&quot;comment&quot;&gt;// post请求，数据是在request.body里的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; todolist.createTodolist(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    success: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = (router) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.get(&lt;span class=&quot;string&quot;&gt;&#39;/todolist/:id&#39;&lt;/span&gt;, getTodolist),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.post(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;, createTodolist)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后去&lt;code&gt;routes&lt;/code&gt;文件夹里新建一个&lt;code&gt;api.js&lt;/code&gt;文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/routes/api.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; todolist = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../controllers/todolist.js&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; router = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-router&#39;&lt;/span&gt;)();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;todolist(router); &lt;span class=&quot;comment&quot;&gt;// 引入koa-router&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = router; &lt;span class=&quot;comment&quot;&gt;// 导出router规则&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后，去根目录下的&lt;code&gt;app.js&lt;/code&gt;，给koa加上新的路由规则：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// app.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , koa = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-router&#39;&lt;/span&gt;)()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , json = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-json&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-logger&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , auth = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./server/routes/auth.js&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , api = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./server/routes/api.js&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  , jwt = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-jwt&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ..... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;next&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; start = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; ms = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt; - start;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;%s %s - %s&#39;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.method, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.url, ms);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; *(&lt;span class=&quot;params&quot;&gt;next&lt;/span&gt;)&lt;/span&gt;&amp;#123;  &lt;span class=&quot;comment&quot;&gt;//  如果JWT验证失败，返回验证失败信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (err) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;number&quot;&gt;401&lt;/span&gt; == err.status) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.status = &lt;span class=&quot;number&quot;&gt;401&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        success: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        token: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        info: &lt;span class=&quot;string&quot;&gt;&#39;Protected resource, use Authorization header to get access&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; err;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.on(&lt;span class=&quot;string&quot;&gt;&#39;error&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, ctx&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;server error&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&#39;/auth&#39;&lt;/span&gt;, auth.routes()); &lt;span class=&quot;comment&quot;&gt;// 挂载到koa-router上，同时会让所有的auth的请求路径前面加上&#39;/auth&#39;的请求路径。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&quot;/api&quot;&lt;/span&gt;,jwt(&amp;#123;secret: &lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;&amp;#125;),api.routes()) &lt;span class=&quot;comment&quot;&gt;// 所有走/api/打头的请求都需要经过jwt中间件的验证。secret密钥必须跟我们当初签发的secret一致&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(koa.routes()); &lt;span class=&quot;comment&quot;&gt;// 将路由规则挂载到Koa上。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至此，后端的两个api已经构建完成。&lt;/p&gt;
&lt;p&gt;初始化配置相对复杂一些，涉及到&lt;code&gt;model&lt;/code&gt;、&lt;code&gt;controllers&lt;/code&gt;、&lt;code&gt;routes&lt;/code&gt;和&lt;code&gt;app.js&lt;/code&gt;，可能会让人望而却步。实际上第一次构建完成之后，后续要添加api，基本上只需要在&lt;code&gt;model&lt;/code&gt;和&lt;code&gt;controllers&lt;/code&gt;写好方法，定好接口即可，十分方便。&lt;/p&gt;
&lt;h3 id=&quot;前端对接接口&quot;&gt;前端对接接口&lt;/h3&gt;&lt;p&gt;后端接口已经开放，接下来要把前端和后端进行对接。主要有两个对接接口：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;获取某个用户的所有todolist&lt;/li&gt;
&lt;li&gt;创建某个用户的一条todolist&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;接下来就是改写&lt;code&gt;Todolist.vue&lt;/code&gt;里的方法了：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// todolist.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;created()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; userInfo = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getUserInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(userInfo != &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = userInfo.id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = userInfo.name;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getTodolist(); &lt;span class=&quot;comment&quot;&gt;// 新增：在组件创建时获取todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;methods: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  addTodos() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos == &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      status: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      content: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      id: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.post(&lt;span class=&quot;string&quot;&gt;&#39;/api/todolist&#39;&lt;/span&gt;, obj) &lt;span class=&quot;comment&quot;&gt;// 新增创建请求&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      .then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;)&amp;#123; &lt;span class=&quot;comment&quot;&gt;// 当返回的状态为200成功时&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            message: &lt;span class=&quot;string&quot;&gt;&#39;创建成功！&#39;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getTodolist(); &lt;span class=&quot;comment&quot;&gt;// 获得最新的todolist&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;创建失败！&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 当返回不是200说明处理出问题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;创建失败！&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 当没有返回值说明服务端错误或者请求没发送出去&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.todos = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 将当前todos清空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// ... 省略一些方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getTodolist()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.get(&lt;span class=&quot;string&quot;&gt;&#39;/api/todolist/&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id) &lt;span class=&quot;comment&quot;&gt;// 向后端发送获取todolist的请求&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      .then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list = res.data &lt;span class=&quot;comment&quot;&gt;// 将获取的信息塞入实例里的list&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;获取列表失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;获取列表失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至此，前后端的部分已经完整构建。让我们来看看效果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/login2todolist-4.gif&quot; alt=&quot;todolist&quot; title=&quot;todolist&quot;&gt;&lt;/p&gt;
&lt;p&gt;做到这一步的时候其实我们的应用已经基本完成了。最后的收尾工作，让我们来收一下。&lt;/p&gt;
&lt;p&gt;原本的前端版本还有&lt;code&gt;完成&lt;/code&gt;、&lt;code&gt;删除&lt;/code&gt;、&lt;code&gt;还原&lt;/code&gt;三种状态，其中&lt;code&gt;完成&lt;/code&gt;和&lt;code&gt;还原&lt;/code&gt;只是状态的切换（更新），所以可以算是一个api，然后就是删除是单独一个api。于是我们就能算是完成了增、删、改、查了。接下去的部分就提供代码就行，其实思路跟之前的是一样的，只不过操作的函数不一样罢了。&lt;/p&gt;
&lt;h3 id=&quot;Todolist的改、删&quot;&gt;Todolist的改、删&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/models/todolist.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; removeTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;id,user_id&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; Todolist.destroy(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    where: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      id,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      user_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; updateTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;id,user_id,status&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; Todolist.update(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      where: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        id,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        user_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  getTodolistById,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  createTodolist,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  removeTodolist,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  updateTodolist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// server/controllers/todolist.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; removeTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user_id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.userId;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; todolist.removeTodolist(id,user_id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    success: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; updateTodolist = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.id;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user_id = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.userId;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; status = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.params.status; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  status == &lt;span class=&quot;string&quot;&gt;&#39;0&#39;&lt;/span&gt; ? status = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; : status =  &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;span class=&quot;comment&quot;&gt;// 状态反转（更新）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; result = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; todolist.updateTodolist(id,user_id,status);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.body = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    success: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = (router) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.get(&lt;span class=&quot;string&quot;&gt;&#39;/todolist/:id&#39;&lt;/span&gt;, getTodolist),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.post(&lt;span class=&quot;string&quot;&gt;&#39;/todolist&#39;&lt;/span&gt;, createTodolist),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.delete(&lt;span class=&quot;string&quot;&gt;&#39;/todolist/:userId/:id&#39;&lt;/span&gt;, removeTodolist),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  router.put(&lt;span class=&quot;string&quot;&gt;&#39;/todolist/:userId/:id/:status&#39;&lt;/span&gt;, updateTodolist)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt; &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- src/components/TodoList.vue --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;....&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 把完成和还原的方法替换成了update --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;small&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;update(index)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;完成&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;....&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;size&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;small&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;primary&quot;&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;update(index)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;还原&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;el-button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;....&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ....省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    update(index) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.put(&lt;span class=&quot;string&quot;&gt;&#39;/api/todolist/&#39;&lt;/span&gt;+ &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id + &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[index].id + &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[index].status)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              message: &lt;span class=&quot;string&quot;&gt;&#39;任务状态更新成功！&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getTodolist();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;任务状态更新失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;任务状态更新失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    remove(index) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.delete(&lt;span class=&quot;string&quot;&gt;&#39;/api/todolist/&#39;&lt;/span&gt;+ &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id + &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.list[index].id)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then((res) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(res.status == &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              type: &lt;span class=&quot;string&quot;&gt;&#39;success&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              message: &lt;span class=&quot;string&quot;&gt;&#39;任务删除成功！&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.getTodolist();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;任务删除失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;, (err) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$message.error(&lt;span class=&quot;string&quot;&gt;&#39;任务删除失败！&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;....&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;让我们来看看最后99%成品的效果吧：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/todolist-5.gif&quot; alt=&quot;Todolist&quot; title=&quot;todolist&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;项目部署&quot;&gt;项目部署&lt;/h2&gt;&lt;p&gt;很多教程到类似于我上面的部分就结束了。但是实际上我们做一个项目最想要的就是部署给大家用不是么？&lt;/p&gt;
&lt;p&gt;在部署这块有些坑，需要让大家也一起知道一下。这个项目是个全栈项目（虽然是个很简单的。。。），所以就涉及到前后端通信的问题，也就会涉及到是同域请求还是跨域请求。&lt;/p&gt;
&lt;p&gt;我们也说过，要解决这个问题有两种方便的解决办法，第一种，服务端加上&lt;code&gt;cors&lt;/code&gt;，客户端就可以随意的跨域请求。但是这样会有个问题，因为我们是以同域的形式开发，请求的地址也是写的相对地址：&lt;code&gt;/api/*&lt;/code&gt;、&lt;code&gt;auth/*&lt;/code&gt;这样的路径，访问的路径的自然是同域。如果要在服务端加上&lt;code&gt;cors&lt;/code&gt;，我们还需要将我们的所有请求地址改成&lt;code&gt;localhost:8889/api/*&lt;/code&gt;，&lt;code&gt;localhost:8889/auth/*&lt;/code&gt;，这样的话，如果服务端的端口号一变，我们还需要重新修改前端所有的请求地址。这样很不方便也很不科学。&lt;/p&gt;
&lt;p&gt;因此，要将请求变为同域才是最好的解决办法——不管服务端端口号怎么变，只要是同域都可以请求到。&lt;/p&gt;
&lt;p&gt;于是要把Vue和Koa结合起来变成一个完整的项目（之前实际上都是在开发模式下，webpack帮我们进行请求的代理转发，所以看起来像是同域请求，而Vue和Koa并没有完全结合起来），就得在生产模式下，将Vue的静态文件交给Koa“托管”，所有访问前端的请求全部走Koa端，包括静态文件资源的请求，也走Koa端，把Koa作为一个Vue项目的静态资源服务器，这样就可以让Vue里的请求走的都是同域了。（相当于，之前开发模式是webpack开启了一个服务器托管了Vue的资源和请求，现在生产模式下改成Koa托管Vue的资源和请求）&lt;/p&gt;
&lt;p&gt;要在开发和生产模式改变不同的托管服务器，其实也很简单，只需要在生产模式下，用Koa的静态资源服务中间件托管构建好的Vue文件即可。&lt;/p&gt;
&lt;h3 id=&quot;Webpack打包&quot;&gt;Webpack打包&lt;/h3&gt;&lt;p&gt;部署之前我们要用Webpack将我们的前端项目打包输出一下。但是如果直接用&lt;code&gt;npm run build&lt;/code&gt;，你会发现打包出来的文件太大了：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                                  Asset       Size  Chunks             Chunk Names&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    static/css/app.d9034&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;06fd57ce00d6e75ed49f0dafe.css     &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 static/fonts/element-icons.a61be9c.eot    &lt;span class=&quot;number&quot;&gt;13.5&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   static/img/element-icons.&lt;span class=&quot;number&quot;&gt;09162&lt;/span&gt;bc.svg    &lt;span class=&quot;number&quot;&gt;17.4&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             static/js/manifest.&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;ea250834bdc80e4d73b.js  &lt;span class=&quot;number&quot;&gt;832&lt;/span&gt; bytes       &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  manifest&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               static/js/vendor.&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;bbe7ecea37b0d4c62d.js     &lt;span class=&quot;number&quot;&gt;623&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  vendor&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  static/js/app.e2d125562bfc4c57f9cb.js    &lt;span class=&quot;number&quot;&gt;16.5&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 static/fonts/element-icons.b02bdc1.ttf    &lt;span class=&quot;number&quot;&gt;13.2&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         static/js/manifest.&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;ea250834bdc80e4d73b.js.map    &lt;span class=&quot;number&quot;&gt;8.86&lt;/span&gt; kB       &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  manifest&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           static/js/vendor.&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;bbe7ecea37b0d4c62d.js.map    &lt;span class=&quot;number&quot;&gt;3.94&lt;/span&gt; MB    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  vendor&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              static/js/app.e2d125562bfc4c57f9cb.js.map    &lt;span class=&quot;number&quot;&gt;64.8&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;static/css/app.d9034&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;06fd57ce00d6e75ed49f0dafe.css.map     &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                             index.html  &lt;span class=&quot;number&quot;&gt;563&lt;/span&gt; bytes          [emitted]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;竟然有3.94MB的map文件。这肯定是不能接受的。于是要修改一下webpack的输出的设置，取消输出map文件。&lt;/p&gt;
&lt;p&gt;找到根目录下的&lt;code&gt;config/index.js&lt;/code&gt;：把&lt;code&gt;productionSourceMap: true&lt;/code&gt;这句话改成&lt;code&gt;productionSourceMap: false&lt;/code&gt;。然后再执行一遍&lt;code&gt;npm run build&lt;/code&gt;。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;                                              Asset       Size  Chunks             Chunk Names&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             static/fonts/element-icons.a61be9c.eot    &lt;span class=&quot;number&quot;&gt;13.5&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             static/fonts/element-icons.b02bdc1.ttf    &lt;span class=&quot;number&quot;&gt;13.2&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               static/img/element-icons.&lt;span class=&quot;number&quot;&gt;09162&lt;/span&gt;bc.svg    &lt;span class=&quot;number&quot;&gt;17.4&lt;/span&gt; kB          [emitted]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         static/js/manifest.&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;ba218c80028a707a728.js  &lt;span class=&quot;number&quot;&gt;774&lt;/span&gt; bytes       &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  manifest&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           static/js/vendor.&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;bbe7ecea37b0d4c62d.js     &lt;span class=&quot;number&quot;&gt;623&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  vendor&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              static/js/app.b6acaca2531&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;0baa447.js    &lt;span class=&quot;number&quot;&gt;16.5&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;static/css/app.d9034&lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt;06fd57ce00d6e75ed49f0dafe.css     &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt; kB    &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;  [emitted]  app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                         index.html  &lt;span class=&quot;number&quot;&gt;563&lt;/span&gt; bytes          [emitted]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;把sourceMap去掉了之后，体积就小下来了。虽然600+kb的大小还是有点大，不过放到服务端，gzip之后只剩150+kb的体积勉强还是可以接受。当然，对于webpack输出的优化，不是本文讨论的范围，有很多更好的文章讲述了这个东西，故本文不再详细展开。&lt;/p&gt;
&lt;p&gt;打包好后就是相当于输出了一堆静态文件，当然这堆静态文件需要放在服务端才可以访问。我们要将这堆静态资源用Koa托管。&lt;/p&gt;
&lt;h3 id=&quot;Koa_serve静态资源&quot;&gt;Koa serve静态资源&lt;/h3&gt;&lt;p&gt;&lt;code&gt;yarn add koa-static&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;打开&lt;code&gt;app.js&lt;/code&gt;，引入两个新依赖，其中&lt;code&gt;path&lt;/code&gt;是nodejs原生自带。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// app.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// .... &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; path =&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    , serve = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-static&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ....&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 静态文件serve在koa-router的其他规则之上 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(serve(path.resolve(&lt;span class=&quot;string&quot;&gt;&#39;dist&#39;&lt;/span&gt;))); &lt;span class=&quot;comment&quot;&gt;// 将webpack打包好的项目目录作为Koa静态文件服务的目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 下面这些是之前就有的。。。为了方便找位置故标示出来&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&#39;/auth&#39;&lt;/span&gt;, auth.routes());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&quot;/api&quot;&lt;/span&gt;,jwt(&amp;#123;secret: &lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;&amp;#125;),api.routes()) &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后重新运行一遍&lt;code&gt;node app.js&lt;/code&gt;，看到输出&lt;code&gt;Koa is listening in 8889&lt;/code&gt;后，你可以打开浏览器&lt;code&gt;localhost:8889&lt;/code&gt;就可以看到如下情景：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/vue-koa.png&quot; alt=&quot;vue-koa&quot;&gt;&lt;/p&gt;
&lt;p&gt;至此已经基本上接近尾声，不过还存在一个问题：如果我们登录进去之后，在todolist页面一刷新，就会出现：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/404.png&quot; alt=&quot;404&quot; title=&quot;404&quot;&gt;&lt;/p&gt;
&lt;p&gt;为什么会出现这种情况？简单来说是因为我们使用了前端路由，用了HTML5 的History模式，如果没有做其他任何配置的话，刷新页面，那么浏览器将会去服务端访问这个页面地址，因为服务端并没有配置这个地址的路由，所以自然就返回404 Not Found了。&lt;/p&gt;
&lt;p&gt;详细可以参考vue-router的&lt;a href=&quot;https://router.vuejs.org/zh-cn/essentials/history-mode.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文档&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;该怎么解决？其实也很简单，多加一个中间件：&lt;code&gt;koa-history-api-fallback&lt;/code&gt;即可.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yarn add koa-history-api-fallback&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//... 省略&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; historyApiFallback = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-history-api-fallback&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 引入依赖&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa-bodyparser&#39;&lt;/span&gt;)());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(json());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(logger());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(historyApiFallback()); &lt;span class=&quot;comment&quot;&gt;// 在这个地方加入。一定要加在静态文件的serve之前，否则会失效。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个时候，你再重新启动一下koa，登录之后再刷新页面，就不会再出现404 Not Found了。&lt;/p&gt;
&lt;h3 id=&quot;API_Test-1&quot;&gt;API Test&lt;/h3&gt;&lt;p&gt;本来写到上面基本本文已经算是结束了。但是由于我在开发的过程中遇到了一些问题，所以还需要做一些微调。&lt;/p&gt;
&lt;p&gt;我们知道koa的use方法是有顺序只差的。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(A);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(B);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; app = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;koa&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(B);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(A);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这二者是有区别的，谁先被use，谁的规则就放到前面先执行。&lt;/p&gt;
&lt;p&gt;因此如果我们将静态文件的serve以及&lt;code&gt;historyApiFallback&lt;/code&gt;放在了api的请求之前，那么用postman测试api的时候总会先返回完整的页面：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/vue-koa-demo/postman.png&quot; alt=&quot;postman&quot;&gt;&lt;/p&gt;
&lt;p&gt;因此正确的做法，应该是将它们放到我们写的api的规则之后：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// app.js&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&#39;/auth&#39;&lt;/span&gt;, auth.routes()); &lt;span class=&quot;comment&quot;&gt;// 挂载到koa-router上，同时会让所有的auth的请求路径前面加上&#39;/auth&#39;的请求路径。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;koa.use(&lt;span class=&quot;string&quot;&gt;&quot;/api&quot;&lt;/span&gt;,jwt(&amp;#123;secret: &lt;span class=&quot;string&quot;&gt;&#39;vue-koa-demo&#39;&lt;/span&gt;&amp;#125;),api.routes()) &lt;span class=&quot;comment&quot;&gt;// 所有走/api/打头的请求都需要经过jwt验证。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(koa.routes()); &lt;span class=&quot;comment&quot;&gt;// 将路由规则挂载到Koa上。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(historyApiFallback()); &lt;span class=&quot;comment&quot;&gt;// 将这两个中间件挂载在api的路由之后&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(serve(path.resolve(&lt;span class=&quot;string&quot;&gt;&#39;dist&#39;&lt;/span&gt;))); &lt;span class=&quot;comment&quot;&gt;// 将webpack打包好的项目目录作为Koa静态文件服务的目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就能正常返回数据了。&lt;/p&gt;
&lt;h3 id=&quot;Nginx配置&quot;&gt;Nginx配置&lt;/h3&gt;&lt;p&gt;真正部署到服务器的时候，我们肯定不会让大家输入&lt;code&gt;域名:8889&lt;/code&gt;这样的方式让大家访问。所以需要用Nginx监听80端口，把访问我们指定域名的请求引导转发给Koa服务端。&lt;/p&gt;
&lt;p&gt;大致的&lt;code&gt;nginx.conf&lt;/code&gt;如下：&lt;/p&gt;
&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;http&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;# ....&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title&quot;&gt;upstream&lt;/span&gt; koa.server&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;127.0.0.1:8889&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title&quot;&gt;server&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;listen&lt;/span&gt;   &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;server_name&lt;/span&gt; xxx.xxx.com;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;title&quot;&gt;location&lt;/span&gt; / &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;title&quot;&gt;proxy_pass&lt;/span&gt; &lt;span class=&quot;url&quot;&gt;http://koa.server&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;title&quot;&gt;proxy_redirect&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;off&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;#....&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;#....&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果有精力还可以配置一下Nginx的Gzip，能让请求的JS\CSS\HTML等静态文件更小，响应速度更快些。&lt;/p&gt;
&lt;h2 id=&quot;写在最后&quot;&gt;写在最后&lt;/h2&gt;&lt;p&gt;至此，我们已经完成了一个从前端到后端，从本地到服务器的完整项目。虽然它真的是个很简单的小东西，被大家也已经用其他的方式写烂了（比如用localStorage做存储）。但是它作为一个完整的前后端的DEMO，我觉得让大家入门也相对更容易一些，能够体会到全栈开发也不是想象中的“那么难”（入门的难度还是可以接受的嘛）。有了Nodejs之后我们能够做的事真的好多！&lt;/p&gt;
&lt;p&gt;当然，由于篇幅有限，本文能够讲述东西毕竟不够多，而且讲的东西也不可能面面俱到，很多东西都是点到即止，让大家能够自己发挥。其实还想讲讲&lt;code&gt;Event Bus&lt;/code&gt;的简单使用，还有分页的基本实现等等，东西太多了，一时间大家消化不了。&lt;/p&gt;
&lt;p&gt;实际上我在做前段时间的项目的时候，也是完全不知道怎么把Vue和Koa结合起来开发。我甚至不知道怎么用Koa来提供API，我只会用Koa来做服务端渲染，比如那些JADE\EJS等模板引擎渲染的页面。所以之前那个项目做完让我自己学到良多东西，故而也分享给大家。&lt;/p&gt;
&lt;p&gt;实际上本文的Koa的api提供的形式也尽量和RESTful靠拢了，因此你也可以学会如何通过Koa提供RESTful形式的API了。&lt;/p&gt;
&lt;p&gt;最后放上本文项目的Github&lt;a href=&quot;https://github.com/Molunerfinn/vue-koa-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;地址&lt;/a&gt;，如果这个项目对你有帮助，希望大家可以fork，给我提建议，如果再有时间，可以点个Star那就更好啦~&lt;/p&gt;
&lt;p&gt;新年前的最后一篇文章了吧，提前祝大家新年快乐233。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注： 转载需经过同意，必须署名&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介&quot;&gt;简介&lt;/h2&gt;&lt;p&gt;本文从一名新手的角度（默认对Vue有了解，对Koa或者Express有了解）出发，从0开始构建一个数据通过Koa提供API的形式获取，页面通过Vue渲染的完整的前端项目。可以了解到Vue构建单页面的一些知识以及前端路由的使用、Koa如何提供API接口，如何进行访问过滤（路由）、验证（JSON-WEB-TOKEN）以及Sequelize操作MySQL数据库的一些知识和技巧，希望能够作为一篇入门全栈开发的文章吧。&lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
      <category term="Nodejs" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/Nodejs/"/>
    
    
      <category term="Nodejs" scheme="https://molunerfinn.com/tags/Nodejs/"/>
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>一周一部好电影Ⅲ【WEEK143】浪潮</title>
    <link href="https://molunerfinn.com/PerfectMoviePerWeek3/"/>
    <id>https://molunerfinn.com/PerfectMoviePerWeek3/</id>
    <published>2016-12-20T07:01:00.000Z</published>
    <updated>2017-01-19T14:28:52.694Z</updated>
    
    <content type="html">&lt;p&gt;2016-12-20 WEEK143 浪潮&lt;/p&gt;
&lt;p&gt;浪潮——————————————Die Welle&lt;br&gt;&lt;img src=&quot;https://img.piegg.cn/week143.jpg&quot; alt=&quot;浪潮&quot; title=&quot;浪潮&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演：丹尼斯·甘塞尔&lt;/li&gt;
&lt;li&gt;主演：尤尔根·沃格尔/弗雷德里克·劳/马克思·雷迈特/詹妮弗·乌尔里希/克里斯蒂安妮·保罗/雅各布·马特施恩茨/克里斯蒂娜·度·瑞格/埃利亚斯·穆巴里克/马克西米利安·福尔马尔/马克思·马福&lt;/li&gt;
&lt;li&gt;片长：107 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/惊悚&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.7/10(from111,344users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from82,990users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本次给大家带来的是来自德国的电影《浪潮》。这部电影根据真实故事改编，原型是美国在1967年的一个青年教师的一个微型纳粹主义重现的课堂实验。虽然是上个世纪60年代的故事，但是就如同当事人（教师）所说，放到今天，这样的情况也还是会发生。发人深省。&lt;/p&gt;
&lt;p&gt;其实作为我自己我觉得我并不会参与到这样的“闹剧”中，我们大多数人都不会。这与我们所接受的教育有关。而故事发生的地方是德国、美国这样从小提倡自主思考的国家。思维放任自由的同时，也缺少了相应的集体认同感。所以一旦拥有一个这样的机会，对他们来说仿佛是打开了一道崭新的大门，让他们找到了“集体”，找到了“归属感”，找到了“安全感”。发人深省的是，很多的决策都是通过民主表决产生的，很多行为都是他们自发的。影片中塑造了很多不同类型的受影响的学生，从各个方面向我们展示了要实现一个纳粹主义是有多么容易却也多么可怕。当然，凡事都不缺乏头脑清醒的人。但是在这样的浪潮中，众人皆醉我独醒，作为鹤立鸡群的一员，反而会受到来自周围人的排挤和敌视。要么作为一朵浪花追逐大浪，要么作为一丝蒸汽烟消云散。不管是同学、还是老师，表演的都十分到位，真实而震撼。&lt;/p&gt;
&lt;p&gt;这是一场悲剧，也是一场闹剧。也希望这种事不要再上演。好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-12-13 WEEK142 硫磺岛家书&lt;/p&gt;
&lt;p&gt;硫磺岛家书——————————————Letters from Iwo Jima&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week142.jpg&quot; alt=&quot;硫磺岛家书&quot; title=&quot;硫磺岛家书&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：克林特·伊斯特伍德&lt;/li&gt;
&lt;li&gt;主演：渡边谦/二宫和也/加濑亮/中村狮童/伊原刚志/裕木奈江/松崎悠希/&lt;/li&gt;
&lt;li&gt;片长：141 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/历史/战争&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from27,672users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.9/10(from134,090users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。今天是国家公祭日，悼念、纪念南京大屠杀79周年。牢记历史，勿忘国耻。&lt;/p&gt;
&lt;p&gt;本片导演是美国人，用日本人的视角去讲述太平洋战争里最惨烈的硫磺岛一战。（导演同时还拍了另外一部以美国人为视角的《父辈的旗帜》，可以一起观看）。侵华日军罪恶滔天，不可饶恕，不过这次当我们看到的不是入侵别国的日本军队而相反，是“保卫”自己领土的日本军队的时候，你也许也会被那些为了保卫自己国家而壮烈牺牲的日本人而触动。&lt;/p&gt;
&lt;p&gt;就事论事，讨论电影本身。电影本身的切入点就非常能够打动你——家书。写给家人的信，家人写来的信。这一封封家书无不体现了战争年代的残酷。胜利或者失败，活着或者阵亡，牺牲还是投降，没有一件事情是你能够预料的。而对于家人的牵挂，对于故乡的怀念，却是不能停下的。对于一个士兵而言，他可能是个父亲，也可能是个儿子，也会是个丈夫。他的背后有着一家人。战争的残酷在于这些家书永远无法寄到家人的手中，在于他们中的很多人无法回到家人的怀抱中。影片写实的风格，从将军、到小兵，都有着自己的故事。感人肺腑，却也痛彻心扉。&lt;/p&gt;
&lt;p&gt;仅仅作为一部反战片我觉得还是不够，还是需要好好品味，同一片蓝天，不同的命运。愿世界再无战争。谨以此片推给各位。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-12-03 WEEK141 微不足道&lt;/p&gt;
&lt;p&gt;微不足道——————————————Big Nothing&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week141.jpg&quot; alt=&quot;微不足道&quot; title=&quot;微不足道&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：让-巴普蒂斯特·安德烈&lt;/li&gt;
&lt;li&gt;主演：西蒙·佩吉/大卫·休默/娜塔莎· 麦克艾霍恩/爱丽丝·伊芙/乔·鲍里托&lt;/li&gt;
&lt;li&gt;片长：86 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：喜剧/惊悚/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.1/10(from30,147users)&lt;/li&gt;
&lt;li&gt;IMDB评分：6.8/10(from26,270users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位~本周给大家推荐的是一部“黑色”喜剧，来自英国、加拿大的《微不足道》。一开始听到这个名字的时候我是觉得这不会是整部电影我很想用四个字来形容——“荒诞”喜剧。不过真的“荒诞”么？剧情上是一波多折，根本猜不透下一时刻将要发生什么，时刻带着幽默搞笑诙谐的气氛来描绘“血腥”、“可怕”的犯罪现场是不是很“荒诞”？不过真正仔细审视这部电影，你会发现很多细节值得品味。不仅是开头事无巨细的铺垫，还是后来“真相”被揭开的时候都能看出导演的匠心所在。不那么荒诞了，而是会心一笑。每个角色有自己的&lt;/p&gt;
&lt;p&gt;演员的表演也真的很到位，主演都是大家熟悉的老戏骨了，演技自然到位不多说。为此我更希望大家看这部电影的时候多注意每个镜头，多想想最后的结局。轻松诙谐又不失深度的好电影，推荐观看~&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-11-26 WEEK140 精英部队2&lt;/p&gt;
&lt;p&gt;精英部队2——————————————Tropa de Elite 2 - O Inimigo Agora É Outro&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week140.jpg&quot; alt=&quot;精英部队2&quot; title=&quot;精英部队2&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：若泽·帕迪里亚&lt;/li&gt;
&lt;li&gt;主演：瓦格纳·马拉/安德烈·拉米罗/米尔黑·考塔兹/伊兰迪尔·桑托斯/玛利亚·瑞贝罗/…&lt;/li&gt;
&lt;li&gt;片长：115分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/动作/惊悚/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from42,534users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from67,839users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位~本周给大家推荐的是一部来自巴西的电影《精英部队2》。为什么推荐的是第二部，因为第二部比第一部拍的还好的电影真的不常见，《精英部队2》做到了。&lt;br&gt;这是一部讲述巴西特有的BOPE部队和里约热内卢的腐败警察系统的故事。这部电影创下了巴西有史以来的最高票房。为什么能获得这么好的评价，有三点分不开：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;写实，赤裸裸的政府 腐败（虽然片头说的是纯属虚构）&lt;/li&gt;
&lt;li&gt;大手笔，从BOPE到安全局，从体制外到体制内&lt;/li&gt;
&lt;li&gt;干净利落，扣人心弦&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;全程无尿点，叙事结构上的承前启后，情节上的一波三折，画面上的果断血腥，都能紧紧抓住你的注意力。演员的情感表现也甚是棒，好几场情绪爆发的片段真的让人看了为之动容。&lt;br&gt;总之这是一部相当棒的“警匪”片，如果直接看第二部不看第一部其实也没有特别大的关系，不过最好还是看完第一部再看第二部，才能更好地体会到第二部的升华。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-11-19 WEEK139 美国X档案&lt;/p&gt;
&lt;p&gt;美国X档案——————————————American History X&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week139.jpg&quot; alt=&quot;美国X档案&quot; title=&quot;美国X档案&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：托尼·凯耶&lt;/li&gt;
&lt;li&gt;主演：爱德华·诺顿/爱德华·福隆/比佛莉·德安姬罗/艾弗利·布鲁克斯&lt;/li&gt;
&lt;li&gt;片长：119 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from58,975users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.6/10(from800,142users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位~本周给大家推荐的是一部非常有内涵的电影。不看电影的话我甚至一度认为这是一部讲述美国历史的电影，然后我就发现我错了——或者说部分错了。它实际上是美国社会对于种族问题的一个现实缩影——从这个角度上来说，它也确实算是一段历史吧，一段时时刻刻在上演的历史。&lt;/p&gt;
&lt;p&gt;由于美国的社会环境确实比较复杂，种族问题也是一直挥之不去。影片从一开始就给我们一记shock，黑白的镜头甚至让我一度认为这部电影是部黑白电影。两种人种的矛盾与冲突，拉开帷幕。狂热，偏执，歧视，仇恨。有我们所不能理解的，有我们所惊讶的，也有我们所认为好像可以接受的。主体的内容来自回忆，而这些在影片中被打散的回忆让我们看到了一个曾经多么优秀-》狂热的种族主义分子-》幡然醒悟-》重生的全过程。虽然有些转折的部分过于仓促，但是在两个小时内能够做到这样的转变——个人的转变结合历史的缩影，这已经足够可以接受了。诺顿的演技也是我非常惊叹的部分，一个人盘活了一部电影的感觉。我特别欣赏的是豆瓣里的一句评论：“他个人无法改变历史，但是他可以改变自己的历史，他个人的历史。”&lt;/p&gt;
&lt;p&gt;正值美国大选尘埃落定之际，远在美国的朋友用亲身经历告诉了我种族歧视的观念，排外的思想有多么可怕。谨推此片愿大家和平共处。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-11-12 WEEK138 火海凌云&lt;/p&gt;
&lt;p&gt;火海凌云——————————————Экипаж&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week138.jpg&quot; alt=&quot;火海凌云&quot; title=&quot;火海凌云&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：尼古拉·列别捷夫&lt;/li&gt;
&lt;li&gt;主演：丹尼拉·科兹洛夫斯基/弗拉基米尔·马什科夫/阿格尼·格鲁迪特/谢尔盖·加扎罗夫/凯瑟琳·斯皮茨/埃琳娜·雅克夫勒娃/谢尔盖·科姆珀&lt;/li&gt;
&lt;li&gt;片长：138分钟(俄罗斯)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/动作/冒险/灾难/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.6/10(from10,630users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.1/10(from1,507users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本期给大家推荐的是一部来自战斗民族的电影《火海凌云》。这部电影说是翻拍了1980年苏联同名电影，不过我没有看过1980年版本的。&lt;br&gt;其实本部电影的前一个小时左右的偏铺垫型的情节确实会比较拖沓。只不过拖沓的背后是把人物的性格、情感、感情线交待的相当清楚。也为后续的高潮部分的一些对比埋了伏笔。毫不夸张的说，这部电影之所以能够登上本次推荐的大堂，真的完全靠的时候全片后半部分高潮迭起的极具硬实力的剧情。将近45分钟的紧张情节，环环相扣。而且一些路人的牺牲也完全不拖泥带水——就是非常干净利落地挂了。。。没有好莱坞大片的各种煽情片段——战斗民族的电影的特征在最后的部分展现的淋漓尽致。本片的一些小的细节，甚至在于对于人的内心的描述，对于按规章办事还是根据实际做出决定的日常难题也给出非常强力的回应。&lt;br&gt;感受战斗民族的别样的电影情怀，好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-11-05 WEEK137 驴得水&lt;/p&gt;
&lt;p&gt;驴得水——————————————驴得水&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week137.jpg&quot; alt=&quot;驴得水&quot; title=&quot;驴得水&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：周申刘露&lt;/li&gt;
&lt;li&gt;主演：任素汐/大力/刘帅良/裴魁山/阿如那/韩彦博/卜冠今/王堃/高阳/苏千越/查尔斯·亚瑟/王峰&lt;/li&gt;
&lt;li&gt;片长：111分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.4/10(from64,080users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from78users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本期给大家推荐的是来自开心麻花的《驴得水》。这部标榜着喜剧的电影，却是不折不扣的一部悲剧。&lt;br&gt;故事设定的1942年还是国民党执政的年代。因为反讽的对象是当时落后腐朽的国民党，所以你可以发现这样一部全片飘着中华民国国旗而没有五星红旗的电影居然过审了。&lt;/p&gt;
&lt;p&gt;这部电影虽然会被诟病说是看一出话剧，但是这样张弛有力，内容丰富，暗讽明嘲，笑点独特的片子却是这么久以来中国喜剧电影所缺失的东西。观前几年的几部喜剧大作，大部分无非是为了博观众一笑而成了喜剧。而《驴得水》，在让你笑的同时，却在不停地敲击着你的神经。因为笑点的背后都是中国电影人很少愿意直接提及的东西，不管是对性的看法，还是对于贪污腐败这样赤裸裸的展示——这也是这部电影的精髓所在，它告诉了我们，事情没有绝对的对错，人也没有绝对的好坏。但是发生的转变却是让人啼笑皆非，甚至触目惊心的。虽然发生在1942，但是依然能够对当前的社会现象做出很多尖锐的抨击。好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-10-31 WEEK136 和声&lt;/p&gt;
&lt;p&gt;和声——————————————하모니&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week136.jpg&quot; alt=&quot;和声&quot; title=&quot;和声&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：康大奎&lt;/li&gt;
&lt;li&gt;主演：金允珍/罗文姬/郑秀英/张荣男/姜艺媛/池成媛&lt;/li&gt;
&lt;li&gt;片长：115分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from34,365users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.5/10(from506users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本周给大家推荐的电影是来自韩国的《和声》。提前预警，这部电影是一部强力催泪弹。与以往给大家推荐的韩国电影不同，这部电影并没有改编自哪个真实故事。但是演员们的真实的表演却能让你忍不住流下泪水。合唱团的故事不少，通常来说也都是励志范。但是本部电影唱出动人和声的合唱团，来自的却是一群关在女子监狱里的囚犯。励志吗？不，我觉得非常辛酸。女主人公建立这个合唱团不是为了俗套的——减刑，而是为了能够获得一天特赦让她和儿子一起在监狱外过一天。大家加入合唱团也是因为喜欢音乐，热爱唱歌、有这个机会而已。在描绘合唱团的组建、过程以及最后的演出的同时，导演也给几个关键角色都加以了深度的感情戏——毕竟都是因为各种各样的原因才会进入监狱的。但是有意思的是，女囚们进监狱的原因似乎都是——“情有可原”。当然这在现实中还是不会出现。不过我想导演在全片范围内都在营造一种良好的气氛，让人看完真的满满的暖心、同情和感动。同类的人之间不同的对比，不同的人之间相似的故事，等等。这些都是你不能回避，感同身受的东西。后劲非常足，好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-10-23 WEEK135 小鞋子&lt;/p&gt;
&lt;p&gt;小鞋子———————————————————————————————————بچههای آسمان&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week135.jpg&quot; alt=&quot;小鞋子&quot; title=&quot;小鞋子&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：马基德·马基迪&lt;/li&gt;
&lt;li&gt;主演：Amir Farrokh Hashemian/默罕默德·阿米尔·纳吉/Bahare Seddiqi/Nafise Jafar-Mohammadi/Fereshte Sarabandi&lt;/li&gt;
&lt;li&gt;片长：89 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/家庭/儿童&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.1/10(from114,985users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.4/10(from29,686users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位~本周给大家推荐的是一部来自伊朗的平凡而感人的电影《小鞋子》。本来我还以为这部电影，会宣扬阶级主义，贫富差距等东西。事实证明我的思想还是太僵化了，不免落入了俗套。看这部电影，我觉得不能用任何有色眼镜的眼光，不需要对每个镜头都刻意揣测——其实就是那么简单，那么平凡而深入你心。&lt;br&gt;影片的主线毋庸置疑就是鞋子。来自伊朗社会底层家庭的兄妹俩，年少当家，年少懂事。哥哥不小心弄丢了妹妹的鞋，两个人为了不给家庭增添负担，而轮流穿鞋上学。妹妹为了不让哥哥迟到而提前交卷，哥哥迟到被老师训斥也不会说一句跟妹妹有关的话。生活的艰辛给兄妹俩带来的，更是淳朴、善良的本性。不占他人便宜，不失去自己的本心。影片摘取的几个情节都极富感染力——除了上面说的这段情节之外，还有很多。没有华丽的特效，没有浮夸的辞藻——相反的，就是简简单单的一个眼神，一行泪水就能将你内心那份埋藏多年的同情彻底捐献。本片最令人感动也是全片的高潮是结尾。我不愿意再透露更多的东西，只想再说一句：&lt;br&gt;很多时候我们想要的东西不一定是“最好”的，但是对我们来说就是最好的。好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-10-16 WEEK134 湄公河行动&lt;/p&gt;
&lt;p&gt;湄公河行动———————————————————————————————————湄公河行动&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week134.jpg&quot; alt=&quot;湄公河行动&quot; title=&quot;湄公河行动&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：林超贤&lt;/li&gt;
&lt;li&gt;主演：张涵予/彭于晏/孙淳/陈宝国/冯文娟/刘显达子/赵健/吴旭东/吴嘉龙&lt;/li&gt;
&lt;li&gt;片长：124分钟&lt;/li&gt;
&lt;li&gt;影  片类型：动作/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.2/10(from169,920users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.1/10(from441users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本周给大家推荐的是最近大热的《湄公河行动》。没去电影院之前，就听了同学给的各种好评。而自己去看了之后发现，真的是难得一见的主旋律好片。通常来说国内的主旋律的电影总会陷入一种特别尴尬的境地——想拍的真实点却过不了审，想要过审却只能缺胳膊少腿地让人看完觉得是教条式地演出。而本片则有一个地方特别值得注意——公安部批准的剧本，广电总局得过。也因此我们能看到往常很少能在国内电影看到的一些镜头，童子军，自杀式袭击，杀人质等等——凸显真实而震撼。并且节奏十分紧凑，一波未平一波又起。整个电影的弦绷得非常紧，并且在一些大场面的镜头，一些震撼的爆破场景，一些高科技设备的引入，也让人大呼过瘾。最让人感动而敬佩的还是缉毒警察们的付出与牺牲。他们为了国家为了正义放弃了自己的家庭，放弃了安稳的生活而冲向了禁毒的最前线。在枪林弹雨中打掉一个又一个毒窝，拯救一批又一批迷失的人们。为湄公河事件中牺牲的13名中国船员哀悼，向湄公河行动中牺牲的缉毒警察、缉毒犬致敬，向奋战在禁毒前线的人民警察，鞠躬！好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-10-01 WEEK133 阿修罗 &lt;/p&gt;
&lt;p&gt;阿修罗———————————————————————————————————アシュラ&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week133.jpg&quot; alt=&quot;阿修罗&quot; title=&quot;阿修罗&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：佐藤敬一&lt;/li&gt;
&lt;li&gt;主演：野泽雅子/北大路欣也/林原惠美/Kinya Kitaohgi/池赖宏&lt;/li&gt;
&lt;li&gt;片长：76分钟&lt;/li&gt;
&lt;li&gt;影  片类型：动画/恐怖/历史&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from10,367users)&lt;/li&gt;
&lt;li&gt;IMDB评分：6.8/10(from732users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见~本周给大家推荐的是一部动画电影《阿修罗》。这部动画不是什么热血，无关爱情，甚至还不是温情感人的故事。基调从一开始就昏暗而压抑。相信很多人跟我一开始看的时候就很难接受前10分钟——关掉这部电影的播放，我觉得很正常。因为什么，因为太真实而残酷了。&lt;br&gt;本片反映的是日本平安时代（是的就是现在大热的《阴阳师》的主要背景年代）末期的故事。民不聊生，物资匮乏。底层百姓为了活下去，甚至出现了人吃人的情况。&lt;br&gt;而阿修罗就是在这样的背景下诞生的。水深火热之中的锤炼，要经受怎么样的饥饿才会去吃人肉？人性自有黑暗和阳光，而转变，要多少句“南无阿弥佗佛”才能换回来？是谁是为什么忍气吞声，是谁为了让佛是谁为什么饿死，，又是谁为什么不顾一切取下马肉。在这个年代下，活下去或许才是第一要义。而其他的人心，人性，还有多少人在管顾？&lt;br&gt;“即使背负起罪恶，也不辜负这条上天赐予的生命，努力活下去。世界，因此而美。”仁者见仁智者见智，小众的好电影，可以一看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-09-24 WEEK132 战争之王 &lt;/p&gt;
&lt;p&gt;战争之王———————————————————————————————————Lord of War&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week132.jpg&quot; alt=&quot;战争之王&quot; title=&quot;战争之王&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：安德鲁·尼科尔&lt;/li&gt;
&lt;li&gt;主演：尼古拉斯·凯奇/布丽姬·穆娜/杰瑞德·莱托/伊安·霍姆/伊桑·霍克/埃夫吉恩尼·拉扎雷夫/伊默恩·沃克/塔尼特·菲尼克斯/&lt;/li&gt;
&lt;li&gt;片长：122 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from150,245users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from249,796users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本期给大家推荐的是尼古拉斯凯奇为数不多的好电影233。看这部电影之前我一度认为是一部战争片。&lt;br&gt;影片一开始的一番话特别有意思。“这个时间上总共有五亿五千万支军火在流通，那就是说每十二个人就有一支枪，唯一的问题是，我们如何将武器卖给另外是十一个人？”这是一部讲述一个军火商传奇一生的电影。影片虽然说是取材自真实故事但是还是虚构了不少情节。不过这些情节让人物更加饱满了。一个与全世界的冲突地带打交道的人，一个与全世界军火走私有关系的人，一个处事不惊，“冷酷”而有所良知的军火商。影片里的武器，包括枪支和坦克等等很多都是真实的而非道具，让人看了更乎过瘾。而这里面的很多黑色幽默，也让人忍俊不禁。&lt;br&gt;但是最让我感慨而震撼的是影片的最后一句话：世界最大的军火供应商仍然是 美国 英国 俄罗斯 法国和中国，五个联合国安全理事会常任理事国。&lt;br&gt;这句话的讽刺意味不言而喻。与其说这部电影是部反战片，倒不如说是一部教育片。好电影，推荐给各位。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-09-17 WEEK131 隧道 &lt;/p&gt;
&lt;p&gt;隧道———————————————————————————————————터널&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week131.jpg&quot; alt=&quot;隧道&quot; title=&quot;隧道&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：金成勋&lt;/li&gt;
&lt;li&gt;主演：河正宇/吴达洙/裴斗娜/南志铉&lt;/li&gt;
&lt;li&gt;片长：126分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/灾难&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.6/10(from17,153users)&lt;/li&gt;
&lt;li&gt;IMDB评分：6.9/10(from224users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。其实本来本周想推荐给各位看看《釜山行》的。后来发现好多朋友都已经看过了。而因为《釜山行》的大热，导致这部同样挺不错的电影被“埋没”了。&lt;br&gt;相信如果看过《恐怖直播》的朋友们一定不会忘记主演河正宇精湛的演技。这部电影很多人估计也是冲着他来的。&lt;br&gt;不过整部电影看下来，河正宇的演技固然依旧动人，但是本片的其他部分还是不容忽视——尤其是本部电影最被人话题的就是它的讽刺几乎从头贯穿到尾，尤其是对于政府的讽刺更是让人忍俊不禁。&lt;br&gt;隧道内、隧道外的两种世界，两种心态，两种煎熬。我不知道，一条人命和一堆金钱在不同人眼里是长什么样的。举全国之力救一个人这种事我觉得发生的可能性微乎其微，但是在这里面暴露出来的问题，确是实实在在。都说韩国电影是个微社会，以韩国电影反观我们自己，却也是别样的一番味道。韩国拍的好的电影是真的好，推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-09-09 WEEK130 再次出发 &lt;/p&gt;
&lt;p&gt;再次出发———————————————————————————————————再次出发&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week130.jpg&quot; alt=&quot;再次出发&quot; title=&quot;再次出发&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：约翰·卡尼&lt;/li&gt;
&lt;li&gt;主演：凯拉·奈特莉/马克·鲁弗洛/詹姆斯·柯登/海莉·斯坦菲尔德/亚当·莱文/凯瑟琳·基纳/茅斯·达夫/罗伯·莫洛/席洛·格林&lt;/li&gt;
&lt;li&gt;片长：104分钟&lt;/li&gt;
&lt;li&gt;影  片类型：喜剧/爱情/音乐&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from126,042users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.4/10(from101,048users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。之前我曾经给大家推荐过《曾经》（《Once》）。今天这部电影是它的姊妹篇。有了《曾经》的成功尝试之后，导演约翰卡尼又带来这部以音乐为主旋律的电影。&lt;br&gt;有人喜欢《曾经》，有人喜欢《再次出发》。实际上，只是每个人的经历不同，反映到了不同电影之上产生的共鸣不同而已。我更喜欢《曾经》，但是不可否认这部电影同样很精彩。&lt;br&gt;《再次出发》对故事里的情感线的把握更加娴熟了。相比于《曾经》里简单的两个人，《再次出发》里有好多人。亲情、爱情、友情等等。这些感情的矛盾、冲突、交织、化解和释怀，靠的都是音乐。&lt;/p&gt;
&lt;p&gt;我最喜欢的一幕，是Dan失魂落魄到酒吧听到KK弹唱的声音的时候，其他人都不以为是，但Dan被这歌声所吸引并脑补了整个曲子应该有的样子。那个镜头真是太棒了。本来就不错的音乐，配上钢琴、大提琴、架子鼓等等瞬间一首动人的音乐就诞生了。我想这就是伯乐相马的故事吧。音乐在本部电影里被赋予了更多的内涵。KK能够从音乐里听出背叛，Dan能从歌单里了解一个人。&lt;/p&gt;
&lt;p&gt;还有好多好多的东西不能诉说。看着音乐被无缝衔接进电影，而且每首都能打动你的耳朵的那种感觉——真的，太棒了。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-09-03 WEEK129 重庆森林 &lt;/p&gt;
&lt;p&gt;重庆森林———————————————————————————————————重庆森林&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week129.jpg&quot; alt=&quot;重庆森林&quot; title=&quot;重庆森林&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：王家卫&lt;/li&gt;
&lt;li&gt;主演：林青霞/金城武/梁朝伟/王菲/周嘉玲&lt;/li&gt;
&lt;li&gt;片长：102分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/爱情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from263,037users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from40,682users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是王家卫早先导演的一部好电影《重庆森林》。这部电影不仅导演厉害，而且演员真的都是演技派。&lt;br&gt;“每天你都有机会跟别人擦肩而过，你也许对他一无所知，不过也许有一天他会变成你的一个朋友或知己。”擦肩而过的，哪怕只有0.01公分，也许永远错过，亦也许命运又会让两人相遇。&lt;br&gt;本片很有意思，尤其是漂亮的台词一点不输精彩的剧情。人物的内心活动，在旁白、或者直接在话语中，你能够听得一清二楚。心理活动的描绘让电影中的人物变得非常“立体”——有血有肉。阿武的“过期”理论是多么“幼稚”而好玩。30罐的凤梨罐头，4份厨师沙拉，将情感具象化又是多么令人惋惜。林青霞所饰演的女角，冷峻的外表下藏着还是一颗脆弱的心，露出黑发的那瞬间她又重新做回了自己。伴随着《California Dreaming》的节奏一起摇摆的阿菲怎么也不知道为什么自己能够爱上那个被爱情打击的633。单纯的爱在没有被发现之前都是那么可爱和美好，一旦被发现却又惊慌失措。梁朝伟饰演的633，对着滴水的毛巾说着流泪，对着快用完的香皂说变瘦。这些有趣的自言自语却让人感受到了他的孤独。回忆地越多受到的伤可能越多。也许还留着一丝念想，但是最终将会被现实打败，最终开始迎接新的生活，不管是阿武还是633都一样。&lt;br&gt;故事不在重庆，这里也没有森林。有的只是苍穹之下4个小人物平凡的爱情故事和一首看完电影忘不掉的加州梦。好电影，推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-08-27 WEEK128 被嫌弃的松子的一生&lt;/p&gt;
&lt;p&gt;被嫌弃的松子的一生———————————————————————————————————嫌われ松子の一生&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week128.jpg&quot; alt=&quot;被嫌弃的松子的一生&quot; title=&quot;被嫌弃的松子的一生&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：中岛哲也&lt;/li&gt;
&lt;li&gt;主演：中谷美纪/瑛太/香川照之/市川实日子/伊势谷友介/柄本明/黑泽明日香/荒川良良/柴崎幸/土屋安娜/奥之矢佳奈/谷原章介/武田真治/片平渚/宫藤官九郎/角野卓造/田中要次/木村KAELA/谷中敦/剧团一人&lt;/li&gt;
&lt;li&gt;片长：130 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/歌舞&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.9/10(from219,131users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.9/10(from4,480users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部来自日本的微微有些“重口味”的电影。一部带有喜剧成分的悲剧，令人感慨令人揪心。&lt;br&gt;其实从影片的题目中，你也可以看出一些端倪。电影真的是通过各种角度在短短两个小时之内，描绘了被嫌弃的松子的一生。松子的一生是悲剧的，但是她却是给他人带去欢乐的那个。也许她的要求很简单，只要求她爱的人也能够爱她，但是现实却是，她为了得到她所希望的爱却不得不自己掏心地付出，而通常付出的对象却不能好好珍惜这种付出，相反则认为这是理所应当的东西。&lt;br&gt;“人的一生不在乎得到多少，而在于付出了多少。”这是影片里在关键的点出现了多次的话语。本来是一句非常正能量的话，但是放在松子身上，我却看到了一丝凄凉。我多么希望，松子能够付出了多少，也能得到多少。&lt;br&gt;其实松子直到最后都没有放弃追求美好生活的权利，但是现实的蒙头一棒却将她永远带离了这个世界。我们在生活中，遇到的不少所谓的艰苦、挫折，相比于松子而言，有能算什么呢？但是往往我们就放弃了。&lt;br&gt;所以看到松子内心那份哪怕被全世界嫌弃也要勇于追求属于自己的人生的时候，你会发现，她真的不应该被你讨厌，她真的很美。推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-08-20 WEEK127 一个叫欧维的男人决定去死 &lt;/p&gt;
&lt;p&gt;一个叫欧维的男人决定去死———————————————————————————————————En man som heter Ove&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week127.jpg&quot; alt=&quot;一个叫欧维的男人决定去死&quot; title=&quot;一个叫欧维的男人决定去死&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：汉内斯·赫尔姆&lt;/li&gt;
&lt;li&gt;主演：托比亚斯·阿姆博瑞/安娜-莱娜·布伦丁/埃达·英格薇/..&lt;/li&gt;
&lt;li&gt;片长：112分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.7/10(from17,041users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from5,332users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部来自瑞士的冷门佳作。这部电影的名字看起来有点阴暗，但是看完之后你却会得到满满的阳光。&lt;br&gt;一个“偏执”，“刻薄”，满嘴愤怒，一脸杀气的老头，一上来就给观众带来极度“不爽”的感觉。事实上，我们在生活中也能碰见类似的人。大部分情况是，我们总会说这类人倚老卖老，鉴于年龄原因又不好跟老人进行多余的争执。我们不理解并总是以有色眼光去看待他们——称他们为“怪人”。&lt;br&gt;本部电影也是一样，塑造了一个这样的怪老头。但是随着故事的展开，一点一点剥开的回忆，一点一点浮出水面的真相，一点一点“不经意”的细节，都将让你重新审视你之前对这个人的认知。这个人也许，是个最有责任感的人呢？&lt;br&gt;围绕着欧维的几次自杀，将过去与现在的事件逐渐交织并最终回到现在。跟着主人公走完他的大半生，你也终于从一个一开始只会满嘴跑火车的愤青逐渐地成为一个理智的观众。欧维的爱情，欧维的处事，欧维的孤独等等，这些都是不可缺少的元素。一切都是那么平凡，但是确实又是能够打动你的内心的朴实。&lt;br&gt;影片中所提出的问题，“你是选择死亡还是努力活着呢？”看完它，把答案记在你的心中。推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-08-12 WEEK126 和莎莫的五百天 &lt;/p&gt;
&lt;p&gt;和莎莫的五百天———————————————————————————————————(500) Days of Summer&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week126.jpg&quot; alt=&quot;和莎莫的五百天&quot; title=&quot;和莎莫的五百天&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：马克·韦布&lt;/li&gt;
&lt;li&gt;主演：约瑟夫·高登-莱维特/佐伊·丹斯切尔/克拉克·格雷格/马修·格雷·古柏勒/吉奥弗瑞·阿伦德/科洛·莫瑞兹&lt;/li&gt;
&lt;li&gt;片长：95分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧/爱情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from274,841users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.7/10(from376,658users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部文艺小清新的爱情电影。电影名字特别特别有意思，summer，你完全可以理解为“夏天”。和莎莫的500天，从片名里你也能够看出，这将不是一部有着”美好“结局的电影。毕竟500天不是50000天。&lt;br&gt;相信爱情的Tom和不相信爱情的Summer，就像两条不平行的线，越走越近，直到相交，再到渐行渐远。男孩相信命中注定，女孩更追寻自由。他们之间发生的故事你可能似曾相识，也可能感同身受。&lt;br&gt;影片结构上，并没有老老实实地按照时间线走下去。相反，剪辑师华丽的刀工让整部电影从一开始就是破碎的。爱情的故事也是一样总不会一成不变。交错的时间轴并没有影响对于故事走向的判断。相反，相当多的前后照应是很棒的亮点。另外，剧中无时不刻穿插的配乐质量也相当高，更是加深了文艺的味道。&lt;br&gt;虽然说电影始终是电影，不过真的你看完这部电影之后，还是能够领悟到很多。人是矛盾的，一开始坚定的东西，也有可能在某个point上被无情地击垮进而重获新生。每个人的坚定都不一样，甚至还可以是相反的。对于Tom和Summer来说，他们之间经历了500天，但他们原先的坚定却仿佛变动了一个世纪。&lt;br&gt;很多时候相信&lt;code&gt;the one&lt;/code&gt;的存在是耽误你找到真正的那个人的障碍。命中注定or随遇而安其实都需要拿得起更要放得下。毕竟，Summer is gone but Autumn will come.推荐给各位。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-08-05 WEEK125 完美陌生人&lt;/p&gt;
&lt;p&gt;完美陌生人———————————————————————————————————Perfetti sconosciuti&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week125.jpg&quot; alt=&quot;完美陌生人&quot; title=&quot;完美陌生人&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：保罗·格诺维瑟&lt;/li&gt;
&lt;li&gt;主演：吉塞培·巴蒂斯通/安娜·福列塔/马可·贾利尼/艾多尔多·里奥/瓦里诺·马斯坦德雷阿/阿尔芭·洛尔瓦彻/卡西娅·史穆特妮亚克&lt;/li&gt;
&lt;li&gt;片长：97分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from41,824users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from3,116users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。叫《完美陌生人》的电影有好多部，不过只有今年意大利的这一部是值得我推荐给各位的。“即将走入婚姻的人不要看，情侣不要看。”这是我在看这部电影之前看过的关于此电影的评价。但是我还是单身呀（笑）。不过这部电影在某种意义上可能真的算是一部爱情恐怖片，让很多人看完之后不寒而栗。有个词语，叫做”最熟悉的陌生人“。实际上我觉得跟本片的名字还是挺搭的。陪在你身边这么多年，你最熟悉的人，也有可能因为一些隐瞒而让你们成为陌生人。&lt;br&gt;虽然是小成本电影，甚至主要场景仅局限在一间屋子里，不过电影的对话、情节却完全没有省略。你会跟着影片中的人想知道真相——但是却又害怕知道真相。很多时候我们早已知道真相，但是无非是想得到一个肯定的答复——但是这样做却又徒增痛苦。&lt;br&gt;影片中的每段小情节都精致而讨喜。生活化的对话没有任何拘束。一部充满着“暗能量”的电影却又不缺乏正能量的光辉。“你如果深爱一人，会为他挡下全世界的子弹。”“无论何时回想起来，这件事都会让你嘴角带笑的话，你就去做吧。”&lt;br&gt;用心的导演编剧甚至将情节安排了月全食的晚上，让结尾也有能够让你拍案叫绝的资本。同时，演员的演技也都十分棒。推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-07-29 WEEK124 素媛&lt;/p&gt;
&lt;p&gt;素媛———————————————————————————————————소원&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week124.jpg&quot; alt=&quot;素媛&quot; title=&quot;素媛&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：李濬益&lt;/li&gt;
&lt;li&gt;主演：薛景求/严志媛/李来/金海淑/金相浩/罗美兰/杨真诚..&lt;/li&gt;
&lt;li&gt;片长：123分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/家庭&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.1/10(from122,653users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from873users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本期给大家推荐的是来自韩国非常著名的电影《素媛》。这是一部改编自真实故事，讲述幼童性侵案的电影。&lt;br&gt;沉重的话题在韩国电影里已经屡见不鲜，从《杀人回忆》、《七号房的礼物》、《辩护人》到《熔炉》等，都是一部部靠着沉重的故事，直抵观众内心深处，触动你心弦，震撼你泪腺的电影。《素媛》也是一样。小女孩的遭遇几乎无时不刻地让你交出泪水，宣泄愤怒。&lt;br&gt;如果说仅仅因为真实故事改编就能获得观众认可和高分，那么是不负责的。本片导演把握的火候十分到位，一开始很少的场景、镜头就将整个故事的主要人物、性格、背景交代清楚，而把大部分关键的时间留给案件本身。起始、抢救、抓捕、恢复等情节，既没有拖泥带水又内容饱满。整个时间线的跨越有好几个月之久，虽然只在两个小时内堆砌，却完全没有快进的感觉。&lt;br&gt;小女孩的天真、善良与犯人丑陋的嘴脸形成了本片最鲜明的对比。父母的心碎与付出，朋友的支持与帮助，法庭宣判的荒谬与可笑等等都能给你留下深刻的印象。这一部讲述社会讲述人性的电影，虽然是一部悲剧，但是导演却不忘着给影片加入乐观、阳光等正能量，这些元素很好地够缓解整部电影带来的悲伤的基调。&lt;br&gt;同样，电影的海报也是一样，让你看完能感受到满满的阳光。&lt;br&gt;这是一部改变了韩国的电影，直接改变了韩国相关的法律条例。这是一部让你看完能够反思社会，思考人性的电影。虽然是韩国的电影，却能够让你同样反思我们自己。推荐观看。&lt;br&gt;PS：在找本片的背景故事的时候，有句话让我久久不能忘。&lt;br&gt;“他们有改变国家的电影，而我们有改变电影的国家。”&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-07-23 WEEK123 心迷宫&lt;/p&gt;
&lt;p&gt;心迷宫———————————————————————————————————Deep in the Heart&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week123.jpg&quot; alt=&quot;心迷宫&quot; title=&quot;心迷宫&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：忻钰坤&lt;/li&gt;
&lt;li&gt;主演：霍卫民/王笑天/罗芸/杨瑜珍/孙黎/..&lt;/li&gt;
&lt;li&gt;片长：110分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/悬疑&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from100,250users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.9/10(from551users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。往常推荐的电影都是我当周看的。然而这部电影是我在去年这部电影上映的时候看的。推荐它的原因是正好上周推荐了一部国产的好电影《杀生》，而这周我还想再推一部国产好电影，想来想去就决定是它了。它是我心中这几年国产的悬疑电影TOP1。&lt;/p&gt;
&lt;p&gt;一开场就给你带来浓浓的中国乡土气息。几个互不关联的人物的出场让看这个电影的观众一开始就陷入悬疑的漩涡中。然而编剧与剪辑的力度得当，让故事在横向平行发展的同时进行纵向发展，就像剥洋葱一样一层一层环形地把故事给讲圆了。每个故事互相补充互相埋伏笔直到最后来个大集结——实在过瘾！&lt;/p&gt;
&lt;p&gt;演员的表演也是一大亮点，没有任何的大明星，但是他们与村子却是做到了融为一体，毫无做作，又真实动人。&lt;/p&gt;
&lt;p&gt;没有明星，只有群演；没有特效，只有朴实；没有浮夸，只有故事；没有大制作，只有良心的170万。这样的良心国产悬疑电影，强烈推荐。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-07-17 WEEK122 杀生&lt;/p&gt;
&lt;p&gt;杀生————————————————————————————————————Design Of Death&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week122.jpg&quot; alt=&quot;杀生&quot; title=&quot;杀生&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：管虎&lt;/li&gt;
&lt;li&gt;主演：黄渤/苏有朋/余男/任达华/马精武/梁静/王迅/..&lt;/li&gt;
&lt;li&gt;片长：109分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/悬疑&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.6/10(from82,432users)&lt;/li&gt;
&lt;li&gt;IMDB评分：6.4/10(from303users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。好久没有推荐中国本土的好电影了。本周推荐的电影就是来自管虎导演，黄渤主演的《杀生》。其实一开始看到这个片名的时候，总觉得是一部讲述“屠杀”相关的电影。然而等我看完了之后我才发现我错了。这是一部有内涵有思想的电影。这也是为什么我将它推荐给各位的原因——我认为有思想的电影，能够引发观众思考而回味的电影，都能够称得上好电影。&lt;/p&gt;
&lt;p&gt;通常来说，电影中有了矛盾才能有吸引人的点。而本片的矛盾便是自由与封建。在这部电影里你可以看到的是一个“暴徒”和一群想要除掉这个“暴徒”的村名——而大家却又不能直接进行杀生，只能间接杀生——这就引发出了很多值得思考和回味的地方。对于封建传统的迂腐思想的批判，对于“大逆不道”的行径的惩治，对于罪孽的自我救赎等等。&lt;/p&gt;
&lt;p&gt;本片隐喻极多，很多场景、物品、人物都各自带着象征意义。正如电影海报宣传所言，心由境生。很多东西的体会需要将自己放入其中。而黄渤本片的表演，也是亮点极多，真实的演技实力派。很有力量，很有深度，推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-07-02 WEEK121 间谍之桥&lt;/p&gt;
&lt;p&gt;间谍之桥————————————————————————————————————Bridge of Spies&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week121.jpg&quot; alt=&quot;间谍之桥&quot; title=&quot;间谍之桥&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：史蒂文·斯皮尔伯格&lt;/li&gt;
&lt;li&gt;主演：汤姆·汉克斯/马克·里朗斯/斯科特· 谢泼德/..&lt;/li&gt;
&lt;li&gt;片长：141分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/传记/历史&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from40,775users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from170,764users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位，好久不见。本周给大家推荐的电影是来自导演斯皮尔伯格的一部美国主旋律电影《间谍之桥》。老实说我对汤姆·汉克斯演的电影都有一种好感，大概是从《拯救大兵瑞恩》开始的。本片改编自真实故事（我发现我最近看的电影都跟真实故事改编有关。。），讲述了冷战时期一个美苏双方间谍交换的故事。伟大之处在于促成这个交换的并不是美国政府官方出面（当然也不可能），而是一个律师。&lt;/p&gt;
&lt;p&gt;他因为作为间谍的辩护律师而众矢之，但是尽心尽责，讲求人权。有情怀，有思想，有人道主义精神——有血有肉。一己之力完成美苏双方交易，简直就是开挂。&lt;/p&gt;
&lt;p&gt;如果说看完这部电影就能抹杀美国在国际上的那些丑闻那是不可能的。但是从本片中，却能看到美国社会法治冷酷而人权至上思想确实深入人心的现象。片中美化美方而略微丑化苏方的行为实在有点尴尬，虽然在当时的环境下确实可能是这样——不过不影响这部片被称为一碗美国鸡汤。&lt;/p&gt;
&lt;p&gt;但是抛去国家的因素，本片里我最喜欢的，却是苏方间谍对于事物的看法。“你不感到担心么？”——“这样会有用么？”不管是在被捕、可能被执行死刑、即将回到祖国等各大重要关头，他始终是保持着非常人的镇定。这真是看完感到由衷的敬佩。当然，美国律师的壮举，也是值得赞扬的。故事还不错，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-06-26 WEEK120 死亡医生&lt;/p&gt;
&lt;p&gt;死亡医生————————————————————————————————————You Don’t Know Jack&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week120.jpg&quot; alt=&quot;死亡医生&quot; title=&quot;死亡医生&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：巴瑞·莱文森&lt;/li&gt;
&lt;li&gt;主演：阿尔·帕西诺/苏珊·萨兰登/约翰·古德曼/..&lt;/li&gt;
&lt;li&gt;片长：134分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/传记&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from15,595users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.7/10(from21,798users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的电影是一部相对冷门的好片。来自美国的《死亡医生》。很有意思，其实我觉得英文片名起的更好——《You Don’t Know Jack》。本片改变自真实人物的真实事件。  &lt;/p&gt;
&lt;p&gt;一个提倡可以给想结束自己生命的病人实施安乐死的医生，遭到了来自社会、世俗伦理的强烈抨击。他因为“剥夺”了病人生的权利而被冠名“死亡医生”。好了不能再剧透更多了，实际上本片作为一部mini的传记电影，主演阿尔·帕西诺真是把那股“蛮劲”表演地淋漓尽致。&lt;/p&gt;
&lt;p&gt;这是一部关于生死思考的电影——它是严肃的，带着强烈的主观色彩却又一遍遍地敲打着你的内心。我们可能从未想过”死“，因为我们都想好好的活着。但是杰克作为一个医生，他本应该救死扶伤，将病人拯救于水火之中，为何却提倡在某些特殊情况下给病人实施安乐死呢？并且他坚持着自己的观点，坚信着自己的信念，从未退缩。他觉得人是有权利决定自己的死亡的，而且与其在世上与痛苦的病魔抗争而苟延残喘，为何不体面地选择离开那痛苦的泥沼得到最终的解脱呢？没有华丽的包装，没有过分的煽情，一句“你怎么敢，你怎么敢，拿安乐死跟种族屠杀相提并论！”足矣将整部电影的能量迸发出来。&lt;/p&gt;
&lt;p&gt;阿尔帕西诺真心是老戏骨，而本片之外，我们是否也应该思考地更多呢？“我们还在努力争取有尊严的活着，他们已经在争取如何有尊严的死去了。”&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-06-18 WEEK119 触不可及&lt;/p&gt;
&lt;p&gt;触不可及————————————————————————————————————Intouchables&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week119.jpg&quot; alt=&quot;触不可及&quot; title=&quot;触不可及&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：奥利维·那卡什艾力克·托兰达&lt;/li&gt;
&lt;li&gt;主演：弗朗索瓦·克鲁塞/奥玛·赛/安乐妮/奥黛丽·弗洛特/托马斯·索利维斯/..&lt;/li&gt;
&lt;li&gt;片长：112分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.1/10(from297,707users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.6/10(from493,534users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部来自法国的电影——《触不可及》。这部电影的名字很早就已经听说过。不过在最近是因为一个视频让我觉得实在是太赞了然后将其排进了本周的好电影推荐。这个视频是两个陌生小伙在巴黎火车站默契联弹钢琴曲《Una Mttina》——这首曲子就出自《触不可及》。&lt;br&gt;扯远了点。不过这部电影和上面提到的小视频竟在某些方面有着类似的地方。电影的名字叫做《触不可及》，我觉得取得特别好。两个完全不属于“一个世界”的人，居然能够彼此成为知心知己，实在是令人感慨。这里的“触”，我觉得就是在某些原则、底线方面的“触”——纯净的友谊之间没有利益关系。这也是二者相处甚好的关键——按照主角之一菲利普的说法，““我不需要他的同情心，德里克把电话递给我，因为他时常忘了我不能动。我只要他身体强壮，有手有脚，正常思考，不必在乎他的过去。”二者相处的时候是超乎雇主员工、超乎身份背景的存在。&lt;br&gt;虽然德里克始终毛手毛脚，但是在很多细节的地方，你却能看出这个人是真的有着责任感的人。他对于菲利普的感情也是由衷地发自内心。&lt;br&gt;直到最后海边餐厅的尘埃落定，我真的觉得那个迈着混混步伐远去的德里克，背影是多么的高大。&lt;br&gt;本片取材于真实故事，平凡而又感人。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-06-09 WEEK118 万物理论&lt;/p&gt;
&lt;p&gt;万物理论————————————————————————————————————The Theory of Everything&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week118.jpg&quot; alt=&quot;万物理论&quot; title=&quot;万物理论&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：詹姆斯·马什&lt;/li&gt;
&lt;li&gt;主演：埃迪·雷德梅恩/费莉西蒂·琼斯/艾米丽·沃森/大卫·休里斯/..&lt;/li&gt;
&lt;li&gt;片长：123分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/爱情/传记&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from85,707users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.7/10(from257,674users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部讲述霍金的传记电影。或者说，披着传记外衣的爱情电影。被誉为“现代爱因斯坦”的霍金，他的人生经历恐怕大多数人只知道如下两个主要信息点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;他21岁换上了肌肉萎缩性侧索硬化症，从此便开始了他传奇的人生&lt;/li&gt;
&lt;li&gt;他是20世纪自爱因斯坦以来最伟大的物理学家之一，他的著作《时间简史》畅销全球&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实际上，正如那句俗语所说：“一个男人的成功离不开一个女人的支持”。霍金能有今天的成就，很大程度上要归功于他的第一任妻子——简·怀尔德。我甚至认为，本片的主角更像是简而非霍金。哪怕在知道霍金患病，“只有两年的生命”的情况下，她还是义无反顾地嫁给了霍金，照顾、服侍他生活的方方面面，还要照顾孩子，操劳家务。导演在这块方面着重留了很多的镜头，只为表现出那种人间真爱。说实在的，你真的会被简的做法所感动。  &lt;/p&gt;
&lt;p&gt;我最感动的一个镜头是，一次简在开车带家人回家的路上，对霍金说了”We’re not a normal family!”，她是真的累了需要帮手。而霍金没有正面回复简，回头跟他儿子说”Robert, your mother is very angry with me.”这个镜头真的是印象深刻。一方面为简辛勤劳累而同情，另一方面又为霍金自己无力改变身体状况而感到心酸。  &lt;/p&gt;
&lt;p&gt;本片的时间跨度上，大致是能够涵盖霍金的大部分关键经历了。虽然在一些情节的处理上过于快速——但是毕竟要叙述的东西实在是太多，很多东西不得已只能一笔带过。向这个科学巨匠致敬，同时也向这个科学巨匠背后付出自己最宝贵光阴的简·怀尔德致敬。推荐观看~&lt;/p&gt;
&lt;p&gt;PS：另外本片和另外一部讲述博弈论创始人小约翰•福布斯-纳什的传记电影《美丽心灵》有着异曲同工之处，建议两部电影可以一起看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-06-04 WEEK117 入殓师&lt;/p&gt;
&lt;p&gt;入殓师————————————————————————————————————おくりびと&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week117.jpg&quot; alt=&quot;入殓师&quot; title=&quot;入殓师&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：泷田洋二郎&lt;/li&gt;
&lt;li&gt;主演：本木雅弘/广末凉子/山崎努/吉行和子/笹野高史/余贵美子&lt;/li&gt;
&lt;li&gt;片长：130 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.8/10(from275,329users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from38,175users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部极富感染力的电影《入殓师》。从字面上来看你也应该能够看出本片讲述的人物的职业是跟“死亡”有关的。&lt;br&gt;我最喜欢的地方有三：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;配乐：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;久石让的配乐让这部电影增色了不少。大提琴的引入，独特的音色贯穿衔接的部分，优雅而意味深长。闭上眼睛听真的非常非常的舒服。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;矛盾：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一方面为了生计不得不工作，一方面工作的内容却是不让众人所能够理解——甚至为人所不齿，妻子所嫌弃。小林的抉择真的是让人觉得内心强大到可怕。一方面对父亲的远走怀着怨恨，一方面却又被父亲的“留信”而感动最终两代人终于化解矛盾。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;内心：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;人物的内心的变化，导演通过细节刻画的特别好。从恐惧到接纳，从拒绝到认可，从恼怒到谅解——这一切的变化，导演都有意识地安排了镜头，毫不做作，感染力十足。&lt;/p&gt;
&lt;p&gt;其实本片在对于 对待生死 的这件事上有着不少深刻的见解。对于死者的尊重，对于死亡的理解，我觉得都已经是超出了我们所能够做到的——我一直觉得中华文化，到今天中国人自己坚守的东西真的不多了。相反，在日本人身上，你真的能够看到当年我们所推崇、所弘扬的文化，被他们吸纳了。这也是真的值得我们反思的地方。好电影，值得观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-05-27 WEEK116 鬼乡&lt;/p&gt;
&lt;p&gt;鬼乡————————————————————————————————————귀향&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week116.jpg&quot; alt=&quot;鬼乡&quot; title=&quot;鬼乡&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：赵正莱&lt;/li&gt;
&lt;li&gt;主演：姜汉娜/崔莉/郑仁基/白秀莲/吴智慧/朴根秀/孙淑子/郑武兴/..&lt;/li&gt;
&lt;li&gt;片长：127分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.4/10(from13,138users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.3/10(from61users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是今年2月份在韩国上映引起强烈反响的电影《鬼乡》。其实一开始看到这部电影的名字的时候，我还以为这是一部恐怖片、鬼片之类的电影。直到朋友强烈给我推荐后，我才恍然大悟。&lt;br&gt;本片取材自真实的故事，以二战时期日本在朝鲜强行掠走20万女性充当“慰安妇”作为背景。我们可能更多地关注于纳粹集中营中惨绝人寰的行径，然而却容易“忽视”另外一段同样让人愤慨的历史。&lt;br&gt;导演有意识地安排了两条线，让历史与轮回归乡交织在一起。开头天真美好的画面，与之后黑暗、惨不忍睹的情景成了最鲜明的对比。影片有大量篇幅用于描述当时的人间地狱，让你跟着女孩们的遭遇一起悲恸，一起绝望。&lt;br&gt;虽然从电影艺术的角度上来说，本片的某些部分略显拖沓，甚至于一开始你并不能很好地接受这双线的剧情。但是相信我，只要你坚持过片头那些所谓的“无聊”的情节后，你会真正从内心中感受到导演想借此发出的呼喊。&lt;br&gt;那段历史，看似遥远。但是对逝者的敬畏，对生者的尊敬，不能忘怀。推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-05-21 WEEK115 曾经 &lt;/p&gt;
&lt;p&gt;曾经————————————————————————————————————Once&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week115.jpg&quot; alt=&quot;曾经&quot; title=&quot;曾经&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：约翰·卡尼&lt;/li&gt;
&lt;li&gt;主演：格伦·汉塞德/玛可塔·伊尔格洛娃/Alaistair Foley/George Hendrick/Hugh Walsh/&lt;/li&gt;
&lt;li&gt;片长：85 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/爱情/音乐/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.4/10(from172,120users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.9/10(from89,092users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部非常清新、感人的音乐电影。准确来说我是偶然间听到了电影中的一首歌《If you want me》，被打动了之后记住了唱出这首歌的电影。&lt;br&gt;很有意思，片中的男女主角都没有名字——是音乐让他们相遇，相知，相熟，但是却没有让他们交换“名片”。全片的亮点在于音乐与情节的无缝衔接，几乎85分钟里，几乎有一半以上的时间你都能听到本片相当棒的原创音乐。有人说这是让我去听音乐还是去看电影呢？我想说，这部电影要用心去感受。听和看不过是两种感官上的享受，但是用心去感受的，才能让你记忆犹新。&lt;br&gt;而本片的结尾也并没有我曾所想的那般结局——这也是导演别有用心的地方吧，现实生活中总是带着美好的遗憾。&lt;br&gt;很喜欢豆瓣评论的一句话，“曾经，一次，渺小的我们，在浩大的星球相遇。不牵手不拥抱不亲吻，我们唱歌。”&lt;br&gt;缘由心生，随遇而安。祝大家521快乐。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-05-14 WEEK114 真相 &lt;/p&gt;
&lt;p&gt;真相————————————————————————————————————Truth&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week114.jpg&quot; alt=&quot;真相&quot; title=&quot;真相&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：詹姆斯·范德比尔特&lt;/li&gt;
&lt;li&gt;主演：凯特·布兰切特/罗伯特·雷德福/伊丽莎白·莫斯/托弗·戈瑞斯/丹尼斯·奎德/布鲁斯·格林伍德/..&lt;/li&gt;
&lt;li&gt;片长：125分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/传记&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.5/10(from2,328users)&lt;/li&gt;
&lt;li&gt;IMDB评分：6.8/10(from8,007users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部关于追求真相的电影。我在3月5号推荐过一部类似题材的《聚焦》并且那部电影获得了相当高的评价。然而聚焦获得了聚焦，真相没有获得真相。虽然是类似题材的电影，但是这两部电影看完真是给人完全不同的感受。&lt;br&gt;根据真实故事改编的电影，往往能够给人会心一击。这是因为你在潜意识里会告诉自己这个是真的发生过的，曾经发生过的事情（哪怕是在拍电影），会让你在内心里更愿意去接受它是历史的回放而不是艺术的升华。《真相》跟《聚焦》里相似的东西就是记者们都在寻求真相——不同的是《真相》里的人调查的事情却是触动了当时美国总统布什的利益。并且他们也不会想到自己作为调查者却最终会成为被调查者。我很喜欢豆瓣评论里的一句话：“他们原本是在揭露丑闻，结果他们自己变成了丑闻”。多么地令人感到遗憾。但是本片难能可贵的，并不是完全站在弱势的一方，而是站在了一个更高的高度——导演并非是在完全控诉，而是在力图还原当时的真相——记者们对于证据的采集与确认确实有不妥之处，这也是一个让后来人得以口舌的地方。  不过，回到最初的地方，为了追求真相而承担责任的，真的非常需要影片里一直回荡的那个词——Courage。推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-05-07 WEEK113 海街日记&lt;/p&gt;
&lt;p&gt;海街日记————————————————————————————————————海街diary&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week113.jpg&quot; alt=&quot;海街日记&quot; title=&quot;海街日记&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：是枝裕和&lt;/li&gt;
&lt;li&gt;主演：绫濑遥/长泽雅美/夏帆/广濑铃/..&lt;/li&gt;
&lt;li&gt;片长：128分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/家庭&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from61,574users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.6/10(from2,699users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部非常生活化的电影。一部关于女性、母性、家庭、亲情、友情的电影。&lt;br&gt;这不是一部你看了1分钟之后就想关掉播放器的慢热型电影——它几乎是从一开始就进入了节奏，并且一直延续到结束的电影。我们总说看都市泡沫肥皂剧没意思，这部电影虽然也是描写生活的“琐事”，但是却让人一点都不觉得反感，相反，你会被她们之间的对话、生活所吸引，一切都是那么自然，自然地让你感觉到真实而不是在拍电影。&lt;br&gt;这部电影在很多细节处理上面做得特别好。例如说4姐妹的性格，没有专门的刻画，你在她们的日常对话、生活中就能感受到明显的区别。而且总在一些小事情上能够让人感受到导演对于此的用心。阳光下的樱花道，55年的老梅树，20年的味道的记忆等等都是让人印象深刻的东西。海边的海风，海浪，电影恰到好处的配乐，都能够让你沉浸在那种纯净的环境中。&lt;br&gt;影片的结尾在你毫无防备中就突然到来，说实在的真是有点可惜——多想再看看她们的生活——毕竟是幅多么美好的画卷，是多么令人向往的生活。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-04-30 WEEK112&lt;br&gt;地雷区————————————————————————————————————Under sandet&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week112.jpg&quot; alt=&quot;地雷区&quot; title=&quot;地雷区&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：马丁·赞里维特&lt;/li&gt;
&lt;li&gt;主演：罗兰·默勒/米克尔·福尔斯加德/路易斯·霍夫曼/乔尔·巴斯曼/..&lt;/li&gt;
&lt;li&gt;片长：100分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/历史/战争&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.4/10(from4,670users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.8/10(from1,780users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是最近的一部评分很不错的与二战有关的电影。通常情况下的反战片会讲述战争进行时的惨绝人寰，以此来刺激观众的内心。而这部电影则是取材很独特——取材于二战刚结束的时候，丹麦动用德国战俘用人肉排雷的方式，累计2000多名德国战俘徒手排除了丹麦国内将近150万枚的战争遗留地雷。&lt;br&gt;光是这个背景，就让人毛骨悚然。这部电影在这个背景的基础上，除了挖掘地雷本身让人触动之外，还暗含着对待仇敌——哪怕是对放下了武器的战俘，对一群年纪不过十来岁的年轻人的不同人的态度。这种情绪很能够影响观众。在本片里，德国士兵再也不是凶神恶煞的魔鬼，而是一群想着早日回家的孩子。而由于德国对丹麦的侵略带来的不可挽回的损失，丹麦军官的不同的表现彰显了不同的价值取向。我们无法去苛责当时的他们，但是却内心隐隐作痛。这不是对侵略者的同情，而是对一群涉世未深的孩子的怜惜。&lt;br&gt;影片中的每次地雷声响起，都能让你内心为之一颤，甚至暗暗落泪。导演把握全片的节奏很好，人性的转变、孩子们的心理变化处理地那么的自然而让人伤感。&lt;br&gt;本部由德国和丹麦合拍的电影，真真实实的反映那段不怎么为人知的历史。希望看过它的你，能够守住和平的苗而不动摇。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-04-23 WEEK111&lt;br&gt;彗星来的那一夜————————————————————————————————————Coherence&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week111.jpg&quot; alt=&quot;彗星来的那一夜&quot; title=&quot;彗星来的那一夜&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：詹姆斯·沃德·布柯特&lt;/li&gt;
&lt;li&gt;主演：艾米丽·芭尔多尼/莫瑞·史特林/尼古拉斯·布兰登/伊丽莎白·格瑞斯/..&lt;/li&gt;
&lt;li&gt;片长：89分钟&lt;/li&gt;
&lt;li&gt;影  片类型：科幻/悬疑/惊悚&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.3/10(from108,891users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.1/10(from49,313users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部13年评价颇高的科幻电影——《彗星来的那一夜》。实际上这个是个意译。因为英文原名Coherence是相干性的意思。不过按照中文意译的也确实翻译的挺好。作为一部披着“软科幻”实则是硬科幻内核的科幻电影，它基于的物理学原理就是量子力学的相干性。如果你知道薛定谔的猫，那么猫在盒子里被设定的只有活着活着死去两种状态，这是为了方便理解。那如果以猫所在盒子的方位（东南西北）作为标准的话那么就有4种状态，而以这4种状态×活着或者死去的两种状态将会有8种状态……如果再加入变量将会继续变得更多。是的，这部电影就是在思考这种状态同时存在的时候会发生什么，你的人生将会发生什么。&lt;br&gt;这部电影的前10分钟是可以让你看到睡着或者直接换一部电影看的那种“无聊”。然而天黑了之后，整部电影的燃点就燃起来了，并且一发不可收拾。平行宇宙的世界观能够刷新你对当前世界的理解，而那种“真正发生”的感觉却又是让你震惊而又恐惧的。彗星带来的相干性，间接地改变了人性、甚至改变了人心。这是本部电影精华的部分，不仅仅只是对相干性做一些诠释，而是在此基础上进行额外的升华。本片能够带来极多极深的思考，喜欢头脑风暴的朋友不妨看看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-04-16 WEEK110&lt;br&gt;穿条纹睡衣的男孩————————————————————————————————————The Boy in the Striped Pajamas&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week110.jpg&quot; alt=&quot;穿条纹睡衣的男孩&quot; title=&quot;穿条纹睡衣的男孩&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：马克·赫尔曼&lt;/li&gt;
&lt;li&gt;主演：阿萨·巴特菲尔德/维拉·法米加/大卫·休里斯/杰克·塞隆/鲁伯特·弗兰德/..&lt;/li&gt;
&lt;li&gt;片长：94 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/战争&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.8/10(from99,832users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.8/10(from127,497users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的电影，是来自英国美国合拍的电影《穿条纹睡衣的男孩》。也许你和我都一样被这个标题以及制作精良而好看的海报给吸引住了，可能以为这是一部阳光的电影。实则不然。这部电影是一部实实在在的反战片——不过与其他的反战片不太一样的地方在于，本片切入的方向，来自于孩子——两个孩子，同在一个国家而身处不同的命运。  &lt;/p&gt;
&lt;p&gt;众所周知，德国纳粹在二战的时候犯下了骇人听闻的恶行，将成千上万的犹太人抓起来关进了集中营，在他们身上做活体实验，甚至是成批的屠杀。不直接切入集中营的生活是多么多么的残酷，而是从孩子的视角去看待集中营这个东西——在他的眼里他甚至认为这是个农场，他们都是在做游戏。  &lt;/p&gt;
&lt;p&gt;回到标题，条纹睡衣实际上就是集中营里的囚服。而影片里出现的人物，或多或少你都能感受到当时那个环境下犹太人的处境有多么困难，而某些德国士兵又是多么地毫无人性。这些支线的细节，更加凸显了主线两个小朋友的友情的难能可贵。“假期如果你喜欢，可以到柏林来看我，等我们大家都和好的时候。”孩子们的想法总是多么天真而美好。甚至到最后他们被带到毒气室的时候还认为只是为了避雨，还以为脱掉衣服只是为了洗个澡。  &lt;/p&gt;
&lt;p&gt;正是这种反差，让你能够感受到那种愤怒、那种无力。电影到最后并不是以“美好”的结局结束——实际上这么沉重的题材也不可能有“美好”的结局。不过却真的并没有给你留下希望。穿条纹睡衣的男孩，一个犹太男孩，一个德国男孩。感慨万千，推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-04-09 WEEK109&lt;br&gt;金福南杀人事件始末————————————————————————————————————김복남 살인사건의 전말&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week109.jpg&quot; alt=&quot;金福南杀人事件始末&quot; title=&quot;金福南杀人事件始末&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：张哲洙&lt;/li&gt;
&lt;li&gt;主演：徐英姬/池成媛/朴政学/白秀莲/黄民浩/..&lt;/li&gt;
&lt;li&gt;片长：116分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/惊悚/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.2/10(from45,058users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.3/10(from8,592users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家带来的电影是来自韩国的《金福南杀人事件始末》。说些题外话，我自从第一次看完《熔炉》后，便对韩国的电影有了完全新的认识——韩国好电影（注意是好电影）的深度确实令人敬佩。而这些电影有一大部分是基于现实发生的故事改编成电影的。这样的电影虽然说素材方面没有什么太多的问题，但是要拍得好也确实不容易。但是令人惊讶的是，《辩护人》、《熔炉》、《追击者》等这些基于真实故事的电影都让人肃然起敬——正因为力度把握地好，才让人看完能够受到震撼。  &lt;/p&gt;
&lt;p&gt;今天推荐的电影也是一样，基于真实的故事，看完后真是让人百感交集。这是一个悲剧，但是却发人深省。这是一个讲述一个人从逆来顺受到最后真正爆发的故事。这是一个讲述一个人的内心真正被感化被影响的故事。这是一个讲述世间种种黑暗，却让你依然能够看到一丝阳光的故事。我们的身边其实也有太多的“金福南”，但是太多的人却埋没在了黑暗中，逆来顺受至终。  &lt;/p&gt;
&lt;p&gt;很喜欢豆瓣上关于这部电影的一个词。Powerful。这真的是一部很Powerful的电影。甚至能够让你重新审视关于“好人”与“坏人”的界定。你也许会看着金福南的爆发而觉得痛快却忘了她是个杀人犯。其实没有什么人是“该死”的，但是任何人都有反抗的权利。希望这部电影能够给你带来不一样的震撼。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-04-02 WEEK108&lt;br&gt;血钻————————————————————————————————————Blood Diamond&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week108.jpg&quot; alt=&quot;血钻&quot; title=&quot;血钻&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：爱德华·兹威克&lt;/li&gt;
&lt;li&gt;主演：莱昂纳多·迪卡普里奥/詹妮弗·康纳利/杰曼·翰苏/..&lt;/li&gt;
&lt;li&gt;片长：143 分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/惊悚/冒险&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.5/10(from100,784users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.0/10(from390,425users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家推荐的是一部令人感到很心酸的电影。反映史实的电影，总是能够打动你的内心。看这部电影之前我稍微了解了一下相关背景知识——因为当初看《卢旺达饭店》的时候并没有做好功课导致看完还有好多东西并未真正了解。（PS:这部电影真的跟《卢旺达饭店》一样，如果你不去了解，你就永远不会知道那段触目惊心的历史。）  &lt;/p&gt;
&lt;p&gt;首先简单说一下血钻，血钻也称冲突钻石，是来自冲突地区产出的钻石，本片特指由塞拉利昂这个国家产出的钻石。因为这个地区的钻石的产出来自于血腥的叛军压迫，并且以低廉的价格换取军火以便支持叛军内战。于是国际上后来通过了条例，共同不购买、不流通冲突钻石。从另外的一个角度上，最终让塞拉利昂的内战平息。  &lt;/p&gt;
&lt;p&gt;跟《卢旺达饭店》稍微不同的地方在于，本片基于那段历史又虚构了一些人一些事，让整个故事不再是简单的叙述历史而是多线发展。明线、暗线，伏笔，甚至是所谓的结尾升华。  &lt;/p&gt;
&lt;p&gt;而里面的一些反映史实的地方，却干净利落。童子军，肆意杀戮，逼迫壮年采钻石矿，非法交易，等等。这些触目惊心的部分，不仅带来的是视觉上的冲击还是内心上的冲击——油然而生的一种恐惧，会自发的对当时的人们产生怜悯之心。  &lt;/p&gt;
&lt;p&gt;人物塑造上，小李子作为一个走私犯从一开始的向钱看齐到最后是向前看齐。而女记者的经历也从侧面反映出还是有很多有良知的人在与这个不公的世界作斗争，他们也在为了那些素昧平生的人的生存而做着自己力所能及之事——甚至因此献出生命。  &lt;/p&gt;
&lt;p&gt;虽然你不能为着过去发生过的事再做点什么，但是至少去了解那段历史，去感受当时的人们的痛苦，去反思自己当下能做什么，这才是重点啊。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-03-25 WEEK107&lt;br&gt;荒野猎人————————————————————————————————————The Revenant&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week107.jpg&quot; alt=&quot;荒野猎人&quot; title=&quot;荒野猎人&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：亚利桑德罗·冈萨雷斯·伊纳里多&lt;/li&gt;
&lt;li&gt;主演：莱昂纳多·迪卡普里奥/汤姆·哈迪/..&lt;/li&gt;
&lt;li&gt;片长：156分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/惊悚/冒险&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.9/10(from101,618users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.2/10(from299,967users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。本周给大家带来的是前段时间刚获得奥斯卡小金人的小李子——莱昂纳多主演的《荒野猎人》。如果你真的不觉得小李子的演技折服你的话，那么我就只能觉得很遗憾了。内在主要提两点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;求生&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;求生是贯穿整场电影的线索。沿着这条线我们跟着主人公一起经历他所经历。俗话说，天将降大任于斯人也，必先苦其心志，劳其筋骨，饿其体肤，空乏其身，行拂乱其所为。这些在一个强烈求生欲的人眼中，都是小事。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;复仇&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;之所以有强烈的求生欲，一方面是人的求生本性，一方面是身负复仇的决心。&lt;/p&gt;
&lt;p&gt;剧情方面，强调了白人和当地部落居民的冲突却并没有完全将白人塑造成正义的一方，而是很好的进行了矛盾的处理。另外，长镜头的应用，也极大地考验着演员的演技。小李子在本片中展示出的令人叹服的演技，以及为本片所做出的种种牺牲，着实令人敬佩。很同意豆瓣的一个朋友的说法，与其说看小李子逆天挑战着大自然，不如说看一个有执念有梦想的人他到底能走多远。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-03-20 WEEK106&lt;br&gt;疯狂原始人————————————————————————————————————The Croods&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week106.jpg&quot; alt=&quot;疯狂原始人&quot; title=&quot;疯狂原始人&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：柯克·德·米科克里斯·桑德斯&lt;/li&gt;
&lt;li&gt;主演：尼古拉斯·凯奇/瑞恩·雷诺兹/艾玛·斯通/..&lt;/li&gt;
&lt;li&gt;片长：98分钟&lt;/li&gt;
&lt;li&gt;影  片类型：喜剧/动画/冒险/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.8/10(from306,793users)&lt;/li&gt;
&lt;li&gt;IMDB评分：7.3/10(from144,599users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。实在是抱歉，这两天事情忙，导致一周一部好电影没有按时更新，在此抱歉。&lt;br&gt;继上周推荐了《疯狂动物城》之后，突然想起前几年同样一部以疯狂打头的“零差评”的动画电影《疯狂原始人》。故事营造的史前时代在照顾不同年龄段的观众的同时，还加入了不少奇特的想象。有蜗居山洞的小镜头，也有地动山摇的大场面。有幽暗的峡谷，也有美丽的森林。导演或者说制作人细节把握的很好，人物的画风独特而富有感染力，寥寥几个场面就能将人物的个性展现出来，印象深刻。而这部电影最能打动你的部分在于，它将很多感情具象化，让你能够用不同的角度去感受他们的感觉，有着别样的感触。冲突、矛盾、化解，温馨乃至感动。老少咸宜，不容错过。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-03-13 WEEK105&lt;br&gt;疯狂动物城————————————————————————————————————Zootopia&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/WEEK105.jpg&quot; alt=&quot;疯狂动物城&quot; title=&quot;疯狂动物城&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：拜伦·霍华德瑞奇·摩尔杰拉德·布什&lt;/li&gt;
&lt;li&gt;主演：金妮弗·古德温/杰森·贝特曼/..&lt;/li&gt;
&lt;li&gt;片长：109分钟(中国大陆)&lt;/li&gt;
&lt;li&gt;影  片类型：喜剧/动作/动画/冒险&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.4/10(from158,275users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.4/10(from24,287users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HI,各位。本次给大家推荐的是迪斯尼最近大热的《疯狂动物城》。豆瓣评分逆天9.4，口碑自不用说。推荐点三点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;良心的画面制作&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;绝对良心的画面制作，大场面，小细节，一切都是那么的细致和用心。乡村，沙漠，冰原，丛林，都市等等的场景都是描绘的那么美丽和吸引人。特别的，针对不同国家的播放还专门有些相应的动物元素。比如中国版的里面会出现熊猫播报员。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;深思熟虑的角色选定&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;听闻早先是狐狸是主角，但是这样的话整个故事基调将会变得很沉郁。遂改用双主角线路——阳光向上的兔子和机智幽默的狐狸。这样的选择让整个故事充满阳光和温馨，共同经历的故事也并不乏味枯燥，相反妙趣横生，老少咸宜。角色也是萌得不行，并且真正按照动物的体型大小来制作的角色，让每个角色都有着自己的独特的生活方式。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;优质的笑点&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本片最大的亮点，就在防不胜防的笑点。尤其是树懒，绝对是全场爆笑的公认点。&lt;/p&gt;
&lt;p&gt;总之，本片制作用心，精良。小朋友看得懂，成年人看得懂，老人们也看得懂。不同年龄段能从这部电影里看出不同的含义。强推，可以多刷。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-03-05 WEEK104&lt;br&gt;聚焦——————————————————————————————————————————Spotlight&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week104.jpg&quot; alt=&quot;聚焦&quot; title=&quot;聚焦&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：托马斯·麦卡锡&lt;/li&gt;
&lt;li&gt;主演：马克·鲁弗洛/迈克尔·基顿/瑞秋·麦克亚当斯/列维·施瑞博尔/约翰·斯拉特里/..&lt;/li&gt;
&lt;li&gt;片长：128分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/传记&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.8/10(from46,144users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.2/10(from105,208users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HI，各位。本次给大家推荐的是今年奥斯卡最佳影片——《聚焦》。名字上并无太多惊艳之处，但是绝对是让你看完意犹未尽。  &lt;/p&gt;
&lt;p&gt;本片取材自真实的故事，一个让人无法容忍然而权力机关又让大众忍气吞声的故事，一个最终被揭发终于像星火燎原一般势不可挡的故事。相信看过《熔炉》的人，一定都能够体会那种对于这个社会阴暗面的愤怒。同样，《聚焦》的切入点也是一样，让你深入其境，让你感同身受。  &lt;/p&gt;
&lt;p&gt;影片的节奏感把握地特别好。试想，要在两个小时的时间内，把一件跨度之大，难度之大，复杂程度之大的故事讲述地有条不紊；紧凑感，危机感，层次感十足。这真是对编剧、导演、演员的三重考验。演员的表演真实、卖力，真的可以感受到那种发自内心的在做一件伟大的事。  &lt;/p&gt;
&lt;p&gt;结尾以spotlight收尾，再无多言，真是意犹未尽。看完之后，我发自内心的，对美国的那种言论自由的政策、敢说敢做的精神表示无比羡慕。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-02-28 WEEK103&lt;br&gt;华尔街之狼——————————————————————————————————————————The Wolf of Wall Street&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week103.jpg&quot; alt=&quot;华尔街之狼&quot; title=&quot;华尔街之狼&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演：马丁·斯科塞斯&lt;/li&gt;
&lt;li&gt;主演：莱昂纳多·迪卡普里奥/乔纳·希尔/玛格特·罗比/马修·麦康纳/..&lt;/li&gt;
&lt;li&gt;片长：180分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/喜剧/传记/犯罪&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.6/10(from108,731users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.2/10(from723,421users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HI，各位。首先祝贺一下正好是本片男主的小李子获得奥斯卡影帝。&lt;br&gt;这次给大家带来的是一部颇具喜剧效应的一部人物传记电影——华尔街之狼。一个我们都会比较熟悉的故事模式——空手起家到大红大紫再到帝国崩塌。不过我想说的是，老套的模式下，还能有较高的评价的电影并不算多。这部电影出彩的地方有两点——大胆还原富豪糜烂的生活；主演小李子的演技实在超绝。导演和编剧还原高层社会的富豪生活的时候毫不手软，吸毒、嫖妓纵情声色。大手笔的挥霍，满嘴脏话。目中无人，脾气暴躁。这些东西稍加夸张的手法，干干净净地呈现在观众面前。华尔街的奢靡，大起大落，欺诈，洗钱等等都能让我们大饱眼福。3个小时满满的内容，给你的三观能够带来足够强大的冲击。展示之余，我们也能从中看到不少细节反应着人性，反应着抉择。一部华尔街“黄赌毒”，但是却是很多人曾经梦想的成功之路。电影中出现的两次“卖笔”，也都是画龙点睛之笔。  &lt;/p&gt;
&lt;p&gt;对小李子的演技感兴趣的，一定要看看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-02-21 WEEK102&lt;br&gt;房间——————————————————————————————————————————Room&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week102.jpg&quot; alt=&quot;房间&quot; title=&quot;房间&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演：伦尼·阿伯拉罕森&lt;/li&gt;
&lt;li&gt;主演：布丽·拉尔森/雅各布·特伦布莱/琼·艾伦/肖恩·布里吉格斯/..&lt;/li&gt;
&lt;li&gt;片长：118分钟&lt;/li&gt;
&lt;li&gt;影  片类型：剧情/家庭/&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.7/10(from21,211users)&lt;/li&gt;
&lt;li&gt;IMDB评分：8.3/10(from56,920users)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;HI，各位，元宵佳节快乐~这次给大家推荐的是去年的一部高分电影。一部很着重于儿童视角的电影，由于拍摄的手法以及演员表现的力度实在优秀从而获得了奥斯卡金像奖最佳影片。这是一部关于爱与自由的电影。room在电影里具体的能够认为是那间“囚笼”，而从广义的来说，是整个外界空间。小男孩对于世界的认知在room内就是一切。所有的东西只有在room里接触的对于他来说才是真实的。而一切外界的东西不过是从电视里看到的“虚幻”的东西。纯净的不能再纯净的心灵放在一个对于他来说太自由的世界里的时候反而让他感到恐惧。&lt;br&gt;爱和自由是母爱和人身自由之间，哪个更重要。电影中借用记者向主角问出了这个问题。“可是他有我啊。”在母亲看来杰克是她活下去的唯一支柱和精神动力。但是在强调自由强调人权的美国，却是把自由放得更高位。但是在这种环境下，到底是母爱还是人身自由更重要，我想肯定对于母亲来说会选择前者。也正是因为那份母爱最终让他们迎来了自由的时刻。&lt;br&gt;同时电影也讲了三次拯救。母亲救了儿子——但是儿子却两次拯救了母亲。“我不是一个好母亲。”“但是你是我妈啊。”不管是电影偏于紧凑的前半段还是偏于松散的后半段，无不在反应着人物的内心变化——真实而纯粹。&lt;br&gt;当然电影中也有它相对不自然的部分，比如老尼克为何最后放下了小杰克自己走了，为何乔伊还能活到那天晚上等等。当然这些部分对于这部电影已经是无关紧要的部分了。我们能知道的，是那份对于自由的向往以及纯粹而真实爱，还有童真无邪的眼神与它们所接触的更大的room。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-02-14 WEEK101&lt;br&gt;爱在黎明破晓前———————————————————————————————Before Sunrise&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week101.jpg&quot; alt=&quot;爱在黎明破晓前&quot; title=&quot;爱在黎明破晓前&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 理查德·林克莱特&lt;/li&gt;
&lt;li&gt;主演: 伊桑·霍克 / 朱莉·德尔佩&lt;/li&gt;
&lt;li&gt;片长: 105分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from172,825users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.7/10(from169,265users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、爱情&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。昨天是一年一度的西方情人节，不知各位是如何过的？哈哈。&lt;br&gt;本次给大家推荐的是被称为爱情圭臬三部曲（《爱在黎明破晓前》、《爱在日落黄昏时》、《爱在午夜降临前》）中的第一部。它的第三部我曾经在2015年10月24日第85期的一周一部好电影Ⅱ里推荐过。恰逢情人节，也就顺应节日气氛给大家推荐这部轻松愉快而甜蜜唯美的电影。全片几乎都是在对白中读过。这对编剧导演和演员都是非常强力的考验。&lt;br&gt;一般来说我是非常讨厌剧透的，但是这部电影的剧情又是简单到不能再简单——两个陌生人相遇，相谈、相熟，只一天。旅行的路上，这种事情每天都在发生。但是从没有过把对白贯彻地如此彻底的旅行电影。对白是这部电影的灵魂。从完全陌生的搭讪，到渐渐熟悉的互相提问，再到熟悉的深入、打趣。这些对白全程听下来没有做作，没有生硬。一切都发生地那么流畅，那么自然。我尤其喜欢的一幕，是两个人在一家咖啡店里，互相给对方（的朋友）面对面“打电话”。两个人用第三人称的角度将自己的内心吐露，那一刻真的非常感人。我们跟随着两个主角，也一饱沿途风景与民俗。&lt;br&gt;人和人的关系真的十分的微妙。而影响人与人关系很直接的就是来源于对话。有可能说错一句话，两个人的交流就无法继续，关系戛然而止。所以这三部曲真的可以称得上是对白的经典。导演以爱情为载体，暗暗地成就了人际关系里交流的丰碑。推荐大家观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-02-07 WEEK100&lt;br&gt;十二怒汉———————————————————————————————12 Angry Men&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week100.jpg&quot; alt=&quot;十二怒汉&quot; title=&quot;十二怒汉&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 西德尼·吕美特&lt;/li&gt;
&lt;li&gt;主演: 亨利·方达 / 马丁·鲍尔萨姆 / 约翰·菲尔德 / 李·科布 / E.G.马绍尔 /&lt;/li&gt;
&lt;li&gt;片长: 96分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.9/10(from419,998users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：9.3/10(from129,430users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、悬疑&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这是一周一部好电影的第100周的推荐。算是一个小小的里程碑了吧。这次给大家带来的是一部1957年的美国电影——《十二怒汉》。这部电影我还曾经和《十二猴子》混在一起，后来才区别出来——年份之差。这部电影是1957年的黑白电影。虽然评分很高，但是一直没有让我有兴趣去看——可能是对黑白电影的一种主观上的小排斥。最近因为一部纪录片（我后面会讲到）让我迫不及待地就敲定这周的电影推荐是它了。&lt;br&gt;首先你必须得稍微的了解一下美国的法律政策。对于上法庭的案件，是有陪审团制度的。这个制度在于最终被告有罪与否的决定权在陪审团12个人手中。在双方律师都陈述完案件之后，这12个人在一起讨论案件，并且这12个人的意见必须一致（而不是少数服从多数），从而决定被告是否有罪。&lt;br&gt;这部电影便是讲述这12个陪审员的故事。96分钟，要让人记住12个人并不是一件容易的事。但是导演却非常明智的，并不是让你去记他们的名字、编号等等——记住这个人长什么样，坐哪里，什么性格特征就足够了。12个人的性格迥异，互相不了解对方。而观众也只能通过他们的对话来对这个案件，对这些人有所了解。所以台词和人物的行为就显得非常重要。96分钟有90分钟都在对白，但是却不让你觉得乏味枯燥——为什么，因为有矛盾，有逆转，有冲突。这些都是吸引观众的部分。从11:1到最后0:12，这个大逆转是如何做到的？这些人都是为什么转变观点？关键的几点质疑成了本案的重点。而这些合理质疑却拯救了一条生命。陪审团制度是美国的法制里最闪耀的部分，充分体现了公民权利。本片的对白以及人物塑造绝对是经典之作。所以作为悬疑或者剧情控，它绝对不容错过。&lt;/p&gt;
&lt;p&gt;接下来再说点题外话，最近有一部特别火的记录片——《制造杀人犯》，我是看完它之后毫不犹豫地把《十二怒汉》看完的，那种内心的反差简直是不能用言语表达。《制造杀人犯》给我带来的是美国司法机构的黑暗面，是一种抨击内心的震撼。此片已经掀翻了美国舆论界，所以如果对于它感兴趣的各位，一定花点时间去看看。如果它是一部电影的话，我将毫不犹豫地放进第100周的推荐里。&lt;/p&gt;
&lt;p&gt;PS： 从本月开始，每两周左右将会推荐一个合集，这个合集取自我之前推荐的电影。每次的合集主题将会不一样，这样应该能更好地聚合信息吧~&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-01-30 WEEK99&lt;br&gt;逆世界———————————————————————————————Upside Down&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week99.jpg&quot; alt=&quot;逆世界&quot; title=&quot;逆世界&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 朱安·索兰纳&lt;/li&gt;
&lt;li&gt;主演: 克斯汀·邓斯特 / 吉姆·斯特吉斯 / 蒂莫西·斯波 / 詹姆斯·基德尼 / 布鲁·曼库马&lt;/li&gt;
&lt;li&gt;片长: 114分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：6.4/10(from56,056users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：6.2/10(from53,160users)&lt;/li&gt;
&lt;li&gt;影  片类型：科幻、剧情&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这次给大家推荐的是一部软科幻作品《逆世界》。这部电影的故事设定——想象力可以给99分？跟当年的时间规划局一样，是让人眼前一亮的构思。电影在对新世界的环境渲染方面的特效做的也是很赞。男女主角一个帅一个美~&lt;br&gt;好了我实在编不下去了，这部电影从剧情和人物塑造上来说都是槽点满满。至于为什么推荐给各位纯粹是因为电影的构思相当可以，不过导演和编剧实在是浪费了好的想法，拍出了一部并不让人满意的电影。不过既然是推荐的电影，含着泪也要写完推送！&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-01-30 WEEK98&lt;br&gt;小萝莉的猴神大叔———————————————————————————————Bajrangi Bhaijaan&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week98.jpg&quot; alt=&quot;小萝莉的猴神大叔&quot; title=&quot;小萝莉的猴神大叔&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 卡比尔·汗&lt;/li&gt;
&lt;li&gt;主演: 萨尔曼·汗 / 哈莎莉·马洛特拉 / 卡琳娜·卡普尔 / 纳瓦祖丁·席迪圭 / 埃朗·哈斯米&lt;/li&gt;
&lt;li&gt;片长: 159分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.2/10(from34,731users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.8/10(from29,908users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、喜剧&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这次给大家推荐的电影是2015年口碑上乘的《小萝莉的猴神大叔》。片名的翻译实在是够了。想想《三傻》，这种硬生生把整部电影的分数拉下多少。不过必须得说，这是一部把人间真爱拍得如此令人感动如此令人潸然泪下的电影。&lt;br&gt;不会说话的小萝莉遇上热心肠直脑筋虔诚的猴神大叔，这个组合本身就很有戏剧性。联想《这个杀手不太冷》里莱昂跟玛蒂达的组合，大与小，动与静，似乎处处都是矛盾但却毫无违和感。&lt;br&gt;而一个送小萝莉回家的故事，之所以能够获得如此高的评分，更重要的东西在于它背后的故事。印度和巴基斯坦犹如朝鲜和韩国一样，自分治以来两个国家苦大仇深。而引起这些深仇大恨的主要事来源于宗教——穆斯林和印度教派的不合。这部电影不仅把大叔对萝莉的爱描述地令人同情，同时还上升到一种超脱国家仇恨，超越宗教信仰的程度——大叔是印度人信仰印度教而小萝莉来自巴基斯坦却正好与之“不合”地是个穆斯林。这一路过关斩将的护送，还不忘隐射出两个国家相关机构的一些丑陋的面貌。而这些东西都是在敲打着观影人的内心，敲打着这两个国家的内心。&lt;br&gt;小萝莉与大叔的最后一幕，也是让多少人留下感动的泪水。不能说一部电影就能改变多少东西，但是至少它折射出来的爱，超越国别，超越宗教却是令人肃穆起敬，令人感动的。宝莱坞这几年的电影确实水平越来越好了。值得一看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-01-17 WEEK97&lt;br&gt;低俗小说———————————————————————————————Pulp Fiction&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week97.jpg&quot; alt=&quot;低俗小说&quot; title=&quot;低俗小说&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演: 昆汀·塔伦蒂诺&lt;/li&gt;
&lt;li&gt;主演: 约翰·特拉沃尔塔 / 乌玛·瑟曼 / 阿曼达·普拉莫 / 蒂姆·罗斯 / 塞缪尔·杰克逊 &lt;/li&gt;
&lt;li&gt;片长: 154分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.9/10(from1,243,532users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from256,754users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、犯罪&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这次给你们推荐的电影相信很多人都曾听说过。影片的名字确实有点令人望而却步。在上周看完昆汀的《八恶人》之后，对昆汀的电影好感度又上升到一个境界。而这次的《低俗小说》则是昆汀的成名作，一举奠定他在导演界的地位。&lt;br&gt;那么本片是为何能够有如此的口碑？首先是叙事的方式。环状的故事结构，能够让人眼前一亮。这样的叙事是脱离了常规的叙事方式，让观众有种措手不及的感觉。而更加重要的地方，在于人物的塑造。这个人在这个故事里体现出来的隐忍，在下一个故事里就能看出他凶险的另一面。另外一个人在这个故事里体现出的杀人不眨眼，在另外一个故事里居然就成了改邪归正的救世主一般的人。这些变化之大令人瞠目但是却又非常地合理——是的非常地合理，在昆汀的故事描述下，你觉得这虽然超出了一部分你的认知但是往这个方向发展却又挑不出什么问题。&lt;br&gt;人物在昆汀的故事里总是占有着不可替代的位置。而每个人都是有血有肉，每个人都有着自己的两面。低俗小说的味道在于整个情节虽然并没有讨巧之处却能够让观众在整场电影下来之后意犹未尽。虽然说昆汀的暴力美学的血腥会让人有所不适，但是这个算是昆汀的电影特色的东西就见仁见智了。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-01-10 WEEK96&lt;br&gt;八恶人———————————————————————————————The Hateful Eight&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week96.jpg&quot; alt=&quot;八恶人&quot; title=&quot;八恶人&quot;&gt;&lt;/p&gt;
&lt;!--more--&gt;
&lt;ul&gt;
&lt;li&gt;导演: 昆汀·塔伦蒂诺&lt;/li&gt;
&lt;li&gt;主演: 塞缪尔·杰克逊 / 库尔特·拉塞尔 / 詹妮弗·杰森·李 / 沃尔顿·戈金斯 / 德米安·比齐尔 / 蒂姆·罗斯 / 迈克尔·马德森 / 布鲁斯·邓恩 / 詹姆士·帕克斯 / 查宁·塔图姆 / 丹娜·格瑞尔 / 佐伊·贝尔 / 李·霍斯利&lt;/li&gt;
&lt;li&gt;片长: 168分钟/182分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.1/10(from72,617users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.6/10(from20,226users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、悬疑&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这次给大家推荐的最近口碑上乘的新片，来自昆汀的《八恶人》。片名实在接地气，然而整部电影看下来却是非常酣畅淋漓。&lt;br&gt;故事采用章节式推进——就像在看一本小说或者看一出戏剧一样，从每章的标题里我们都能看出一些端倪。标题或多或少地能够让观众猜到一些情节，但是这部电影就是让你无法猜透。昆汀在本片里塑造了8个恶人——有别于世俗所认可的“好人”。8个有血有肉，性格各异的恶人。在故事发生的“主战场”——Minnie的杂货店里，汇聚着代表着美国南北战争结束后的各类人，土匪，强盗，赏金猎人，黑人，将军等等。每个人都有着自己的故事，每个人代表着一类人。在这里，黑人主义和女权主义的融合在昆汀手下变得如此自然。我们自然知道来者不善，但是来者有多不善却是无法在第一时间猜透的。就好比那个黑人赏金猎人，三个“不经意吐露”的事件让这个角色从恶人-狠人-又恶又狠的人直线推进。而在一开始你甚至会为他的一些怜悯之心而产生些许敬意，直到最后却会让你觉得他真是罪有应得，大快人心。这些情感的变化正是昆汀给予观众最强的视觉和情感的冲击。虽然他的电影的一些所谓的暴力美学会让一些人厌恶。但不可否认的是，本片在塑造人物和剧情发展的叙事手法上的水平确实高于其他同行。都说昆汀是神，也许没那么夸张，但也足够让你来拜读一下他的作品了。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2016-01-03 WEEK95&lt;br&gt;机械姬———————————————————————————————Ex Machina&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week95.jpg&quot; alt=&quot;机械姬&quot; title=&quot;机械姬&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 亚历克斯·加兰&lt;/li&gt;
&lt;li&gt;主演: 奥斯卡·伊萨克 / 多姆纳尔·格里森 / 艾丽西亚·维坎德&lt;/li&gt;
&lt;li&gt;片长: 108分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：7.7/10(from210,854users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.5/10(from68,985users)&lt;/li&gt;
&lt;li&gt;影  片类型：科幻、惊悚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。新年快乐~这次推荐给大家的是2015年的高分科幻电影机械姬。这个故事又是一个AI的故事。但是与《I，robot》不同的是，这个故事发生的年代跟我们是平行的——而《I，robot》是未来故事。人工智能，是一个很有争议的话题。一方面，人类的技术发展的光芒的展现在于强大的AI，而另外一方面，过于强大的AI最终有可能反过来导致人类的灭亡——这是《I，robot》这类AI故事亘古不变的矛盾结构。而机械姬虽然也逃脱不了这种禁锢，却拍得格外唯美。因为它不是从结果来讲述——它是从过程来讲述的。从图灵测试开始——这是整个故事的大框架。图灵测试也是目前测试AI的一个终极手段。&lt;br&gt;很有意思的地方在于这部电影将导致人类的灭亡这个主题缩小到——AI将会反过来毁灭它的父亲——造物主。只不过它毁灭造物主的方式让人觉得这已经不能算是AI了，这简直是超过AI了。甚至做到了情感的欺骗。是的，这个是之前的电影很少能出现的东西，而这也是体现出超越AI的地方。当观众已经被带入EVA的情感，而最后被深深打击的时候——也许你才能真正感慨到AI的强大与可怕。&lt;br&gt;当然，在一些方面的槽点也是不少，比如电影里编代码的片段实在是好笑。&lt;br&gt;人们总说科幻电影，是未来的预演。所以对于AI这种东西，迟早都是要面对的。科幻电影拍的好坏，跟情节固然重要，跟重要的是，要能引起当代的共鸣，要能引发深思。机械姬做到了，推荐观看。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;2015-12-26 WEEK94&lt;br&gt;诺丁山———————————————————————————————Notting Hill&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week94.jpg&quot; alt=&quot;诺丁山&quot; title=&quot;诺丁山&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导演: 罗杰·米歇尔&lt;/li&gt;
&lt;li&gt;主演: 朱莉娅·罗伯茨\休·格兰特&lt;/li&gt;
&lt;li&gt;片长: 124分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：7.0/10(from190,947users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：7.9/10(from158,394users)&lt;/li&gt;
&lt;li&gt;影  片类型：爱情、剧情&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。12月22号是一周一部好电影两周年整。新的一年又要开始啦，周电要开启第三年的序幕了。由于前两季的周电里，我一直遵循着在推荐里不剧透的原则，发现这样写出来的东西很别扭，所以从第三年开始，推荐里会适当地采用一些剧情来辅助描述。当然我还是会尽量做到少剧透，毕竟剧情是电影的灵魂。&lt;br&gt;作为第三年的首部推荐电影，是来自好友的强烈推荐——《诺丁山》。这部电影之前没听过——我只听过《断背山》嗯。&lt;br&gt;整部电影的节奏慢条斯理，十分接近我们的日常生活。经营不善的书店、平静如故的小镇、倒霉的人、事和美好的阳光构成了这部电影的框架。翻版的类灰姑娘剧情——结局基本上在开头就能猜到，但是我们还是很关注男主与女主的每次相遇时发生的剧情。&lt;br&gt;浪漫主义色彩浓重的电影造就的结局也许会让人有所反感，但是本片里的一些其他的东西却是让人隐隐感动的。人生处事不如意，但是有着一群有爱的好友却是不能让人忽视的一笔重要的财富。友情与爱情在这部电影里占的比重基本上1:1，导演在讲述男主友情的部分一点都不吝啬——大家都有困难，大家都有倒霉之事，但是都不会借此嘲笑彼此，相反积极乐观，互相鼓励，有困难时互相打气，帮助。我想也正因为有如此有爱的一群朋友，男主如此乐观的性格，才会让女主能够喜欢上男主。&lt;br&gt;剧情虽然不能说一波三折，却也微波不断。充满戏剧性和浪漫性的情节给观众带来不少的欢乐。&lt;br&gt;值得注意的是，影片里的配乐只在关键时候出现，出现的曲目歌词都十分应景。而更多的时候就是人物的对白和交互，这些手段我想是为了更好地还原生活吧。&lt;br&gt;“就像一个瘾君子买不到毒品一样。”男主的遭遇和很多人一样。我们对待感情的时候很多时候有着很多的无奈。不过多想想好的方面，多对自己的生活充满阳光，它或许能你带来些许正能量。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;2016-12-20 WEEK143 浪潮&lt;/p&gt;
&lt;p&gt;浪潮——————————————Die Welle&lt;br&gt;&lt;img src=&quot;https://img.piegg.cn/week143.jpg&quot; alt=&quot;浪潮&quot; title=&quot;浪潮&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E6%97%A5%E5%BF%97/"/>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E6%97%A5%E5%BF%97/%E5%91%A8%E7%94%B5/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>element-ui默认主题二次开发小记</title>
    <link href="https://molunerfinn.com/element-default-theme/"/>
    <id>https://molunerfinn.com/element-default-theme/</id>
    <published>2016-12-07T07:41:00.000Z</published>
    <updated>2016-12-07T07:45:36.231Z</updated>
    
    <content type="html">&lt;h1 id=&quot;element-theme-default_语法解析&quot;&gt;element-theme-default 语法解析&lt;/h1&gt;&lt;p&gt;我fork了官方的仓库，方便进行二次开发：&lt;a href=&quot;https://github.com/Molunerfinn/theme-default&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/Molunerfinn/theme-default&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ElementUI/theme-default&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;element-theme-default&lt;/a&gt;提供的工具和文档只能通过修改&lt;code&gt;element-variables.css&lt;/code&gt;这个文件进行一些局部样式调整，比如整体的颜色风格，一些长宽、边距、圆角尺寸等。如果需要进行定制、二次开发的话，单纯修改&lt;code&gt;element-variables.css&lt;/code&gt;是不够的。还需要修改&lt;code&gt;element-theme-default&lt;/code&gt;的源码。在查看&lt;code&gt;element-theme-default&lt;/code&gt;源码的时候发现了一些有趣的东西。记录如下，方便二次开发。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;首先是&lt;code&gt;element-theme-default&lt;/code&gt;采用的是下一代CSS风格的开发方式，用了基于PostCss的&lt;a href=&quot;https://github.com/ElemeFE/postcss-salad&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Post-salad&lt;/a&gt;来编译，而不是我之前认为的SCSS\LESS等预处理。不过总体而言如果有预处理的经验，还是能够很快上手。&lt;/p&gt;
&lt;p&gt;几个显著特征：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;采用var进行全局样式变量定义&lt;/li&gt;
&lt;li&gt;支持@import引入外部css&lt;/li&gt;
&lt;li&gt;支持层级嵌套书写&lt;/li&gt;
&lt;li&gt;支持一些独特的语法&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一些独特的语法列举如下：&lt;/p&gt;
&lt;p&gt;1.&lt;code&gt;@component-namespace&lt;/code&gt; 后面跟着的通常是&lt;code&gt;el&lt;/code&gt;，会通知整个组件的class前缀渲染为&lt;code&gt;el&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;以下的部分是跟在&lt;code&gt;@component-namespace&lt;/code&gt;层级之后,也就是都在&lt;code&gt;@component-namespace el {...}&lt;/code&gt;花括号内。&lt;/p&gt;
&lt;p&gt;2.&lt;code&gt;@b&lt;/code&gt; 后面跟着的class会渲染为：&lt;code&gt;el-class&lt;/code&gt;。例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; alert&lt;/span&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;el-alert&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3.&lt;code&gt;@modifier&lt;/code&gt;或者&lt;code&gt;@m&lt;/code&gt;后面跟着的class会被渲染为：&lt;code&gt;--class&lt;/code&gt;。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; alert&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;modifier&lt;/span&gt; info&lt;/span&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;m&lt;/span&gt; warning&lt;/span&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;会被渲染为&lt;br&gt;&lt;figure class=&quot;highlight nimrod&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;el-alert--info&lt;span class=&quot;decorator&quot;&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;el-alert--warning&lt;span class=&quot;decorator&quot;&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;4.&lt;code&gt;@e&lt;/code&gt;后面跟着的class会被渲染为：&lt;code&gt;__class&lt;/code&gt;。例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; alert&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;e&lt;/span&gt; content&lt;/span&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;el-alert__content&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;5.&lt;code&gt;@when&lt;/code&gt;后面跟着的class会被渲染为：&lt;code&gt;.is-class&lt;/code&gt;。例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; alert&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;e&lt;/span&gt; title&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;when&lt;/span&gt; bold &lt;/span&gt;&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;el-alert__title.is-bold&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;6.&lt;code&gt;@mixin button-size&lt;/code&gt; 后面跟着四个值，分别代表是padding上下、padding左右，font-size，border-radius。&lt;/p&gt;
&lt;p&gt;例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; button&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;mixin&lt;/span&gt; button-size &lt;span class=&quot;number&quot;&gt;10px&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;30px&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;40px&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;.el-button&lt;/span&gt;&lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;padding&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;10px&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;font-size&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;30px&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;border-radius&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;40px&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;7.&lt;code&gt;@mixin button-variant&lt;/code&gt;后面跟着3个值，分别代表color、background-color、border-color。同时还会渲染一系列的hover\active\focus等颜色的深浅变化。&lt;br&gt;例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;b&lt;/span&gt; button &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;at_rule&quot;&gt;@&lt;span class=&quot;keyword&quot;&gt;mixin&lt;/span&gt; button-variant white blue black&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为：&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;.el-button&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  color: white;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  background-color: blue;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  border-color: black;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.el-button:hover,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.el-button:focus&amp;#123;...&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/* 一系列颜色变化 */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;8.&lt;code&gt;tint()&lt;/code&gt;和&lt;code&gt;shade()&lt;/code&gt;函数，分别用来使颜色提升亮度、颜色降低亮度用的。接受两个参数，第一个是颜色值，第二个是明暗百分比。&lt;/p&gt;
&lt;p&gt;例如：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;.foo&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;tint&lt;/span&gt;(&lt;span class=&quot;hexcolor&quot;&gt;#BADA55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42%&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;.bar&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background-color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;shade&lt;/span&gt;(&lt;span class=&quot;hexcolor&quot;&gt;#663399&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42%&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;会被渲染为：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;.foo&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#e2efb7&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;.bar&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background-color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#2a1540&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;element-theme-default_二次开发指南&quot;&gt;element-theme-default 二次开发指南&lt;/h1&gt;&lt;p&gt;官方给出的&lt;a href=&quot;http://element.eleme.io/#/zh-CN/component/custom-theme&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;例子&lt;/a&gt;目前还有一些问题，由于缺少了&lt;code&gt;vue-popup&lt;/code&gt;组件，在&lt;code&gt;et --watch&lt;/code&gt;的时候会报错。&lt;/p&gt;
&lt;p&gt;我fork的仓库里加入了&lt;code&gt;vue-popup&lt;/code&gt;的组件，在官方解决这个问题之前暂时可以采用如下方式（目前跟官方仓库保持同步）：&lt;/p&gt;
&lt;h2 id=&quot;首先是安装工具：&quot;&gt;首先是安装工具：&lt;/h2&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm &lt;span class=&quot;tag&quot;&gt;i&lt;/span&gt; element-theme -g&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;然后安装默认主题（本仓库）：&quot;&gt;然后安装默认主题（本仓库）：&lt;/h2&gt;&lt;figure class=&quot;highlight stylus&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm &lt;span class=&quot;tag&quot;&gt;i&lt;/span&gt; https:&lt;span class=&quot;comment&quot;&gt;//github.com/Molunerfinn/theme-default.git -D&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;初始化变量文件&quot;&gt;初始化变量文件&lt;/h2&gt;&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;et -&lt;span class=&quot;built_in&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果使用默认配置，执行后当前目录会有一个&lt;code&gt;element-variables.css&lt;/code&gt;文件。内部包含了主题所用到的所有变量，它们使用 CSS4 的风格定义。大致结构如下：&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;pseudo&quot;&gt;:root&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;/* Colors&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -------------------------- */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-primary&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#20a0ff&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-success&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#13ce66&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-warning&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#f7ba2a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-danger&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#ff4949&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-info&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#50BFFF&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-blue&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#2e90fe&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-blue-light&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#5da9ff&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-blue-lighter&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;rgba&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;var&lt;/span&gt;(--color-blue), &lt;span class=&quot;number&quot;&gt;0.12&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-white&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#fff&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-black&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#000&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;--color-grey&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#C0CCDA&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;修改变量&quot;&gt;修改变量&lt;/h2&gt;&lt;p&gt;可以通过修改&lt;code&gt;element-variables.css&lt;/code&gt;文件里的变量，即可改变整体风格。&lt;/p&gt;
&lt;h2 id=&quot;修改源码&quot;&gt;修改源码&lt;/h2&gt;&lt;p&gt;进入&lt;code&gt;node_modules/element-theme-default/src&lt;/code&gt;目录下修改相应文件的代码即可。&lt;/p&gt;
&lt;h2 id=&quot;编译主题&quot;&gt;编译主题&lt;/h2&gt;&lt;p&gt;保存文件后，到命令行里执行 et 编译主题，如果你想启用 watch 模式，实时编译主题，增加 -w 参数。&lt;/p&gt;
&lt;figure class=&quot;highlight nginx&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;title&quot;&gt;et&lt;/span&gt; -w&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;修改源码的时候不会触发编译的watch模式，需要手动再保存一遍&lt;code&gt;element-variables.css&lt;/code&gt;这个文件才可以触发编译效果。&lt;/p&gt;
&lt;p&gt;开发愉快~&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;element-theme-default_语法解析&quot;&gt;element-theme-default 语法解析&lt;/h1&gt;&lt;p&gt;我fork了官方的仓库，方便进行二次开发：&lt;a href=&quot;https://github.com/Molunerfinn/theme-default&quot;&gt;https://github.com/Molunerfinn/theme-default&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ElementUI/theme-default&quot;&gt;element-theme-default&lt;/a&gt;提供的工具和文档只能通过修改&lt;code&gt;element-variables.css&lt;/code&gt;这个文件进行一些局部样式调整，比如整体的颜色风格，一些长宽、边距、圆角尺寸等。如果需要进行定制、二次开发的话，单纯修改&lt;code&gt;element-variables.css&lt;/code&gt;是不够的。还需要修改&lt;code&gt;element-theme-default&lt;/code&gt;的源码。在查看&lt;code&gt;element-theme-default&lt;/code&gt;源码的时候发现了一些有趣的东西。记录如下，方便二次开发。&lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>markline.js——轻量级canvas绘制标记线的库</title>
    <link href="https://molunerfinn.com/marklinejs/"/>
    <id>https://molunerfinn.com/marklinejs/</id>
    <published>2016-11-05T15:23:00.000Z</published>
    <updated>2016-11-06T02:01:06.809Z</updated>
    
    <content type="html">&lt;p&gt;这段时间要做的是一个数据可视化的小型项目。其中最基本要求是实现两点之间的迁徙关系（比如同一个用户不同时间上网的地点）用一条有向线段（markline）联系在一起。很自然的我一开始想的就是采用百度的&lt;a href=&quot;http://echarts.baidu.com/echarts2/doc/example/map21.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;echarts&lt;/a&gt;里的一个地图工具实现这个方案，并且百度给出的方案里默认的样式已经很漂亮了。&lt;br&gt;But，除了基本要求之外，还有一些深层次的要求：1.用户自定义背景图案，2.鼠标触摸上markline时，显示的内容可以自定义等等。&lt;br&gt;于是我发现了echarts不支持自定义比如jpg的背景图案——就这点就必须让我放弃使用echarts了。于是我必须考虑自己实现一下echarts里markline的样式了。&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;&lt;br&gt;  &lt;a href=&quot;https://github.com/Molunerfinn/markline.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;&lt;br&gt;    &lt;img width=&quot;300px&quot; height=&quot;300px&quot; src=&quot;https://raw.githubusercontent.com/Molunerfinn/markline.js/master/img/markline.gif&quot;&gt;&lt;br&gt;  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;

&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;/p&gt;&lt;h2 id=&quot;面临的问题&quot;&gt;面临的问题&lt;/h2&gt;&lt;p&gt;第一次自己手动实现一个canvas的小型效果库，有点紧张。由于之前做过一个热图的项目，用了&lt;a href=&quot;http://projects.calebevans.me/jcanvas/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;jCanvas&lt;/a&gt;这个依赖于jquery的，所以想着这次能不能继续用用这个库。&lt;/p&gt;
&lt;p&gt;主要要实现几个东西：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;画曲线而不是简单的画直线。并且A-&amp;gt;B和B-&amp;gt;A应该是不能重合的两条曲线&lt;/li&gt;
&lt;li&gt;线上应该要有类似ehcarts的标记小球在运动，指示线的方向，并且效果要好，不能直接拿个小圆球死板的运动&lt;/li&gt;
&lt;li&gt;不光有标记线，还要有标记点&lt;/li&gt;
&lt;li&gt;标记线和标记点的hover提示信息应该能够自定义&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;那么重点来了。&lt;/p&gt;
&lt;p&gt;画曲线不难，我们有二阶贝塞尔曲线可以拿来画曲线。&lt;/p&gt;
&lt;p&gt;运动的小球，貌似也不太难——但是要做出小球身后的扫尾效果不容易——一开始我是没有思路的。&lt;/p&gt;
&lt;p&gt;hover信息自定义的话，就涉及到判断鼠标的位置在不在所画的元素上了——也即坐标计算。&lt;/p&gt;
&lt;h3 id=&quot;jCanvas最后并没有采用&quot;&gt;jCanvas最后并没有采用&lt;/h3&gt;&lt;p&gt;其实如果没有第二点要求的话，用jCanvas来画的话就蛮快的了。只需要画出所需要的线，加个mouseover、mousein、mouseout事件就行了。但是整个项目最难的地方在于：让线上的小球动起来、并且运动要有扫尾。&lt;/p&gt;
&lt;p&gt;并且，让小球沿着二阶贝塞尔曲线运动的方法，我一开始也没有很好的思路。&lt;/p&gt;
&lt;p&gt;由于我在尝试使用画小球扫尾的时候，jCanvas自定义的layer会导致扫尾失效。无奈，我只能放弃采用jCanvas而采用自己手动书写的方式了。&lt;/p&gt;
&lt;h2 id=&quot;手写markline-js&quot;&gt;手写markline.js&lt;/h2&gt;&lt;p&gt;在放弃了jCanvas的支持后我就在想，能否自己写一个专门的库来做这种效果呢——一开始还在想要不要用上jquery，后来再想想，用上了jquery好像也就是用用dom选择器而已。那还是用原生的js写个独立的库吧。&lt;/p&gt;
&lt;h3 id=&quot;二阶贝塞尔曲线&quot;&gt;二阶贝塞尔曲线&lt;/h3&gt;&lt;p&gt;首先二阶贝塞尔曲线的画线没有难度，（听说过不了解或者没听说过的可以参考张鑫旭前辈对于&lt;a href=&quot;http://www.zhangxinxu.com/wordpress/2014/06/deep-understand-svg-path-bezier-curves-command/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;贝塞尔曲线&lt;/a&gt;的解释。）我们只需要确定始末点坐标以及控制点坐标即可。&lt;/p&gt;
&lt;p&gt;那么控制点坐标应该如何确定？为了画出的曲线是对称的曲线，我的想法很简单，取始末两点线上的垂直平分线上的某点作为控制点即可。那这个某点该如何确认？从A-&amp;gt;B和从B-&amp;gt;A应该是两条不重合的线，那么两条线控制点就应该分别在始末点的两侧。我用一种比较原始的方法来确定控制点的位置：  &lt;/p&gt;
&lt;p&gt;设：始末点连线&lt;code&gt;Line&lt;/code&gt;的长度是&lt;code&gt;L&lt;/code&gt;，始末点连线的中点是&lt;code&gt;P&lt;/code&gt;，始末点连线的垂直平分线是&lt;code&gt;VLine&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;那么控制点就是在&lt;code&gt;VLine&lt;/code&gt;上距离&lt;code&gt;P&lt;/code&gt;点&lt;code&gt;0.2L&lt;/code&gt;长度的地方。&lt;/p&gt;
&lt;p&gt;至于控制点在&lt;code&gt;Line&lt;/code&gt;的左侧还是&lt;code&gt;Line&lt;/code&gt;的右侧，需要仔细研究一下：否则出现在同一侧的话，A-&amp;gt;B和B-&amp;gt;A的线不就重合了么。&lt;/p&gt;
&lt;h4 id=&quot;数学运算时间&quot;&gt;数学运算时间&lt;/h4&gt;&lt;p&gt;为了计算控制点的坐标，我写了一个函数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 计算二阶贝塞尔曲线的控制点&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  sx     起点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  sy     起点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dx     终点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dy     终点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @return point  控制点坐标 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;calControlPoint&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;sx,sy,dx,dy&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a,x,y,X,Y,len;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  X = (sx + dx) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Y = (sy + dy) / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  len = &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.sqrt(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.pow((dy - sy),&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) + &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.pow((dx - sx),&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)); &lt;span class=&quot;comment&quot;&gt;// 控制贝塞尔曲线曲率&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  a = &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.atan2(dy - sy, dx - sx);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;x: X - len * &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.sin(a),y: Y + len * &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.cos(a)&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中计算&lt;code&gt;Line&lt;/code&gt;的长度&lt;code&gt;L&lt;/code&gt;用的是基本的计算两点之间距离公式。&lt;code&gt;Line&lt;/code&gt;的中点&lt;code&gt;P&lt;/code&gt;的坐标&lt;code&gt;(X,Y)&lt;/code&gt;也很简单用两点的X\Y坐标之和的一半可以算出。&lt;br&gt;而至于控制点在&lt;code&gt;Line&lt;/code&gt;的哪一侧就靠始末点相对于坐标轴x的夹角了，计算夹角的函数是&lt;code&gt;Math.atan2()&lt;/code&gt;，可以返回夹角度数（弧度制）。然后再用&lt;code&gt;Math.sin()&lt;/code&gt;和&lt;code&gt;Math.cos()&lt;/code&gt;来计算控制点相对于中点&lt;code&gt;P&lt;/code&gt;的横纵坐标偏移量。&lt;/p&gt;
&lt;p&gt;通过这样的方式我们就能够确定从A-&amp;gt;B以及从B-&amp;gt;A各自的控制点并且不会发生重叠的情况了。&lt;/p&gt;
&lt;h3 id=&quot;箭头方向的确立&quot;&gt;箭头方向的确立&lt;/h3&gt;&lt;p&gt;由于是有向线段，所以需要在终点处给出线段的箭头。其实画箭头也没什么难度，就是两条相交的线而已。不过确定箭头的方向以及正确画出还需要一些计算。&lt;/p&gt;
&lt;h4 id=&quot;数学运算时间-1&quot;&gt;数学运算时间&lt;/h4&gt;&lt;p&gt;首先箭头的方向，就是控制点到终点方向连线的方向，换言之就是先得得到这个角度。&lt;/p&gt;
&lt;p&gt;我写了一个用于计算两点之间（A-&amp;gt;B）的角度计算的小函数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 计算bezier曲线尾端角度&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  cx   控制点x坐标       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  cy   控制点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dx   线段终点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dy   线段终点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @return      返回角度&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;calcAngle&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;cx,cy,dx,dy&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.atan2((dy - cy) , (dx - cx));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将这个角度应用到下面这个画箭头的函数里：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 画箭头&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  ctx    canvas绘画上下文&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dx     线段终点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  dy     线段终点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  angle  箭头角度&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  sizeL  箭头长度&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  sizeW  箭头宽度&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;drawArrow&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;ctx,dx,dy,angle,sizeL,sizeW,color&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; al = sizeL / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; aw = sizeW / &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.translate(dx,dy);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.rotate(angle);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.translate(-al,-aw);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.beginPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.moveTo(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.lineTo(al,aw); &lt;span class=&quot;comment&quot;&gt;// 画箭头&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.lineTo(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,sizeW); &lt;span class=&quot;comment&quot;&gt;// 画箭头&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.strokeStyle = color;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.stroke();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中用到的两个比较重要的方法&lt;code&gt;ctx.save()&lt;/code&gt;和&lt;code&gt;ctx.restore()&lt;/code&gt;是为了不破坏之前绘图的情况而进行的操作，save是用于保存当前的绘图情况，相当于将绘图的信息入栈，然后在“崭新”的画布上进行绘制，然后用restore方法将之前保存的绘图情况还原，相当于出栈。通过这样的方式就可以绘制不同线的箭头而互相不干扰了。然后做一些相应的旋转变换就能够符合箭头的朝向预期了。&lt;/p&gt;
&lt;h3 id=&quot;运动点运动效果&quot;&gt;运动点运动效果&lt;/h3&gt;&lt;p&gt;这个是重头戏。这个库基本上就是围绕这个运动点而生的。&lt;/p&gt;
&lt;p&gt;首先，如何让一个点沿着已有的贝塞尔曲线运动呢？&lt;/p&gt;
&lt;p&gt;这里可以从这个codepen里参考一二：&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p data-height=&quot;311&quot; data-theme-id=&quot;0&quot; data-slug-hash=&quot;vyBQGN&quot; data-default-tab=&quot;result&quot; data-user=&quot;molunerfinn&quot; data-embed-version=&quot;2&quot; data-pen-title=&quot;vyBQGN&quot; data-preview=&quot;true&quot; class=&quot;codepen&quot;&gt;See the Pen &lt;a href=&quot;http://codepen.io/molunerfinn/pen/vyBQGN/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vyBQGN&lt;/a&gt; by molunerfinn (&lt;a href=&quot;http://codepen.io/molunerfinn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@molunerfinn&lt;/a&gt;) on &lt;a href=&quot;http://codepen.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;script async src=&quot;//assets.codepen.io/assets/embed/ei.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;这里的关键是创建一个svg的二阶贝塞尔曲线的path。（同样还是可以参考张鑫旭前辈的&lt;a href=&quot;http://www.zhangxinxu.com/wordpress/2014/06/deep-understand-svg-path-bezier-curves-command/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;贝塞尔曲线&lt;/a&gt;）当然这个path可以不插入dom里，而只是创建它。后面要用到这个svg的path的一些方法：而实际上小球是沿着这个svg的path提供的坐标而运动的，而不是沿着canvas所画的贝塞尔曲线运动。&lt;/p&gt;
&lt;p&gt;创建一条二阶贝塞尔曲线的svg的path方法不难：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * svg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  x1   曲线起点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  y1   曲线起点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  cx   曲线控制点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  cy   曲线控制点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  x2   曲线终点x坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * @param  y2   曲线终点y坐标&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; path = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElementNS(&lt;span class=&quot;string&quot;&gt;&#39;http://www.w3.org/2000/svg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.setAttribute(&lt;span class=&quot;string&quot;&gt;&#39;d&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;M&#39;&lt;/span&gt; + x1 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + y1 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;Q&#39;&lt;/span&gt; + cx + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + cy + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + x2 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + y2);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;创建这条路径的作用在哪里呢？主要是要获取这条路径上的点坐标信息。首先对于SVG的这个path有几个方法我们需要知道：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;path.getTotalLength(); &lt;span class=&quot;comment&quot;&gt;// 获取整条path的长度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.getPointAtLength(length); &lt;span class=&quot;comment&quot;&gt;// 获取path在长度为length处的点的信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.getPointAtLength(length).x &lt;span class=&quot;comment&quot;&gt;// 获取path在长度为length处的点的x坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.getPointAtLength(length).y &lt;span class=&quot;comment&quot;&gt;// 获取path在长度为length处的点的y坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这有什么用呢？简单来说，我们可以获取整条path的长度&lt;code&gt;len&lt;/code&gt;，然后可以通过计算运动时间百分比&lt;code&gt;percent&lt;/code&gt;乘上&lt;code&gt;len&lt;/code&gt;就构成了&lt;code&gt;path.getPointAtLength(length);&lt;/code&gt;里的&lt;code&gt;length&lt;/code&gt;。然后就可以通过这个方法来获取x、y坐标了。&lt;/p&gt;
&lt;p&gt;换句话说，我只需要把小球运动的过程映射成&lt;code&gt;percent&lt;/code&gt;就能够得到当前小球应该要出现的位置。&lt;/p&gt;
&lt;p&gt;那么如何实现小球的运动呢？&lt;/p&gt;
&lt;p&gt;伪代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 声明一个全局变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; len = path.getTotalLength(); &lt;span class=&quot;comment&quot;&gt;// 获取path的总长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;animation&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  percent &amp;gt;= &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; ? percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; : percent += &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; point = path.getPointAtLength(len * (percent / &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  X = point.x; &lt;span class=&quot;comment&quot;&gt;// 获取小球的X坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Y = point.y; &lt;span class=&quot;comment&quot;&gt;// 获取小球的Y坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Ball.paint(); &lt;span class=&quot;comment&quot;&gt;// 画球 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.requestAnimationFrame(animation) &lt;span class=&quot;comment&quot;&gt;// 循环&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如上的伪代码提供了一个思路，通过累加percent来达到小球沿着曲线运动的效果。并且当percent累加到100时重新从0开始计算，就能够实现小球周而复始在线上运动了。&lt;/p&gt;
&lt;h3 id=&quot;运动点拖尾效果&quot;&gt;运动点拖尾效果&lt;/h3&gt;&lt;p&gt;说到这个拖尾效果，就比较复杂了。在我查看了网上很多非直线运动点拖尾效果的例子（比如这个&lt;a href=&quot;http://wow.techbrood.com/fiddle/8268&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;彗星扫尾&lt;/a&gt;）。&lt;/p&gt;
&lt;p&gt;总结一下，主要采用的办法基本上有两种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;重绘+透明背景色填充——ctx.fillStyle = 透明色&lt;/li&gt;
&lt;li&gt;重绘+整体透明度填充——ctx.globalAlpha = 透明度&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;什么意思呢，举个例子：&lt;/p&gt;
&lt;p&gt;A时刻，我在画布上画了一个点(x,y)；&lt;/p&gt;
&lt;p&gt;B时刻，我在画布上花了第二个点(x + c,y + c)，并进行透明背景色\整体透明度填充。&lt;/p&gt;
&lt;p&gt;那么B时刻的画面覆盖了A时刻的画面，但是是加上了透明色\透明度的覆盖，那么就会让A时刻的点颜色变淡。（类似于加上了一层遮罩一样）&lt;/p&gt;
&lt;p&gt;C时刻重复之前的做法，D时刻重复之前的做法……以此无穷循环往复，就可以让一个运动点出现拖尾的效果了。&lt;/p&gt;
&lt;p&gt;那么markline.js里采用的是哪一种方法呢？&lt;/p&gt;
&lt;p&gt;为了能够让用户自定义背景，通过实验我采用了第二种&lt;code&gt;重绘+整体透明度填充——ctx.globalAlpha = 透明度&lt;/code&gt;的方法。这种方法的好处是，你的背景在重绘的同时还能保持亮度不变，并且&lt;code&gt;ctx.globalAlpha&lt;/code&gt;比&lt;code&gt;ctx.fillStyle&lt;/code&gt;更加灵活，可以不参与绘制图形的着色而只是改变整体透明度，因而可以随时在画的时候通过&lt;code&gt;ctx.save()&lt;/code&gt;和&lt;code&gt;ctx.restore()&lt;/code&gt;的方式来改变整体透明度，达到合理控制局部绘制的效果。&lt;/p&gt;
&lt;p&gt;伪代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 声明一个全局变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; len = path.getTotalLength(); &lt;span class=&quot;comment&quot;&gt;// 获取path的总长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;animation&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.globalAlpha = &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 值是0-1,0代表完全透明，1代表完全不透明&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  percent &amp;gt;= &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; ? percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; : percent += &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; point = path.getPointAtLength(len * (percent / &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  X = point.x; &lt;span class=&quot;comment&quot;&gt;// 获取小球的X坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Y = point.y; &lt;span class=&quot;comment&quot;&gt;// 获取小球的Y坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Ball.paint(); &lt;span class=&quot;comment&quot;&gt;// 画球 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.requestAnimationFrame(animation) &lt;span class=&quot;comment&quot;&gt;// 循环&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;那么每次在绘图的同时就会加上一层透明度，盖住上一次绘图的痕迹，也就能够实现拖尾的效果了。&lt;/p&gt;
&lt;h3 id=&quot;背景&quot;&gt;背景&lt;/h3&gt;&lt;p&gt;重绘的时候必须要有背景跟着重绘，否则会出现点、线重叠渲染的情况。并且还需要借助一个属性：&lt;code&gt;ctx.globalCompositeOperation&lt;/code&gt;（可以参考这篇&lt;a href=&quot;http://www.cnblogs.com/jenry/archive/2012/02/11/2347012.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;），这个属性用于描述后画上的图形跟原先在画布上的图形的图层叠加关系应该是什么样的。&lt;/p&gt;
&lt;p&gt;这里我们采用&lt;code&gt;ctx.globalCompositeOperation = &amp;#39;source-over&amp;#39;;&lt;/code&gt;，将后绘制的图形叠加到原先有的图形上。&lt;/p&gt;
&lt;p&gt;伪代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 声明一个全局变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; len = path.getTotalLength(); &lt;span class=&quot;comment&quot;&gt;// 获取path的总长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;animation&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.globalCompositeOperation = &lt;span class=&quot;string&quot;&gt;&#39;source-over&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ctx.globalAlpha = &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 值是0-1,0代表完全透明，1代表完全不透明&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  percent &amp;gt;= &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt; ? percent = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; : percent += &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; point = path.getPointAtLength(len * (percent / &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  X = point.x; &lt;span class=&quot;comment&quot;&gt;// 获取小球的X坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Y = point.y; &lt;span class=&quot;comment&quot;&gt;// 获取小球的Y坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Ball.paint(); &lt;span class=&quot;comment&quot;&gt;// 画球 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.requestAnimationFrame(animation) &lt;span class=&quot;comment&quot;&gt;// 循环&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;线、球对象构建&quot;&gt;线、球对象构建&lt;/h3&gt;&lt;p&gt;小球的运动依赖于SVG的path。而SVG的path和Canvas的markline都依赖于所提供的始末点和计算出来的控制点。因此，可以在创建一条markline的同时生成一条SVG的path。然后把这条path“通知”给小球。然后再进行运动循环即可让小球运动起来。&lt;/p&gt;
&lt;p&gt;于是里目前我们创建了三个对象：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MarkLine——用于开放接口连接外部&lt;/li&gt;
&lt;li&gt;Line——用于保存markline的信息，提供绘制markline的方法&lt;/li&gt;
&lt;li&gt;Ball——用于保存ball的信息，提供绘制ball的方法&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;同时，在这个库里还需要创建两个数组：lines和balls。分别用于存放生成的Line、Ball的实例——用于之后调用它们的方法。&lt;/p&gt;
&lt;p&gt;于是Line的创建大致是如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Line = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,option,canvas&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.canvas = canvas;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.ctx = canvas.getContext(&lt;span class=&quot;string&quot;&gt;&quot;2d&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x1 = option.from.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y1 = option.from.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2 = option.to.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2 = option.to.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.style = option.style || &lt;span class=&quot;string&quot;&gt;&quot;#fff&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.info = option.info || &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.init(); &lt;span class=&quot;comment&quot;&gt;// 初始化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  lines[lineCount] = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;// 用于存放Line的实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  lineCount++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.createBall(); &lt;span class=&quot;comment&quot;&gt;// 通过Line创建Ball&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Line.prototype = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    init: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cPoint = calControlPoint(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x1,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y1,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cx = cPoint.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cy = cPoint.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.angle = calcAngle(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cx,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cy,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;// 创建小球运动的svg路线&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.path = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElementNS(&lt;span class=&quot;string&quot;&gt;&#39;http://www.w3.org/2000/svg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.path.setAttribute(&lt;span class=&quot;string&quot;&gt;&#39;d&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;M&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x1 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y1 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;Q&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cx + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cy + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2 + &lt;span class=&quot;string&quot;&gt;&#39; &#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.len = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.path.getTotalLength();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    paint: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ctx = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.ctx;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.save();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.beginPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.globalAlpha = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.shadowOffsetX = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.shadowOffsetY = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.shadowBlur = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.shadowColor=&lt;span class=&quot;string&quot;&gt;&quot;rgba(255,255,255,0.3)&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.draw(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.strokeStyle = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.style;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.stroke();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      drawArrow(ctx,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.angle,&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.style);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.closePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.restore();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    draw: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;width&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ctx = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.ctx;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.moveTo(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x1,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.quadraticCurveTo(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cx,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.cy,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x2,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.lineWidth = width;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ctx.lineCap   = &lt;span class=&quot;string&quot;&gt;&#39;round&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    createBall: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ctx: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.ctx,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        x1: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x1,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        y1: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y1,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        path: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.path,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        len: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.len,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        style: &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.style&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Ball(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id,obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上述过程就是创建了一个叫做Line的类，这个类包含着基本的&lt;code&gt;init()&lt;/code&gt;初始化，&lt;code&gt;draw()&lt;/code&gt;绘制，&lt;code&gt;paint()&lt;/code&gt;渲染以及&lt;code&gt;createBall()&lt;/code&gt;等方法。&lt;/p&gt;
&lt;p&gt;我们在实例化一个Line的对象的时候，就会将当前实例的对象push一份到lines的数组里。这样是为了之后能够方便地在&lt;code&gt;animation()&lt;/code&gt;这个函数里调用创建好的对象的方法。&lt;/p&gt;
&lt;p&gt;举个例子：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;animation&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ......&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; lines.length; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    lines[i].paint(); &lt;span class=&quot;comment&quot;&gt;// 绘制markline&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ......&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;那么Ball的创建也是同理，通过Line的创建，然后自动触发Line.createBall()的方法创建小球。创建的同时将小球所需要的基本信息传入。同样，实例化一个小球的同时会将这个对象push一份到balls的数组里。&lt;/p&gt;
&lt;p&gt;通过这样的方式，就可以实现绘制动态运动小球了。&lt;/p&gt;
&lt;h3 id=&quot;拖拽和缩放的实现——事件的监听&quot;&gt;拖拽和缩放的实现——事件的监听&lt;/h3&gt;&lt;p&gt;接着我们来实现一下事件的监听。因为canvas以及canvas上的元素跟dom元素有着本质的区别，对于浏览器而言，canvas上绘制的任何东西，都只跟canvas这个画布本身有关，不具备dom元素自带的事件、属性。所以如果要识别canvas上的元素，进行事件监听的话，只能对于整个canvas进行事件监听，用鼠标的位置、鼠标对于整个canvas的事件来进行canvas上的元素识别、改变。&lt;/p&gt;
&lt;p&gt;对于canvas而言，我们能够监听的鼠标事件大致有这几个：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mousedown&lt;/li&gt;
&lt;li&gt;mouseup&lt;/li&gt;
&lt;li&gt;mousemove&lt;/li&gt;
&lt;li&gt;mouseover&lt;/li&gt;
&lt;li&gt;contextmenu&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;拖拽&quot;&gt;拖拽&lt;/h4&gt;&lt;p&gt;拖拽事件可以拆解成：首先&lt;code&gt;mousedown&lt;/code&gt;，然后在此基础上，&lt;code&gt;mousemove&lt;/code&gt;，然后&lt;code&gt;mouseup&lt;/code&gt;结束拖拽。&lt;/p&gt;
&lt;p&gt;于是写法上结构应该是这样：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mousedown&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...... &lt;span class=&quot;comment&quot;&gt;// 鼠标按下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mousemove&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...... &lt;span class=&quot;comment&quot;&gt;// 鼠标按下之后进行移动&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mouseup&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...... &lt;span class=&quot;comment&quot;&gt;// 鼠标按下之后松开鼠标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结构很简单。不过要如何实现拖拽的效果呢？&lt;/p&gt;
&lt;p&gt;思路是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先在&lt;code&gt;mousedown&lt;/code&gt;的时候，记录这个瞬间的坐标值（相对于canvas画布的）&lt;/li&gt;
&lt;li&gt;在&lt;code&gt;mousemove&lt;/code&gt;的时候，同样记录&lt;code&gt;mousemove&lt;/code&gt;瞬间的坐标值，然后将这个坐标值与&lt;code&gt;mousedown&lt;/code&gt;的坐标值进行比较，得到&lt;code&gt;坐标变换公式&lt;/code&gt;，然后将这个应用到这个画布上所有绘制的元素的坐标上&lt;/li&gt;
&lt;li&gt;清空画布&lt;/li&gt;
&lt;li&gt;元素重绘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这样就能够实现在视觉上拖拽的效果了。&lt;/p&gt;
&lt;p&gt;然而这里面有很关键的东西：坐标变换公式。&lt;/p&gt;
&lt;h4 id=&quot;数学运算时间-2&quot;&gt;数学运算时间&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;写canvas就是在跟数学打交道啊&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;来实现一下背景的移动：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mousedown&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取当前鼠标点击的坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mouse = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x : e.clientX - canvas.getBoundingClientRect().left,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    y : e.clientY - canvas.getBoundingClientRect().top&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 计算偏移函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;offset&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;mouse,x,y&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      x : mouse.x - x,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      y : mouse.y - y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imgOffset = offset(mouse,imgPosition.x,imgPosition.y); &lt;span class=&quot;comment&quot;&gt;// 背景图偏移量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mousemove&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 获取当前鼠标移动的坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mouse = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      x : e.clientX - canvas.getBoundingClientRect().left,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      y : e.clientY - canvas.getBoundingClientRect().top&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    imgPosition.x = mouse.x - imgOffset.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    imgPosition.y = mouse.y - imgOffset.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cleanCvs(); &lt;span class=&quot;comment&quot;&gt;// 清除画布&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    paintBg(); &lt;span class=&quot;comment&quot;&gt;// 绘制背景图&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  canvas.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;mouseup&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...... &lt;span class=&quot;comment&quot;&gt;// 鼠标按下之后松开鼠标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;通过不停的用当前的坐标与之前的坐标进行对比，就可以得到真正应该出现的地方的坐标了。&lt;/p&gt;
&lt;h4 id=&quot;缩放&quot;&gt;缩放&lt;/h4&gt;&lt;p&gt;其实缩放有很多种，（主要是缩放中心点不同分成很多种缩放效果）。最好的缩放效果自然是跟随鼠标的位置进行缩放——可以参考PC端各种地图的缩放效果。&lt;/p&gt;
&lt;p&gt;缩放的时候就需要统一一下坐标了。简单来说，我们可以通过先实现背景的缩放，然后其他的元素可以相对于背景的缩放进行缩放。这样，坐标就统一到背景上了。&lt;/p&gt;
&lt;p&gt;缩放的算法比拖拽难度高一些。基本代码如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;scaleCvs&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;scale,e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    scale &amp;gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; ? scaleFlag += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : scaleFlag -=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    e = e || &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.event;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 获取鼠标的位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mouse = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      x : e.clientX - canvas.getBoundingClientRect().left, &lt;span class=&quot;comment&quot;&gt;// 距离canvas左侧的距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      y : e.clientY - canvas.getBoundingClientRect().top  &lt;span class=&quot;comment&quot;&gt;// 距离canvas顶部的距离&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 获取鼠标中心点与背景的左上角坐标偏移量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; offset = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      x : mouse.x - imgPosition.x,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      y : mouse.y - imgPosition.y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 缩放的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; translate = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      x: (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; - scale) * offset.x,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      y: (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; - scale) * offset.y,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 背景偏移最后坐标值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imgTransX = imgPosition.x + translate.x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imgTransY = imgPosition.y + translate.y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 计算曲线端点缩放后的位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; lines.length; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; tempOption = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        x1 : scale * (lines[i].x1 - imgPosition.x) + imgTransX,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        y1 : scale * (lines[i].y1 - imgPosition.y) + imgTransY,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        x2 : scale * (lines[i].x2 - imgPosition.x) + imgTransX,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        y2 : scale * (lines[i].y2 - imgPosition.y) + imgTransY&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 背景位置、长宽&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    imgPosition.x = imgTransX;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    imgPosition.y = imgTransY;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    canWidth = scale * canWidth;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    canHeight = scale * canHeight;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cleanCvs();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    paintBg();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;window-requestAnimationFrame&quot;&gt;window.requestAnimationFrame&lt;/h3&gt;&lt;p&gt;在这个方法出现之前，我们只能用setTimeout(function(){},1000 / 60)的方式进行模拟60帧的绘制，并且效率低下，资源占用高。然而有了&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;window.requestAnimationFrame&lt;/a&gt;这个属性了之后，浏览器层面的支持的动画渲染，能够有效提升效率，资源占有率低。&lt;/p&gt;
&lt;p&gt;当然这个属性并不是完美支持所有浏览器。所以有人写了一个这个方法的&lt;a href=&quot;https://github.com/darius/requestAnimationFrame&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;polyfill&lt;/a&gt;，能够兼容绝大多数浏览器（在不支持这个方法的浏览器里使用setTimeout）。markline.js实际上也引入了这个库。在此感谢。&lt;/p&gt;
&lt;p&gt;其实整个markline.js的绘制实际上就是构建在一个window.requestAnimationFrame的不停的刷新的函数中。&lt;/p&gt;
&lt;h2 id=&quot;结尾&quot;&gt;结尾&lt;/h2&gt;&lt;p&gt;写完这个库的时候我是长出一口气，之前我从未接触过面向对象的编程，到这次实现这个面向对象的库真的不容易。学到了不少，也让我更加爱上了原生的js、canvas。&lt;/p&gt;
&lt;p&gt;如果我的这篇文章能够帮助你理解一些canvas的东西或者面向对象的一些写法的话，我表示十分荣幸。&lt;/p&gt;
&lt;p&gt;如果你喜欢这库，请给个star啦，也欢迎做做contributor~&lt;/p&gt;
&lt;p&gt;markline.js的github&lt;a href=&quot;https://github.com/Molunerfinn/markline.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;地址&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这段时间要做的是一个数据可视化的小型项目。其中最基本要求是实现两点之间的迁徙关系（比如同一个用户不同时间上网的地点）用一条有向线段（markline）联系在一起。很自然的我一开始想的就是采用百度的&lt;a href=&quot;http://echarts.baidu.com/echarts2/doc/example/map21.html&quot;&gt;echarts&lt;/a&gt;里的一个地图工具实现这个方案，并且百度给出的方案里默认的样式已经很漂亮了。&lt;br&gt;But，除了基本要求之外，还有一些深层次的要求：1.用户自定义背景图案，2.鼠标触摸上markline时，显示的内容可以自定义等等。&lt;br&gt;于是我发现了echarts不支持自定义比如jpg的背景图案——就这点就必须让我放弃使用echarts了。于是我必须考虑自己实现一下echarts里markline的样式了。&lt;/p&gt;
&lt;p&gt;&lt;p align=&quot;center&quot;&gt;&lt;br&gt;  &lt;a href=&quot;https://github.com/Molunerfinn/markline.js&quot;&gt;&lt;br&gt;    &lt;img width=&quot;300px&quot; height=&quot;300px&quot; src=&quot;https://raw.githubusercontent.com/Molunerfinn/markline.js/master/img/markline.gif&quot;&gt;&lt;br&gt;  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="JS" scheme="https://molunerfinn.com/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>2016年毕业季-笔记本选购建议</title>
    <link href="https://molunerfinn.com/notebook2016/"/>
    <id>https://molunerfinn.com/notebook2016/</id>
    <published>2016-08-02T13:32:52.000Z</published>
    <updated>2016-08-02T13:42:17.129Z</updated>
    
    <content type="html">&lt;p&gt;又到了一年一度买电脑的时节。每年这个时候总会有一堆的对电脑不太熟悉的同学们不知道从何下手，对于电脑的配置可以说是一窍不通。呐，近来闲来无事，在解决了些许同学的选购方面的问题后，我决定授人以鱼不如授人以渔，可能会不会来得有点迟？。。特写一篇文章来告诉那些对于选购电脑有所困惑的同学。当然，这仅仅是自己这几年来对于选购电脑的经验之谈，如有说错之处，也请大家指出。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;接下来进入正题&quot;&gt;接下来进入正题&lt;/h2&gt;&lt;p&gt;对于选购电脑我觉得价位是很关键的一点。你心理能承受的价位是多少？&lt;br&gt;鉴于目前大部分同学的情况，我把本文的价位定位在4000-8000的范围。超出该范围的价位的，如果预算足够的话，我觉得你是可以考虑购买macbook pro的。&lt;br&gt;OK，明确价位的话就让我们来看看什么会影响价位。&lt;/p&gt;
&lt;h3 id=&quot;1-CPU&quot;&gt;1.CPU&lt;/h3&gt;&lt;p&gt;作为一款电脑的核心，CPU的运算速度决定了处理数据的能力。目前市面上的CPU以INTEL的CPU为主，AMD的CPU也有。但是普遍来说，同频率同核心的CPU还是INTEL比较强劲。因而CPU的强弱决定了价格的高低。就目前来说，市面上的INTEL的CPU主要为酷睿I3，I5，I7三种大类。数字越高代表CPU等级越高。一般而言，I5的CPU就足够了。而I3的CPU处理能力已经稍微欠缺了。有钱的话当然I7妥妥的入手。CPU又有核心数与频率以及线程三大因素。其中在核心数确定的情况下（双核、四核），频率是决定性因素。正常的频率越高处理能力越好。经验之谈，正常频率在2.0GHZ以上的双核I5就能满足我们的学习工作游戏的需要了。CPU还能超频，就是超出正常频率运算来满足某些情况某些软件的需要。当然这样发热量太大。然后同等处理器的四核的处理速度大于双核的速度。不过如果没有很强的做视频，做图之类的需求，双核的I5绝对是妥妥满足你的需要的。&lt;/p&gt;
&lt;p&gt;目前来说I5\I7均发展到了6代。所以买到5代或者6代的I5\I7都是可以的。如果看到4代或者4代以下的CPU，你就需要好好考虑一下是否值得购买了。&lt;/p&gt;
&lt;p&gt;CPU型号的选择：一般来说需要看的地方有3个。一个是CPU架构等级，I5还是I7；一个是CPU的代数，5代还是6代；一个是CPU电压版本，低压，标压还是高压版本。举个例子：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;I5-6300HQ&lt;/code&gt;，就是I5，6代，高电压版本。&lt;br&gt;&lt;code&gt;I5-5300U&lt;/code&gt;，就是I5，5代，低电压版本。&lt;/p&gt;
&lt;p&gt;第一位数字代表第几代，最后一个字母代表电压等级。U–低电压，M–标压，HQ–高压。比较不推荐购买U系列的低压版本的CPU，因为性能稍微欠缺。能买M或者HQ的就买。另外如果是I5-5300HQ和I5-6300U这样隔代但是电压版本不一样的情况，还是推荐购买I5-5300HQ，毕竟主频是更为关键的一个东西。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/i5-hq.png&quot; alt=&quot;I5cpu&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/i7-hq.png&quot; alt=&quot;I7CPU&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/i7-u.png&quot; alt=&quot;I7CPU&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;2-内存&quot;&gt;2.内存&lt;/h3&gt;&lt;p&gt;内存作为一款电脑能否流畅得运行大型游戏大型软件而言是很重要的一个指标。如果你看中的电脑只有2GB的内存的话，除了自己后期加装内存条，否则我还是劝你放弃选购该机的念头。内存的大小直接决定了原机的操作系统的位数。一般来说目前4GB内存为标配，而且4GB的内存一般也都装上了64位而非32位的操作系统。4GB的内存对于处理正常OFFICE办公，CAD，玩游戏（LOL,DOTA）一类的还是可以的。但是如果有做视频的需要还是推荐自己加装内存条。内存条一般而言为DDR3 1333MHZ或者1600MHZ，以及目前市面上能见到的DDR4 2133MHZ规格。后续要加内存条的同学记得要加同等频率的内存条，否则是向频率低的内存条兼容的。（如电脑原本自带1333MHZ的内存条，你买了1600MHZ的装进去，1600的也只能发挥1333的功力。）&lt;/p&gt;
&lt;p&gt;一般而言，DDR3系列的内存条就已经足够，如今市面上的DDR4系列当然更是性能上佳。有经济能力的当然比较推荐上DDR4。不过我们说内存的首要关注点应该是内存的容量，其次才是系列和主频。不过有一点必须值得注意，内存条跟CPU不一样，CPU对于笔记本而言几乎是无法更换。然而内存条是可以自己更换和加装的，所以不必因为比如说只有4G内存的电脑就不值得买。如果这台电脑其余的配置都足够的话，完全可以入手，然后自己加购内存条来装就行了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/DDR4.png&quot; alt=&quot;DDR4&quot;&gt;&lt;/p&gt;
&lt;p&gt;值得注意的是，从2012年开始，市面上开始出现了DDR3L系列的低电压版内存条如下图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/DDR3L.png&quot; alt=&quot;DDR3L&quot;&gt;&lt;/p&gt;
&lt;p&gt;其实本没有太多必要说这个低压内存条的问题，但是考虑到很多人对DDR3L系列的低电压内存条不熟悉，甚至有的人会认为这是低性能、被削弱的内存条时，我觉得还是说一下比较好。说明一下，低电压版内存条是未来笔记本上的主流。低电压带来的不仅是发热量的减小更是功耗的降低，对于笔记本而言续航能力能够得到更好的提升。而性能问题则不必担心，低电压版内存条与标压版内存条并不会有性能上太多差距。甚至有的理论认为更好，当然我们更持谨慎态度。所以不要对低电压版内存条有偏见。&lt;/p&gt;
&lt;h3 id=&quot;3-显卡&quot;&gt;3.显卡&lt;/h3&gt;&lt;p&gt;这个就是重头戏了。在如今这个变态软件游戏横行的年代，显卡的重要性已经堪比CPU。一张好的显卡可以承担更优秀的画质的游戏，电影。可以更流畅得运行它们。因而现在的电脑的预算的很大一部分来自于显卡。一般而言如果不是单机烧显卡游戏控，而只是玩玩LOL,DOTA等游戏的同学，那么对于显卡就不必有太多的诉求，正常的显卡就能驾驭。显卡是笔记本发热的主要来源。显卡主要分为N卡和A卡。&lt;/p&gt;
&lt;p&gt;其中，N卡为NVIDIA（英伟达）公司做的显卡，该类显卡对应于游戏，3D显示的处理性能要相对高于同等级A卡。应用于笔记本上目前主要是GTM系列的卡了，当然这两年GTXM这种已经快有桌面级显卡能力的显卡也配备进了笔记本。类似于&lt;code&gt;GT750M&lt;/code&gt;，&lt;code&gt;GT850M&lt;/code&gt;，&lt;code&gt;GTX 960M&lt;/code&gt;等等。&lt;/p&gt;
&lt;p&gt;N卡辨别好坏主要看第二个数字。一般而言5及其以上的卡属于N卡里的好卡，5以下的数字则代表中低端卡。例如750和940虽然在代数上差了两代，但是性能却几乎一致。因为中间的数字的原因，750代表着当年的好卡，而940是如今的中低端卡。这是值得注意的。而在第二位数字相同的情况下，第一位数字若是高一般而言会比较好。例如950比850好。第三位数字可以忽略。所以，在没有什么高需求的情况下，810-840，940之类的卡是绝对能满足你们的工作日常需求的。&lt;br&gt;如果对于大型游戏情有独钟，GTXM系列的高端卡则是你不二的选择。X代表着更强的性能，当然带来的发热也是不可避免的。&lt;/p&gt;
&lt;p&gt;A卡为AMD公司做的显卡。A卡目前市面上存在旧命名规则——以HD打头的卡以及新命名规则以Radeon RX打头的两种卡。&lt;br&gt;简单说一下HD以及RR系列的命名规则。&lt;br&gt;HD开头，以四位数字为结尾，真正代表性能的是第二和第三位字母，第二位数字中9代表顶级和高端产品，8代表次高端主流产品，7代表中高端和中端性能级主流产品，6代表中端主流产品、5代表中低端产品、4代表入门级产品。第三位数基本以奇数存在，越高的数字代表性能在同档次中越好。不过HD打头的卡如今几乎是见不到了，除非少数HD高端卡。&lt;br&gt;RR系列R9最高，代表发烧级，R7代表中高端，R5代表中低端，R3代表低端。例如&lt;code&gt;RR9 430&lt;/code&gt;。4代表最新一代产品，后面的数字理论上越大是越好的，但是主要看R后面的数字啦。A卡我不是太熟，所以按照命名规则你们能相对分辨出好坏卡。一般来说A卡对于2D做图，电影方面的处理优于N卡，但是游戏方面会弱。不过就目前来看市面上的N卡还是占绝对霸主地位，你能挑到A卡的机器还是不多。&lt;br&gt;至于独显，集显这种东西，不必太纠结。当然如果只有集显卡的话，不是很推荐。一般而言市面上都是独显或者独显集显并存，所以不必太纠结这个。&lt;strong&gt;（注意下列显卡的级别）&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/820.png&quot; alt=&quot;820&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/950.png&quot; alt=&quot;950&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/960M.png&quot; alt=&quot;960M&quot;&gt;&lt;/p&gt;
&lt;p&gt;另外再附上2016年4月的笔记本显卡天梯图，从天梯图里你能很容易比较出显卡性能的差异，当然并不是所有的卡都在上面，没再上面的卡可以通过上面介绍的方式自己估计性能：（天梯图如果太小可以点开图片后右键另存为。）&lt;/p&gt;
&lt;p&gt;当然显卡还有显存、位宽等主要参数，不过对于没有特别的性能需求的人来说，这些参数的作用比不上先选择一张正确的、适合你的显卡来得重要。有兴趣可以自行了解。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/NA-201604.png&quot; alt=&quot;NA&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;4-硬盘&quot;&gt;4.硬盘&lt;/h3&gt;&lt;p&gt;机械硬盘容量目前已经从320标配升至500/1T了。而硬盘来说有分机械硬盘和固态硬盘（SSD）。固态硬盘读取速度超快，然而价格也很贵。有的电脑的硬盘配置为128+1T的这种情况，128指的就是固态硬盘。一般来说把系统装在SSD里能达到高速开关机，流畅开关软件\游戏的目的。说一下机械硬盘，目前而言生产机械硬盘的厂家质量都不错的。而机械硬盘的转速是读取的关键。一般来说都是5400转的，也有一些到7200转。转速越快当然读取越快，价格也越高。1T或者500G的容量，对于不同的用户会有不同的体验。如果是游戏电影党还是推荐1T的硬盘。对于没有什么容量需求的或者不知道自己容量需求的同学500G对于你就足矣啦。实在不够后续自己再买移动硬盘之类的还是可以的。硬盘不应该是购机的主要影响选项，因为完全可以自己DIY。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/SSD.png&quot; alt=&quot;SSD&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/HDD.png&quot; alt=&quot;HDD&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;5-操作系统&quot;&gt;5.操作系统&lt;/h3&gt;&lt;p&gt;虽然现在微软的系统横行的年代，难免还是会有为了省成本而不采用WINDOWS系统的机器。正版的微软系统是很贵的，所以购机的时候注意看看你买的机器安装的操作系统是不是LINUX啊DOS啊这类的不熟悉的系统。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/Win10.png&quot; alt=&quot;Win10&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/Linux.png&quot; alt=&quot;Linux&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;6-电池&quot;&gt;6.电池&lt;/h3&gt;&lt;p&gt;一般而言容量越大的电池续航能力越强当然也相对会贵。然而有硬件节能技术的机器相对来说续航能力就会更好点。一般而言4400MAH的机器4-6小时的连续运行能力是有的。不过正常笔记本而言，电池容量一般不作为考量范围，因为基本上都是带电工作。&lt;/p&gt;
&lt;h3 id=&quot;7-屏幕&quot;&gt;7.屏幕&lt;/h3&gt;&lt;p&gt;在当年屏幕还是1366×768横飞的年代，如今的电脑显示屏的分辨率早已上了1920×1080甚至更高的程度。分辨率越高代表屏幕显示效果越细腻，越好。不过需要注意的是，windows下很多软件对于高分屏没有做到非常好的适配，反而会出现模糊的现象，这是正常的，购机后需要注意。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Molunerfinn/fj-learning-resources/master/public/img/1920.png&quot; alt=&quot;显示器&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;8-其他&quot;&gt;8.其他&lt;/h3&gt;&lt;p&gt;剩下的就是些可有可无的东西啦。像什么键盘啦，音响啦，光驱啦，散热啦。简单说一下，这些东西单价都不是很贵，而且质量都差不太多。而有无光驱都无所谓，多了光驱的话如果没有用上也可以卸下，减轻重量；也可以卸下加装风扇，显卡，硬盘等等。音响的话，一般来说4000价位的机器的音响如果没有JBL以及杜比认证。外放效果会差一点。而散热对于笔记本来说就是个永恒的问题，几乎没有散热让你满意的机器。这些设备差距在价格上不会体现得太过明显啦。&lt;br&gt;有对外设有需要的同学比如机械键盘，耳机，音响之类的。如果你的需求已经能达到这个水平说明你对笔记本的配置已经有所了解，能够自己去考虑提升了，这里便不再赘述额外的东西了。&lt;/p&gt;
&lt;p&gt;我其实不是很喜欢推荐什么机型。因为有的人对于推荐的机型也没有了解，只是有的人说，这台好诶！但是对于没有经验的人来说，它到底好在哪里？只看到所谓2G独显+1T海量硬盘+I5第XX代CPU。这种打着高光的广告特别容易蒙住没有购机经验的同学。2G独显？GT730也有可能能有2G独显啊，但是效果已经跟不上主流了。I5第XX代CPU也有低压和标压版不同，1.6GHZ的I5也是有的，而处理性能对于我们要运行CAD等软件来说就吃力了。所以这些东西不是一日而就，而是长期的累积才能懂得。而对于只要一次购机的人来说，这些东西往往是他们最匮乏的。所以我想通过这篇小教程让你明白，你看上的笔记本为什么好，它好在哪里。它能帮你解决什么问题，你能用它来做什么。&lt;/p&gt;
&lt;p&gt;为了照顾对笔记本品牌不熟悉的同学，这里列出的品牌都是可以考虑的：三星、戴尔、联想、惠普、华硕、神州、东芝等等。排名没有先后，没出现的品牌并不意味着不能买（例如苹果的MAC），只是我觉得要写下去就太多了。上面的品牌的机器口碑都还是可以的。&lt;/p&gt;
&lt;h2 id=&quot;专业需求&quot;&gt;专业需求&lt;/h2&gt;&lt;p&gt;本次更新主要还有更新一些对于笔记本有特殊要求的专业。针对不同专业，有疑惑的可以稍微看看。当然如果对于游戏有格外要求的同学，显卡请自行调整到GTX950M及其以上。&lt;/p&gt;
&lt;h3 id=&quot;数媒院专业&quot;&gt;数媒院专业&lt;/h3&gt;&lt;p&gt;数媒专业对于笔记本的要求相对来说比较高，主要是由于数媒专业有动画制作、视频制作等需求，而这些需求对于笔记本的需求就相对高一些。基本来说CPU\显卡\硬盘\内存都必须在比较高的水平这样对于数媒专业的同学来说才能比较好的应对大学这几年的学习任务。CPU建议I5或者I7的6代HQ，推荐I7。显卡最好能够上GTX950M及以上，注意&lt;code&gt;显存&lt;/code&gt;（不是内存）最好能有2G及以上。硬盘最好能有SSD支持，128G的SSD就足够。机械硬盘最好在1T或更多的容量，因为你们的素材要求的存储空间还是比较大的。然后就是内存，内存最好8GB及8GB以上，因为制作视频等软件很吃内存。&lt;/p&gt;
&lt;p&gt;综上：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;CPU&lt;/th&gt;
&lt;th&gt;显卡&lt;/th&gt;
&lt;th&gt;硬盘&lt;/th&gt;
&lt;th&gt;内存&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;I5\I7的6代HQ&lt;/td&gt;
&lt;td&gt;GTX950M及以上&lt;/td&gt;
&lt;td&gt;SSD+1T机械硬盘&lt;/td&gt;
&lt;td&gt;8GB及以上&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;计算机院以及软件专业&quot;&gt;计算机院以及软件专业&lt;/h3&gt;&lt;p&gt;计算机院以及软件专业实际上对于笔记本的要求并没有那么高。真正来说这类专业的同学在跑程序的编译方面才会感受到需要一些笔记本的配置。正常来说需要考虑的有CPU\硬盘\内存。&lt;br&gt;CPU建议I5或者I7的6代HQ，硬盘最好能有SSD，可以用来装编译器。内存至少要4GB以上，8GB为佳，8GB以上更好。&lt;/p&gt;
&lt;p&gt;综上：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;CPU&lt;/th&gt;
&lt;th&gt;硬盘&lt;/th&gt;
&lt;th&gt;内存&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;I5\I7的6代HQ&lt;/td&gt;
&lt;td&gt;SSD&lt;/td&gt;
&lt;td&gt;8GB及以上&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;信通院、电子院专业&quot;&gt;信通院、电子院专业&lt;/h3&gt;&lt;p&gt;跟计算机专业的要求实际上是没什么区别的，甚至CPU要求没有那么高。&lt;/p&gt;
&lt;p&gt;综上：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;CPU&lt;/th&gt;
&lt;th&gt;硬盘&lt;/th&gt;
&lt;th&gt;内存&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;I5的6代HQ或者以上&lt;/td&gt;
&lt;td&gt;SSD&lt;/td&gt;
&lt;td&gt;4GB及以上&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;自动化院专业&quot;&gt;自动化院专业&lt;/h3&gt;&lt;p&gt;自动化院相关专业对于计算机的要求相对更低了些。主要要跑的大型程序有CAD和SolidWorks。而这两个程序实际上并不需要特别特别高的配置。&lt;/p&gt;
&lt;p&gt;综上：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;CPU&lt;/th&gt;
&lt;th&gt;硬盘&lt;/th&gt;
&lt;th&gt;内存&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;I5的6代M或者以上&lt;/td&gt;
&lt;td&gt;机械硬盘，有SSD更好&lt;/td&gt;
&lt;td&gt;4GB及以上&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;其他专业&quot;&gt;其他专业&lt;/h3&gt;&lt;p&gt;可以参考上述自动化专业或者信通、电子院专业的要求即可。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;末了，我不想推荐什么机型。这篇文章就是想告诉你应该看重计算机的哪块的地方，应该注意哪块地方。对于购机而言，我的建议顺序是：内心价位-&amp;gt;CPU-&amp;gt;显卡-&amp;gt;硬盘-&amp;gt;内存-&amp;gt;其他。笔记本优于超极本。如果对于轻便有需求的就考虑超极本吧。先按照内心价位把该价位的机器挑出来（具体可上京东，中关村等网站筛选），然后按照顺序一步步选机器。市面上的品牌没有绝对的优劣之分，看配置看评价后再安心下手。要学会看自己的电脑到底哪里好，是配置好还是适合你自己的需求？这些才是最关键的。&lt;/p&gt;
&lt;p&gt;时代在进步，本文估计也会年年更新。本次更新针对2016年。&lt;/p&gt;
&lt;p&gt;以上言辞仅个人拙见，错误难免。希望能帮到需要帮助的人吧。&lt;/p&gt;
&lt;p&gt;Molunerfinn 原创&lt;br&gt;转载请声明&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;又到了一年一度买电脑的时节。每年这个时候总会有一堆的对电脑不太熟悉的同学们不知道从何下手，对于电脑的配置可以说是一窍不通。呐，近来闲来无事，在解决了些许同学的选购方面的问题后，我决定授人以鱼不如授人以渔，可能会不会来得有点迟？。。特写一篇文章来告诉那些对于选购电脑有所困惑的同学。当然，这仅仅是自己这几年来对于选购电脑的经验之谈，如有说错之处，也请大家指出。&lt;br&gt;
    
    </summary>
    
      <category term="其他" scheme="https://molunerfinn.com/categories/%E5%85%B6%E4%BB%96/"/>
    
      <category term="极客" scheme="https://molunerfinn.com/categories/%E5%85%B6%E4%BB%96/%E6%9E%81%E5%AE%A2/"/>
    
    
  </entry>
  
  <entry>
    <title>OSX下iTerm2实现rz/sz与服务器进行文件上传/下载</title>
    <link href="https://molunerfinn.com/iTerm2-lrzsz/"/>
    <id>https://molunerfinn.com/iTerm2-lrzsz/</id>
    <published>2016-07-27T14:15:00.000Z</published>
    <updated>2016-07-27T15:04:12.000Z</updated>
    
    <content type="html">&lt;p&gt;在windows下用xshell、secureCRT等工具只要在服务端装好lrzsz工具包就可以实现简单方便的文件上传下载。昨天在Mac上用iTerm的时候发现iTerm原生不支持rz/sz命令，也就是不支持Zmodem来进行文件传输。遂查了一下，发现解决办法还算简单，不过有点小坑。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;通过brew安装lrzsz&quot;&gt;通过brew安装lrzsz&lt;/h2&gt;&lt;p&gt;首先先假定你安装了&lt;a href=&quot;http://brew.sh/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew&lt;/a&gt;，然后我们通过它，先给Mac安装lrzsz。&lt;br&gt;在终端下输入&lt;code&gt;brew install lrzsz&lt;/code&gt;，静等一会即可安装完毕。&lt;/p&gt;
&lt;h2 id=&quot;下载配置iTerm2的相关脚本&quot;&gt;下载配置iTerm2的相关脚本&lt;/h2&gt;&lt;p&gt;这一步，在给iTerm2加上相应配置前需要下载两个前人已经写好的脚本文件。&lt;/p&gt;
&lt;p&gt;这里是&lt;a href=&quot;https://github.com/mmastrac/iterm2-zmodem&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;下载地址&lt;/a&gt;，将iterm2-recv-zmodem.sh和iterm2-send-zmodem.sh下载到本机，然后将它们放到&lt;code&gt;/usr/local/bin&lt;/code&gt;目录下。&lt;/p&gt;
&lt;p&gt;如果你安装过&lt;code&gt;wget&lt;/code&gt;，也可以在&lt;code&gt;/usr/local/bin&lt;/code&gt;目录下直接执行：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;wget https://raw.githubusercontent.com/mmastrac/iterm2-zmodem/master/iterm2-send-zmodem.sh https://raw.githubusercontent.com/mmastrac/iterm2-zmodem/master/iterm2-recv-zmodem.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后我们将这两个文件赋予可执行权限：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;chmod +x /usr/local/bin/iterm2-send-zmodem.sh /usr/local/bin/iterm2-recv-zmodem.sh&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;配置iTerm2&quot;&gt;配置iTerm2&lt;/h2&gt;&lt;p&gt;找到iTerm2的配置项：iTerm2的Preferences-&amp;gt; Profiles -&amp;gt; Default -&amp;gt; Advanced -&amp;gt; Triggers的Edit按钮。&lt;/p&gt;
&lt;p&gt;然后配置项如下：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Regular Expression&lt;/th&gt;
&lt;th&gt;Action&lt;/th&gt;
&lt;th&gt;Parameters&lt;/th&gt;
&lt;th&gt;Instant&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;rz waiting to receive.\*\*B0100&lt;/td&gt;
&lt;td&gt;Run Silent Coprocess&lt;/td&gt;
&lt;td&gt;/usr/local/bin/iterm2-send-zmodem.sh&lt;/td&gt;
&lt;td&gt;checked&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;\*\*B00000000000000&lt;/td&gt;
&lt;td&gt;Run Silent Coprocess&lt;/td&gt;
&lt;td&gt;/usr/local/bin/iterm2-send-zmodem.sh&lt;/td&gt;
&lt;td&gt;checked&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;尤其注意最后一项需要你将&lt;code&gt;Instant&lt;/code&gt;选项勾上，否则将不生效&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;注意看图：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/iterm2-lrzsz.png&quot; alt=&quot;iterm2-lrzsz&quot;&gt;&lt;/p&gt;
&lt;p&gt;至此结束。只要服务端也已经装好了&lt;code&gt;lrzsz&lt;/code&gt;工具包便可以方便地通过rz\sz来进行文件上传下载了。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在windows下用xshell、secureCRT等工具只要在服务端装好lrzsz工具包就可以实现简单方便的文件上传下载。昨天在Mac上用iTerm的时候发现iTerm原生不支持rz/sz命令，也就是不支持Zmodem来进行文件传输。遂查了一下，发现解决办法还算简单，不过有点小坑。&lt;/p&gt;
    
    </summary>
    
      <category term="其他" scheme="https://molunerfinn.com/categories/%E5%85%B6%E4%BB%96/"/>
    
      <category term="极客" scheme="https://molunerfinn.com/categories/%E5%85%B6%E4%BB%96/%E6%9E%81%E5%AE%A2/"/>
    
    
      <category term="Mac" scheme="https://molunerfinn.com/tags/Mac/"/>
    
  </entry>
  
  <entry>
    <title>移动端web开发初探之Vuejs的简单实战</title>
    <link href="https://molunerfinn.com/vuejs-1/"/>
    <id>https://molunerfinn.com/vuejs-1/</id>
    <published>2016-06-26T09:06:00.000Z</published>
    <updated>2016-11-09T14:44:23.764Z</updated>
    
    <content type="html">&lt;p&gt;这段时间在做的东西，是北邮人论坛APP的注册页。这个注册页是内嵌的网页，因为打算安卓和IOS平台同时使用。因此实际上就是在做移动端的web开发了。&lt;br&gt;在这过程中遇到了不少有意思的东西。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DEMO的github地址在&lt;a href=&quot;https://github.com/Molunerfinn/vue-mobile-learning-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;内容提要：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;meta标签&lt;/li&gt;
&lt;li&gt;Vuejs的简单实战&lt;/li&gt;
&lt;li&gt;CSS移动端全屏背景&lt;/li&gt;
&lt;li&gt;CSS移动端动画初探&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;meta标签&quot;&gt;meta标签&lt;/h2&gt;&lt;p&gt;这点与在PC端写前端有着很大的区别，移动端的meta标签简直多。我就说说我所用到的标签。&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 1、如果支持Google Chrome Frame：GCF，则使用GCF渲染；2、如果系统安装ie8或以上版本，则使用最高版本ie渲染；3、否则，这个设定可以忽略。 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;http-equiv&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;X-UA-Compatible&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;IE=Edge,chrome=1&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 对视窗缩放等级进行限制，使其适应移动端屏幕大小 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;viewport&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;width=device-width, initial-scale=1&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 当把这个网页添加到主屏幕时的标题（仅限IOS） --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;apple-mobile-web-app-title&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;北邮人论坛注册&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 添加到主屏幕后全屏显示 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;meta&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;name&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;apple-touch-fullscreen&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;yes&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;尤其是第二个meta标签，是移动端适配非常重要的一句话。&lt;/p&gt;
&lt;h2 id=&quot;整体布局&quot;&gt;整体布局&lt;/h2&gt;&lt;p&gt;整体的布局大致是4-5页横向布局。第一页是用来填写注册信息的。后面的几页是用来选择关注的版面的。&lt;/p&gt;
&lt;h3 id=&quot;注册信息页&quot;&gt;注册信息页&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/1.png&quot; alt=&quot;注册信息页&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;关注版面页&quot;&gt;关注版面页&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/2.png&quot; alt=&quot;关注版面页&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/3.png&quot; alt=&quot;关注版面页&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/4.png&quot; alt=&quot;关注版面页&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;整体架构&quot;&gt;整体架构&lt;/h2&gt;&lt;p&gt;前端采用的架构大致是这样：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;滑动切换页面的效果来自&lt;a href=&quot;http://idangero.us/swiper&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;swiper.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;页面内容的渲染采用&lt;a href=&quot;http://vuejs.org.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vue.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;页面布局和样式采用纯css，部分效果采用css3&lt;/li&gt;
&lt;li&gt;ajax部分采用&lt;a href=&quot;https://github.com/vuejs/vue-resource&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vue-resource&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;后端支撑的框架来自php的&lt;a href=&quot;http://www.golaravel.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;laravel&lt;/a&gt;，当然，这不是本文的重点，仅提及一下。  &lt;/p&gt;
&lt;p&gt;是的这次的开发中，已经看不到jquery的身影了——这也是前端以后发展后的结果——慢慢地脱离jquery的依赖。不过jquery给前端带来的改变和发展是无人能替代的。&lt;/p&gt;
&lt;h2 id=&quot;swiper-js的应用&quot;&gt;swiper.js的应用&lt;/h2&gt;&lt;p&gt;引入swiper.js来进行页面的切换效果纯粹是因为这次开发的周期要求比较短，要考虑效果和兼容性兼备的情况下，我就偷懒找了一个动画库。  &lt;/p&gt;
&lt;p&gt;不过这个动画库的效果我还是算比较满意的。而整体来说使用也相当方便。尤其是，swiper.js是可以不依赖jquery的。&lt;/p&gt;
&lt;p&gt;使用起来也比较方便。我简要说说用法。&lt;/p&gt;
&lt;p&gt;首先需要在页面顶部的&lt;code&gt;head&lt;/code&gt;标签里加入swiperjs的css文件：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;link rel=&amp;quot;stylesheet&amp;quot; href=&amp;quot;css/swiper.min.css&amp;#39;)&amp;quot;&amp;gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后在页面底部可以引入和写下相应的js：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script src=&lt;span class=&quot;string&quot;&gt;&quot;&amp;#123;&amp;#123; asset(&#39;js/swiper.min.js&#39;) &amp;#125;&amp;#125;&quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- Initialize Swiper --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;actionscript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; swiper = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Swiper(&lt;span class=&quot;string&quot;&gt;&#39;.swiper-container&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pagination: &lt;span class=&quot;string&quot;&gt;&#39;.swiper-pagination&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    paginationType: &lt;span class=&quot;string&quot;&gt;&#39;progress&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    noSwipingClass: &lt;span class=&quot;string&quot;&gt;&#39;swiper-no-swiping&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    allowSwipeToNext: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    allowSwipeToPrev: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解释一下，创建一个swiper的对象，然后这对象的容器是class叫做&lt;code&gt;swiper-container&lt;/code&gt;的一个html元素。对其的配置是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pagination: ‘.swiper-pagination’, 显示页码&lt;/li&gt;
&lt;li&gt;paginationType: ‘progress’, 页码显示格式为进度条，可以参见顶部蓝白色的进度条&lt;/li&gt;
&lt;li&gt;noSwipingClass: ‘swiper-no-swiping’,  不允许进行触摸滑动的元素的class名称&lt;/li&gt;
&lt;li&gt;allowSwipeToNext: true, 允许向后滑动&lt;/li&gt;
&lt;li&gt;allowSwipeToPrev: true, 允许向前滑动&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;相应的HTML代码可以如下：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- swiper生效的容器 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-contanier&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-wrapper&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 具体滑动的页面 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-slide&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-slide&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-slide&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-slide&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 进度条 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;swiper-pagination&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;有些页面是不能直接让用户通过触摸来前后滑动的，而必须通过点击按钮触发。比如第一页注册页，这个页面就是必须填写完信息然后点击下一步进行验证后然后才可以滑动到后面的内容。所以只要将这个页面所在的class里加上&lt;code&gt;swiper-no-swiping&lt;/code&gt;这个class就可以实现无法触摸滑动切换页面了。&lt;/p&gt;
&lt;p&gt;然后我们可以通过&lt;code&gt;swiper.slideNext(bool,time)&lt;/code&gt;这个方法来进行手动控制向后翻页的动作以及控制动画的时长。这个内容会在vue里说到。&lt;/p&gt;
&lt;h2 id=&quot;Vue-js的简单实战&quot;&gt;Vue.js的简单实战&lt;/h2&gt;&lt;p&gt;由于本次的开发只是在原有的北邮人开放平台的项目的基础上加入一个快速注册的功能，所以Vue.js的引入并不是为了将整个项目重构，而只是为了尝试一下脱离jquery的情况下对于开发来说不同的体验是什么，能学到什么。&lt;/p&gt;
&lt;p&gt;关于Vue.js的用法、特性什么的不是本文的重点，题外话就不说了。说说本次实现思路。因为我的Vuejs实际上也只是算入门级别，只能说会用但是还没到能驾驭的程度。&lt;/p&gt;
&lt;p&gt;首先整个页面包在class叫做&lt;code&gt;swiper-contanier&lt;/code&gt;的元素中。因为这个元素包括了滑动所需的所有东西，我们实际上可以简单的把它看成是一个SPA(Single Page Application)，用一个Vue的实例就可以接管整个页面了（这么说是不负责的，因为实际上Vue是组件化的思想）。&lt;/p&gt;
&lt;p&gt;先创建一个基本的Vue的示例，并将其和&lt;code&gt;swiper-container&lt;/code&gt;绑定起来：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; vm = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Vue(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  el: &lt;span class=&quot;string&quot;&gt;&quot;.swiper-contanier&quot;&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 将这个实例与html元素绑定起来&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  data: &amp;#123;&amp;#125;, &lt;span class=&quot;comment&quot;&gt;// 所需要变动、关注的数据，也是vue的核心&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ready: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&amp;#125;, &lt;span class=&quot;comment&quot;&gt;// vue提供的钩子，用于在vue渲染视图完成后立即触发&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  methods: &amp;#123;&amp;#125; &lt;span class=&quot;comment&quot;&gt;// 方法，用于操作、更新、改变数据而改变视图&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;注册页实现&quot;&gt;注册页实现&lt;/h3&gt;&lt;p&gt;上面所说，我们的页面是构建在一个Vue的实例上的。因此不同类型的两种页面如何用一个实例来接管呢？在这里我的实现方式是用两类数据来分别表示。  &lt;/p&gt;
&lt;p&gt;我们分析一下注册页：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/1.png&quot; alt=&quot;注册信息页&quot;&gt;&lt;/p&gt;
&lt;p&gt;实际上注册页的中间部分是重复的元素，他们都是input标签+显示文字标签（对，尤其注意这里并不是用placeholder实现的）。效果：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/blog/5.gif&quot; alt=&quot;效果&quot;&gt;&lt;/p&gt;
&lt;p&gt;所以这中间的部分实际上可以看成是一个列表，可以用Vue的v-for来渲染。列表里所不同的只是显示的文字不同以及input框的类型不同（有text类型的，有password类型的），所以用数据绑定的方式我们可以将这个页面的数据格式安排如下：&lt;/p&gt;
&lt;figure class=&quot;highlight xquery&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;data: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  main: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;username&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;用户名(以英文开头+英文数字)&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;passwd&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;设置密码&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;password&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;passwd_confirm&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;在输入一遍密码&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;password&quot;&lt;/span&gt;&amp;#125;，&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;gwno&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;校园网账户(默认是学号)&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;gwpwd&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;校园网密码(默认是身份证后六位)&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;password&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;同时我们创建一个便于和前端视图进行双向绑定的数据对象&lt;code&gt;userInfo&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;data&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;main&lt;/span&gt;: &lt;span class=&quot;attr_selector&quot;&gt;[...]&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;userInfo&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;username&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;passwd&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;passwd_confirm&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;gwno&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;gwpwd&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;而在前端的话我们就可以用这个数据来进行视图渲染：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;user-info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item in main&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;position: relative;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- input输入框 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 此处用了v-model将数据和视图进行了双向绑定 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;effect&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;&amp;#123;&amp;#123;item.type&amp;#125;&amp;#125;&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;userInfo[item.name]&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 提示信息 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&amp;#123;item.info&amp;#125;&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- input框的底下的线条 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;focus-border cube&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;#&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;下一步&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;于是一个输入的列表就很容易做出来了。然后既然是表单，就需要验证。而此处做的验证实际上有这么几点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户名是否合法/重复？&lt;/li&gt;
&lt;li&gt;两次输入的密码是否相同？&lt;/li&gt;
&lt;li&gt;校园网账户的密码是否正确？&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中只有第二点两次密码输入是否相同可以用前端直接判断，而第一、三点都是需要通过ajax的方式向后台发送验证请求的。为了能够体现和辨别错误与否，我们在main下的每个条例里加入了一个error属性，并规定如下三种状态：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;true，代表有错误，提示错误&lt;/li&gt;
&lt;li&gt;false，代表正确，提示正确&lt;/li&gt;
&lt;li&gt;normal，代表默认，显示默认值&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;于是我们可以在method下写一些方法来进行判断。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;checkUserId: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;msg&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (msg !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.post(&lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;+msg,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (data.success)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;].error = &lt;span class=&quot;string&quot;&gt;&quot;normal&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;checkUserPwd: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.passwd_confirm !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.passwd == &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.passwd_confirm &amp;amp;&amp;amp; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.passwd_confirm != &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; ? &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; : &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当然这个只是一个引入的功能，我们再聚合一下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;check: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;msg,i&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; index = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo[msg] != &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; ? &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[index].effect = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; : &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[index].effect = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;switch&lt;/span&gt; (msg)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;username&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.checkUserId(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo[msg]);                                      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;passwd&quot;&lt;/span&gt;:                                                                 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.passwd !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; ? &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; : &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].error = &lt;span class=&quot;string&quot;&gt;&quot;normal&quot;&lt;/span&gt;;       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.checkUserPwd();                                                       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;                                                                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;passwd_confirm&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.checkUserPwd();                                                       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;gwno&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.gwno !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; ? &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; : &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;].error = &lt;span class=&quot;string&quot;&gt;&quot;normal&quot;&lt;/span&gt;;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;gwpwd&quot;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo.gwno !== &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; ? &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; : &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;].error = &lt;span class=&quot;string&quot;&gt;&quot;normal&quot;&lt;/span&gt;;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样通过一个check的method我们就可以将整个表单的验证的方法容纳进来了。（此处对于校园网账号的验证会放到提交表单的函数中）。为了能在视图中体现正确、错误、正常的不同形态，我们需要对前端的一些结构进行一些修改。我们需要给main下的每个条例加入错误信息，也即errorInfo。&lt;/p&gt;
&lt;p&gt;所以至此整个main的结构是这样：&lt;/p&gt;
&lt;figure class=&quot;highlight avrasm&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;label&quot;&gt;main:&lt;/span&gt; [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;info&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;error&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;errorInfo&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后我们需要加入提交验证的部分：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;submitReg: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; flag = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 用于判断表单是否都是正确的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main.map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;obj&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    obj.error == &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; ? flag += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; : flag +=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (flag == &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.$http.post(&lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt;,&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.userInfo)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;res&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (res.success)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        swiper.slideNext(&lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 验证正确就可以进入下一页&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.main[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;].error = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将视图部分修改如下：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;user-info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item in main&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;position: relative;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 绑定blur事件 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;input&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;blur&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;check(item.name,$index)&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;effect&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;&amp;#123;&amp;#123;item.type&amp;#125;&amp;#125;&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;userInfo[item.name]&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 根据error类型切换不同的标签显示 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 此处用到了v-show的方法 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-show&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item.error == &#39;normal&#39;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&amp;#123;item.info&amp;#125;&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;color: red;&quot;&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-show&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item.error == true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&amp;#123;item.errorInfo&amp;#125;&amp;#125;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;v-show&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;item.error == false&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&amp;#123;item.info&amp;#125;&amp;#125;√&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;focus-border cube&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 点击下一步的同时提交表单信息 --&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attribute&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;#&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt; @&lt;span class=&quot;attribute&quot;&gt;click&lt;/span&gt;=&lt;span class=&quot;value&quot;&gt;&quot;submitReg&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;下一步&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;title&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至此，整个注册页的布局和功能性的部分都已经做完了。不过这只是一块比较简单的部分，我们用到了vuejs的的v-for进行列表渲染，用到了v-model进行数据的双向绑定，用到了method进行一些数据的处理，用到了v-show进行条件显示，一个基本的页面下我们已经能尝试这么多vue的特性了。而相比于jquery的dom操作，我觉得vue在此处最好的地方在于，表单的提交很方便。由于双向绑定了数据，只需要后台把数据格式规定好给我，我按照后端的数据结构整理一下我前端的数据结构然后就可以直接提交给后端了。而且省去了很多dom操作的地方。&lt;/p&gt;
&lt;p&gt;不过除了vue的部分，我还想来说说两个东西，跟css有关：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;全屏背景&lt;/li&gt;
&lt;li&gt;输入框文字提升效果，并涉及到移动端动画效果的处理&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;全屏背景&quot;&gt;全屏背景&lt;/h4&gt;&lt;p&gt;不仅仅是简单的&lt;code&gt;background-size: cover&lt;/code&gt;那么简单了，还需要进行小小的处理。先说说我希望实现的效果吧。我希望的效果是整个背景能够填充整个页面，并且在页面元素上下滚动的情况下，背景固定而不随着元素滚动。&lt;/p&gt;
&lt;p&gt;放到往常我可能会这么写：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;body&lt;/span&gt;,&lt;span class=&quot;tag&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;height&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;100%&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;url&lt;/span&gt;(bg.png) center &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; no-repeat&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background-size&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; cover&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;但是这样的话在移动端会出现比较严重的后果，那就是一旦页面元素的高度大于整个页面后，滚动页面元素的时候，背景也会随之而动。而且背景会被撑开。这不是我所希望的。&lt;/p&gt;
&lt;p&gt;这里用到一个小技巧，用上&lt;code&gt;:before&lt;/code&gt;的方法。&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;pseudo&quot;&gt;:before&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;position&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; fixed&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;z-index&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; -&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;top&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;right&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;bottom&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;left&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;url&lt;/span&gt;(bg.png) center &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; no-repeat&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;background-size&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; cover&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个用上before的伪元素的方法是一个很有奇效的小技巧。大家不妨可以试试。这样的话在移动端也能完美实现背景固定而且显示全屏。&lt;/p&gt;
&lt;h4 id=&quot;移动端动画简单初探&quot;&gt;移动端动画简单初探&lt;/h4&gt;&lt;p&gt;在做PC端的web的动画效果的时候，由于PC端的性能足够，所以在写一些效果的时候往往没有考虑到性能的问题。这次在开发的时候就遇到了动画效果实现上不小的问题。大家先来看看这两个动画的比较：上面一个动画和下面一个动画：&lt;/p&gt;
&lt;p&gt;第一个：&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p data-height=&quot;550&quot; data-theme-id=&quot;dark&quot; data-slug-hash=&quot;zBGrxx&quot; data-default-tab=&quot;result&quot; data-user=&quot;molunerfinn&quot; data-embed-version=&quot;2&quot; data-preview=&quot;true&quot; class=&quot;codepen&quot;&gt;See the Pen &lt;a href=&quot;http://codepen.io/molunerfinn/pen/zBGrxx/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;transform effect&lt;/a&gt; by molunerfinn (&lt;a href=&quot;http://codepen.io/molunerfinn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@molunerfinn&lt;/a&gt;) on &lt;a href=&quot;http://codepen.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;script async src=&quot;//assets.codepen.io/assets/embed/ei.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;第二个：&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;&lt;p data-height=&quot;551&quot; data-theme-id=&quot;dark&quot; data-slug-hash=&quot;oLXjKz&quot; data-default-tab=&quot;result&quot; data-user=&quot;molunerfinn&quot; data-embed-version=&quot;2&quot; data-preview=&quot;true&quot; class=&quot;codepen&quot;&gt;See the Pen &lt;a href=&quot;http://codepen.io/molunerfinn/pen/oLXjKz/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;repaint effect&lt;/a&gt; by molunerfinn (&lt;a href=&quot;http://codepen.io/molunerfinn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@molunerfinn&lt;/a&gt;) on &lt;a href=&quot;http://codepen.io&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
&lt;script async src=&quot;//assets.codepen.io/assets/embed/ei.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;你会发现这两个东西的效果相差甚大。实际上，二者实现的最终效果是一致的，都是让小球按一条口型路线运动。但是为何显示上来说，第一个这么流畅，而第二个有明显卡顿呢？&lt;/p&gt;
&lt;p&gt;这里涉及到很多东西，不光光是重绘（repaint），还有软硬件性能上面的问题。感兴趣的话可以参考这些文章：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://alexorz.github.io/animation-performance-guide/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Web动画性能指南&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.qianduan.net/high-performance-css3-animations/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;高性能CSS3动画&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://zencode.in/14.CSS%E5%8A%A8%E7%94%BB%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CSS动画的性能优化&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在移动端上的效果如果没有优化的话，实际上大致就是第二种的效果——让人看起来有所卡顿。简单来说，在移动端，有些效果是由浏览器来渲染的——那么这些效果如果比较复杂，而移动端的浏览器性能又不太足够的情况下，效果就比较卡顿。有些效果可以由GPU来渲染，那么这些效果渲染起来就相对来说比较流畅。而我们还可以人为触发GPU硬件渲染，通过 &lt;code&gt;transform&lt;/code&gt;的&lt;code&gt;translate3d&lt;/code&gt;属性就能实现硬件渲染从而俗称硬件加速。  &lt;/p&gt;
&lt;p&gt;举个简单例子。如果让一个元素从(0,0)-&amp;gt;(100px，0)，正常思路是&lt;code&gt;left: 0&lt;/code&gt;-&amp;gt;&lt;code&gt;left: 100px&lt;/code&gt;，然后再用&lt;code&gt;transition&lt;/code&gt;属性进行过渡。不过这样的话在移动端上效果就很感人，因为涉及到性能问题。但是如果我们用另外一种方式: &lt;code&gt;transform: translate3d(100px,0,0)&lt;/code&gt;的话，就可以让这个动画效果由GPU去渲染，那么这样的话，在移动端的效果也是完全可以接受的流畅。&lt;/p&gt;
&lt;p&gt;实际上，能够触发GPU渲染的动作有&lt;code&gt;opacity,transform,transition,animation&lt;/code&gt;等等。但是像&lt;code&gt;top,left,color,size&lt;/code&gt;等属性的变化则不会触发GPU渲染。  &lt;/p&gt;
&lt;p&gt;本文中描述的实例，是当焦点集中到input框的时候，文本上移并且有颜色变化。本来想实现的是文本大小还有变化。但是由于上面说的情况，涉及到size变化的时候，效果就会大打折扣。无奈之下我只能砍掉这个效果了。而实现文本上移实际上就是采用了transform的translate3d的方式，将其往上移动，并配合transition进行了一下过渡处理罢了。&lt;/p&gt;
&lt;p&gt;具体的CSS实现大致如下：&lt;/p&gt;
&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;pseudo&quot;&gt;:focus&lt;/span&gt; ~ &lt;span class=&quot;tag&quot;&gt;label&lt;/span&gt;,&lt;span class=&quot;class&quot;&gt;.trans&lt;/span&gt; &lt;span class=&quot;rules&quot;&gt;&amp;#123;                                                                 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;color&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;hexcolor&quot;&gt;#fff&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;                                                                                 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;transition&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;number&quot;&gt;0.3s&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;;                                                                            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-webkit-transform&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;translate3d&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;                                                 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-moz-transform&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;translate3d&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;                                                    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;-ms-transform&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;translate3d&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;                                                     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;rule&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;transform&lt;/span&gt;:&lt;span class=&quot;value&quot;&gt; &lt;span class=&quot;function&quot;&gt;translate3d&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, -&lt;span class=&quot;number&quot;&gt;20px&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;;                                                         &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实际上也不难不是么？&lt;/p&gt;
&lt;h3 id=&quot;关注版面页的实现&quot;&gt;关注版面页的实现&lt;/h3&gt;&lt;p&gt;实际上从注册页的实现中已经可以瞅见关注版面页实现的方法了。实际上关注版面页不过也是列表的渲染，在数据里定义好相应的属性就行了。然后用一个&lt;code&gt;picked&lt;/code&gt;的属性来看看是否被选中即可。最后完成注册的时候，将所有选中的列表组装成相应的数组提交到后台就行了。因为注册页里这些方法已经说过了，所以就不再赘述了。&lt;/p&gt;
&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;&lt;p&gt;简单总结一下，这次移动端的开发中学习到的东西。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vuejs的简单使用，从DOM操作-&amp;gt;数据绑定&lt;/li&gt;
&lt;li&gt;全屏背景的实现&lt;/li&gt;
&lt;li&gt;流畅动画效果的实现&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实际上，兼容性方面还有不少的东西需要诉说，不过限制于篇幅以及本文的主要内容并不是在纠结移动端的兼容性的所以并没有在兼容性方面进行记录。  &lt;/p&gt;
&lt;p&gt;在排版上我还是没有用上比较流行的flex，对于Vue还没有使用组件化开发的思路。这些都是需要改进的部分。不过这次的开发过程中经过美工的指点，将我之前写页面的时候注意不到的很多细节部分，比如线条尺寸，元素间隔，颜色搭配等东西给指了出来，这些东西都不是简简单单就实现的。总之，有时间的话，我想我可以将设计方面的知识融入到我的前端开发中，想必能让我的作品更加地符合审美和用户的体验吧~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DEMO的github地址在&lt;a href=&quot;https://github.com/Molunerfinn/vue-mobile-learning-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这段时间在做的东西，是北邮人论坛APP的注册页。这个注册页是内嵌的网页，因为打算安卓和IOS平台同时使用。因此实际上就是在做移动端的web开发了。&lt;br&gt;在这过程中遇到了不少有意思的东西。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DEMO的github地址在&lt;a href=&quot;https://github.com/Molunerfinn/vue-mobile-learning-demo&quot;&gt;这里&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>一些杂碎的笔记整理 | JS、Linux、Sublime相关</title>
    <link href="https://molunerfinn.com/something&nothing/"/>
    <id>https://molunerfinn.com/something&nothing/</id>
    <published>2016-05-29T07:30:00.000Z</published>
    <updated>2016-05-29T08:58:37.000Z</updated>
    
    <content type="html">&lt;p&gt;最近一直没有能够找到一段相对空余的时间来写东西。实际上这段时间也没有闲着，不过记着笔记始终没有发成博客也确实是我越发地懒了。&lt;br&gt;话不多说，本次的杂碎笔记整理包括的内容是JS、Linux相关的一些琐碎的点。纯粹是笔记的整理，感觉并不是很好的一篇学习教程。我尽量写得通俗易懂点。  &lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;JS相关&quot;&gt;JS相关&lt;/h2&gt;&lt;p&gt;首先是个老生常谈但是却又是个很有效的办法：&lt;/p&gt;
&lt;h3 id=&quot;从JS异步回调函数中取值的解决办法&quot;&gt;从JS异步回调函数中取值的解决办法&lt;/h3&gt;&lt;h4 id=&quot;问题描述&quot;&gt;问题描述&lt;/h4&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;load_val&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  $.get(&lt;span class=&quot;string&quot;&gt;&quot;url&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 如何把这里取到的data通过load_val函数返回出去？&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果通过一个全局变量来获取，自然也不是不可以。不过这里就涉及到一点：用全局变量获取后，该怎么使用呢？&lt;br&gt;为什么会有这问题，还是上面这个例子，我们稍微改造一下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; obj = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;load_val&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  $.get(&lt;span class=&quot;string&quot;&gt;&quot;url&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    obj = data; &lt;span class=&quot;comment&quot;&gt;// 此处将data赋予全局变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;load_val();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;use_val&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  obj += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;use_val();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面这个例子很好理解，我们想通过&lt;code&gt;obj&lt;/code&gt;这个全局变量获取ajax异步过来的&lt;code&gt;data&lt;/code&gt;数据，然后在&lt;code&gt;use_val&lt;/code&gt;这个函数中使用&lt;code&gt;obj&lt;/code&gt;这个变量。看似没问题，实际上问题很严重：&lt;br&gt;在&lt;code&gt;use_val()&lt;/code&gt;中的&lt;code&gt;obj&lt;/code&gt;真的是&lt;code&gt;data&lt;/code&gt;的值么？不是的。而是&lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;。为什么，因为就这段代码而言，&lt;code&gt;obj = data&lt;/code&gt;是在&lt;code&gt;use_val()&lt;/code&gt;执行完才在异步回调函数内实现的。在此之前，&lt;code&gt;obj&lt;/code&gt;一直是&lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;。于是又有人说，那我写个延时函数，等待&lt;code&gt;obj = data&lt;/code&gt;后再执行呗。那样就太不优雅了。那么该如何解决呢？&lt;/p&gt;
&lt;h4 id=&quot;问题解决&quot;&gt;问题解决&lt;/h4&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;load_val&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;comment&quot;&gt;//定义一个回调函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  $.get(&lt;span class=&quot;string&quot;&gt;&#39;url&#39;&lt;/span&gt; , &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    callback(data); &lt;span class=&quot;comment&quot;&gt;//将返回结果当作参数返回&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;load_val(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  obj = data; &lt;span class=&quot;comment&quot;&gt;//这里可以得到值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  use_val();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;use_val&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  obj += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也就是在所需要调用的回调函数外加一个函数，这个函数包含一个参数，该参数是个函数，然而这个函数有着依赖于回调函数给出的值的参数。所以经过这两层，就能将原本回调函数里的值给取出来。&lt;/p&gt;
&lt;p&gt;关于js的异步编程，可以参考阮一峰老师的：&lt;a href=&quot;http://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Javascript异步编程的4种方法&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&quot;JS中的鼠标滚轮值的获取&quot;&gt;JS中的鼠标滚轮值的获取&lt;/h3&gt;&lt;p&gt;在大多数浏览器（IE6, IE7, IE8, Opera 10+, Safari 5+, Chrome）中，都提供了鼠标滚轮事件叫做：&lt;code&gt;mousewheel&lt;/code&gt;。然而Firefox3.5+不支持这个事件。今天我们先说说非Firefox的情况。&lt;/p&gt;
&lt;p&gt;在不考虑火狐浏览器的情况下：&lt;/p&gt;
&lt;p&gt;mousewheel事件中，event.wheelDelta的返回值，如果是正值说明是滚轮向上滚动，反之则说明是向下滚动。尤其需要注意，返回值均为120的倍数。即鼠标滚轮真正滚动幅度=返回值/120。&lt;/p&gt;
&lt;p&gt;经过测试，用较新的jquery的情况下，要获取wheelDelta的值需要用以下的办法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(object).on(&lt;span class=&quot;string&quot;&gt;&quot;mousewheel&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; delta =  e.originalEvent.wheelDelta;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中那个&lt;code&gt;object&lt;/code&gt;是你要指定的滚动的元素对象。&lt;br&gt;同时，为了防止浏览器默认滚动条滚动，还必须做到阻止默认事件。简单来说就是：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(object).on(&lt;span class=&quot;string&quot;&gt;&quot;mousewheel&quot;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; delta =  e.originalEvent.wheelDelta;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  event.preventDefault();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Linux相关&quot;&gt;Linux相关&lt;/h2&gt;&lt;h3 id=&quot;Oh-My-Zsh&quot;&gt;Oh-My-Zsh&lt;/h3&gt;&lt;p&gt;Linux默认的shell环境是bash。bash环境实际上已经挺不错的了。但是其实你还可以有更好的一个选择：zsh并与之配对的Oh-My-Zsh。首先zsh也是个shell环境，与bash不一样的地方在于zsh的默认配置比较复杂，因此在很长一段时间内它因为配置复杂的原因让它一直没能够受到大家的青睐。而自从&lt;a href=&quot;http://ohmyz.sh/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Oh-My-Zsh&lt;/a&gt;诞生以来，真是能够惊叹：原来我的终端也能如此的棒。&lt;br&gt;Oh-My-Zsh是一个开源项目，它重新改变了zsh默认配置复杂的概念，它简化了zsh配置的难度，并且加入很多实用的插件，漂亮的主题，让单调的终端的变得更加富有活力。&lt;/p&gt;
&lt;p&gt;安装的方法很简单，官网已经给出了，一行代码就能安装完毕。&lt;/p&gt;
&lt;p&gt;Oh-My-Zsh的配置文件是在&lt;code&gt;~/.zshrc&lt;/code&gt;中。我们需要更改的主题、配置的插件也都在里面可以修改。&lt;/p&gt;
&lt;p&gt;其中&lt;code&gt;ZSH_THEME&lt;/code&gt;是主题文件的修改地方，&lt;code&gt;plugins=()&lt;/code&gt;是启用插件的地方。&lt;/p&gt;
&lt;p&gt;我说说我使用的插件：&lt;/p&gt;
&lt;h4 id=&quot;z&quot;&gt;z&lt;/h4&gt;&lt;p&gt;这个插件比起市面上经常提起的&lt;code&gt;autojump&lt;/code&gt;我觉得更方便——因为是Oh-My-Zsh自带的，不需要安装只需要在&lt;code&gt;plugins()&lt;/code&gt;里添加一个字&lt;code&gt;z&lt;/code&gt;就行了。而且效果是一样的。自从用了这个插件，我觉得我已经离不开Oh-My-Zsh了。这个插件有什么用呢？它是一个快速跳转目录的插件。具体来说，它能够记录下你曾经进过的任何目录，比如我在开启了z之后：&lt;br&gt;&lt;code&gt;cd /usr/local/bin&lt;/code&gt;，然后下一次我需要进入&lt;code&gt;/usr/local/bin&lt;/code&gt;的话，我只需要&lt;code&gt;z bin&lt;/code&gt;然后回车就行了。那如果有同名的文件夹呢？没关系，在按回车之前按下tab就能自动补全路径让你看到进入的是哪个bin文件夹。它能够记录下你进入文件夹的次数由此来排序出优先级。如果你想看优先级，只需要按一下&lt;code&gt;z&lt;/code&gt;回车就行，就能看到你之前进入过的文件夹并且按照进入次数排好序了。&lt;/p&gt;
&lt;h4 id=&quot;gitfast&quot;&gt;gitfast&lt;/h4&gt;&lt;p&gt;Oh-My-Zsh默认开启了&lt;code&gt;git&lt;/code&gt;插件，它有些很好的简写比如&lt;code&gt;gco&lt;/code&gt;代表了&lt;code&gt;git chekout&lt;/code&gt;，然而这还不够，&lt;code&gt;gitfast&lt;/code&gt;是另外必须开启的。否则你在切换分支的时候，按tab补全的时候会变得特别特别慢。加上这个&lt;code&gt;gitfast&lt;/code&gt;插件就能解决git在补全的时候卡顿严重的问题。&lt;/p&gt;
&lt;p&gt;另外我使用的主题是&lt;a href=&quot;http://blog.ysmood.org/my-ys-terminal-theme/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ys&lt;/a&gt;。更多的主题可以参考&lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh/wiki/Themes&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id=&quot;Linux_Screen命令下_vim中文乱码的解决办法&quot;&gt;Linux Screen命令下 vim中文乱码的解决办法&lt;/h3&gt;&lt;p&gt;此处首先是终端软件的编码已经是UTF-8，然后正常情况下VIM的中文显示正常，而Screen下才显示不正常的时候采用的办法。&lt;/p&gt;
&lt;h4 id=&quot;screen配置文件设置&quot;&gt;screen配置文件设置&lt;/h4&gt;&lt;p&gt;解决办法：在 ~/.screenrc 里加入如下设置: &lt;/p&gt;
&lt;figure class=&quot;highlight applescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;defutf8 &lt;span class=&quot;function_start&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;on&lt;/span&gt;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;defencoding utf8 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;encoding UTF-&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; UTF-&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;进入screen的命令需要一点更改：&quot;&gt;进入screen的命令需要一点更改：&lt;/h4&gt;&lt;p&gt;screen -r 重新进去screen的时候，又会产生乱码。&lt;br&gt;解决办法：&lt;br&gt;在进入screen的时候加上 -U 参数， screen -U -r xxx&lt;br&gt;则能正确显示。&lt;/p&gt;
&lt;h3 id=&quot;Sublime相关&quot;&gt;Sublime相关&lt;/h3&gt;&lt;h4 id=&quot;sublimecodeintel插件自动补全的问题&quot;&gt;sublimecodeintel插件自动补全的问题&lt;/h4&gt;&lt;p&gt;按&lt;code&gt;;&lt;/code&gt;键会出现自动补全的提示，如何取消呢？&lt;/p&gt;
&lt;p&gt;在WIN下可以这么实现：&lt;/p&gt;
&lt;p&gt;sublime的’key bindings - user’里加入：&lt;br&gt;&lt;code&gt;{ &amp;quot;keys&amp;quot;: [&amp;quot;;&amp;quot;], &amp;quot;command&amp;quot;: &amp;quot;run_macro_file&amp;quot;, &amp;quot;args&amp;quot;: {&amp;quot;file&amp;quot;: &amp;quot;Packages/User/unAutoSemiColon.sublime-macro&amp;quot;} }&lt;/code&gt;&lt;br&gt;然后打开sublime的&lt;code&gt;preferences-&amp;gt;browser packages&lt;/code&gt;,然后进入User文件夹，新建一个文件叫做&lt;code&gt;unAutoSemiColon.sublime-macro&lt;/code&gt;，然后输入如下内容：&lt;br&gt;&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&quot;&lt;span class=&quot;attribute&quot;&gt;args&lt;/span&gt;&quot;:&lt;span class=&quot;value&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&quot;&lt;span class=&quot;attribute&quot;&gt;characters&lt;/span&gt;&quot;: &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#125;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&quot;&lt;span class=&quot;attribute&quot;&gt;command&lt;/span&gt;&quot;: &lt;span class=&quot;value&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;insert&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&amp;#125;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然后保存退出。重启sublime。就行了。实际上这里是借助了sublime的宏指令实现的一种办法。&lt;/p&gt;
&lt;p&gt;MAC平台下的解决办法可以看这里：&lt;a href=&quot;https://github.com/SublimeCodeIntel/SublimeCodeIntel/issues/461&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/SublimeCodeIntel/SublimeCodeIntel/issues/461&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;绑定快捷键快速开启chrome&quot;&gt;绑定快捷键快速开启chrome&lt;/h4&gt;&lt;p&gt;WIN下是这样：&lt;/p&gt;
&lt;p&gt;在&lt;code&gt;Preferences&lt;/code&gt;-&amp;gt;&lt;code&gt;Key Bindings&lt;/code&gt;-&amp;gt;&lt;code&gt;User&lt;/code&gt;下，复制以下代码能够按&lt;code&gt;F1&lt;/code&gt;打开Chrome。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;keys&quot;&lt;/span&gt;: [&lt;span class=&quot;string&quot;&gt;&quot;f1&quot;&lt;/span&gt;], &lt;span class=&quot;string&quot;&gt;&quot;command&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;side_bar_files_open_with&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;string&quot;&gt;&quot;args&quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;paths&quot;&lt;/span&gt;: [],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;application&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;C:/Program Files (x86)/Google/Chrome/Application/chrome.exe&quot;&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// 这里的chrome路径需要自己确认。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;string&quot;&gt;&quot;extensions&quot;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&quot;.*&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;MAC下也基本一样。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近一直没有能够找到一段相对空余的时间来写东西。实际上这段时间也没有闲着，不过记着笔记始终没有发成博客也确实是我越发地懒了。&lt;br&gt;话不多说，本次的杂碎笔记整理包括的内容是JS、Linux相关的一些琐碎的点。纯粹是笔记的整理，感觉并不是很好的一篇学习教程。我尽量写得通俗易懂点。  &lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="Nodejs" scheme="https://molunerfinn.com/tags/Nodejs/"/>
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs学习日志（三）——Express+jade+stylus+mongodb搭建简单应用（下）</title>
    <link href="https://molunerfinn.com/nodejs-3/"/>
    <id>https://molunerfinn.com/nodejs-3/</id>
    <published>2016-04-10T07:52:00.000Z</published>
    <updated>2016-04-10T07:53:00.000Z</updated>
    
    <content type="html">&lt;p&gt;前段时间，把之前用Nodejs做的爬虫程序（参看之前的&lt;a href=&quot;http://molunerfinn.com/nodejs-1/&quot;&gt;cheerio爬虫&lt;/a&gt;)，整合了一下。采用Nodejs市面上最普遍最常见的Express框架，简易地做了一个北邮人论坛每日十大的记录，暂且叫为&lt;a href=&quot;http://topten.piegg.cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;论坛日报&lt;/a&gt;。在应用框架的过程中，我发现绝大部分的教程，还仅是在教你用Express写个简单的&lt;code&gt;Hello World&lt;/code&gt;，然后就没有然后了。或者就是写多人博客，但是在一些关键的地方如数据的录入，读取等地方却没有详尽的描述。导致我在这个项目一开始真的是寸步难行。有数据但是不知道怎么写进数据库，怎么读出来-&amp;gt;渲染到前端。  &lt;/p&gt;
&lt;p&gt;这篇文章算是我自己做项目的切身体会，能够了解到Express基本使用、路由基本使用、数据写入读出、模板引擎渲染等等。希望能够帮上想要用Nodejs、Express做些简单应用的小伙伴们吧。  &lt;/p&gt;
&lt;p&gt;上一篇&lt;a href=&quot;http://molunerfinn.com/nodejs-2/&quot;&gt;文章&lt;/a&gt;已经讲到了将mongodb开启以及我们输出了第一个页面了，从后台向前台render了数据并渲染。这次我们讲讲如何从mongodb里取数据、写数据并输出前端。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;mongodb的简单使用&quot;&gt;mongodb的简单使用&lt;/h3&gt;&lt;p&gt;在之前安装的mongodb的bin的目录下，打开命令行。如果是Windows输入&lt;code&gt;mongo&lt;/code&gt;回车，如果是linux输入&lt;code&gt;./mongo&lt;/code&gt;，就能进入mongodb的命令行界面。（前提是你开启了mongodb的服务）。&lt;/p&gt;
&lt;p&gt;一般来说会有提示&lt;code&gt;connecting to: test&lt;/code&gt;。&lt;code&gt;mongodb&lt;/code&gt;默认是没有设置用户名和密码，这需要你手动设置。本文就不对这方面进行赘述。&lt;br&gt;我们新建一个库。输入&lt;code&gt;use test&lt;/code&gt;，就会切换到叫做&lt;code&gt;test&lt;/code&gt;的数据库中。这个数据库在我们没有写入数据的时候，仅仅是被创建但是并未真正生成，如果没有写入数据，我们退出mongodb的话这个数据库就会自动销毁。接着我们写入第一个数据，让它真正创建。尤其开心的是，mongodb的数据存储采用的是&lt;code&gt;json&lt;/code&gt;的格式，也就是很方便的能够进行构建和解析。&lt;/p&gt;
&lt;p&gt;输入&lt;code&gt;db.nodetest.insert({&amp;quot;name&amp;quot;:&amp;quot;Jack&amp;quot;,&amp;quot;age&amp;quot;:&amp;quot;16&amp;quot;,&amp;quot;sex&amp;quot;:&amp;quot;man&amp;quot;})&lt;/code&gt;。这句话的意思是，在&lt;code&gt;test&lt;/code&gt;这个数据库中，创建一个叫做&lt;code&gt;nodetest&lt;/code&gt;的数据库表或者叫集合（&lt;code&gt;collection&lt;/code&gt;)并插入一个数据。  &lt;/p&gt;
&lt;p&gt;要查看我们插入的这个数据，只需要输入&lt;code&gt;db.nodetest.find()&lt;/code&gt;就能够输出结果了。&lt;/p&gt;
&lt;p&gt;这就是最简单的mongodb的操作。&lt;/p&gt;
&lt;h3 id=&quot;express与mongodb的对接&quot;&gt;express与mongodb的对接&lt;/h3&gt;&lt;p&gt;要将express与mongodb对接，需要在&lt;code&gt;app.js&lt;/code&gt;这个文件里加入依赖。依赖包我们在上一篇文章里已经安装了。这次是写到&lt;code&gt;app.js&lt;/code&gt;里。&lt;br&gt;你可以看到开头有这么几句代码：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; express = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; path = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; favicon = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;serve-favicon&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;morgan&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cookieParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cookie-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; bodyParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;body-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们在这段代码后面加上几句，使它变成这样：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; express = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; path = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; favicon = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;serve-favicon&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;morgan&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cookieParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cookie-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; bodyParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;body-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mongo = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;mongodb&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; monk = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;monk&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; db = monk(&lt;span class=&quot;string&quot;&gt;&#39;localhost:27017/test&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这样就能够引入依赖了。但是我们还需要将&lt;code&gt;db&lt;/code&gt;引入我们的路由中。&lt;/p&gt;
&lt;p&gt;你能够看到两句代码：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;,routes);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;string&quot;&gt;&#39;/users&#39;&lt;/span&gt;, users);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们在这两句话的上方加上一段代码：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req,res,next&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  req.db = db;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;注意：如果没有把这句话放到&lt;code&gt;app.use(&amp;#39;/&amp;#39;,routes);&lt;/code&gt;上方，那么数据库将无法工作！&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;到此，整个&lt;code&gt;app.js&lt;/code&gt;应该长这样：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; express = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;express&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; path = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;path&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; favicon = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;serve-favicon&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; logger = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;morgan&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cookieParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cookie-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; bodyParser = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;body-parser&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mongo = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;mongodb&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; monk = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;monk&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; db = monk(&lt;span class=&quot;string&quot;&gt;&#39;localhost:27017/test&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; routes = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./routes/index&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; users = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;./routes/users&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; app = express();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// view engine setup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.set(&lt;span class=&quot;string&quot;&gt;&#39;views&#39;&lt;/span&gt;, path.join(__dirname, &lt;span class=&quot;string&quot;&gt;&#39;views&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.set(&lt;span class=&quot;string&quot;&gt;&#39;view engine&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;jade&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// uncomment after placing your favicon in /public&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//app.use(favicon(path.join(__dirname, &#39;public&#39;, &#39;favicon.ico&#39;)));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(logger(&lt;span class=&quot;string&quot;&gt;&#39;dev&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(bodyParser.json());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(bodyParser.urlencoded(&amp;#123; extended: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt; &amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(cookieParser());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(express.static(path.join(__dirname, &lt;span class=&quot;string&quot;&gt;&#39;public&#39;&lt;/span&gt;)));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req,res,next&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  req.db = db;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;, routes);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;string&quot;&gt;&#39;/users&#39;&lt;/span&gt;, users);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// catch 404 and forward to error handler&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res, next&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; err = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Error&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;Not Found&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  err.status = &lt;span class=&quot;number&quot;&gt;404&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  next(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// error handlers&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// development error handler&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// will print stacktrace&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (app.get(&lt;span class=&quot;string&quot;&gt;&#39;env&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;development&#39;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, req, res, next&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.status(err.status || &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.render(&lt;span class=&quot;string&quot;&gt;&#39;error&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      message: err.message,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      error: err&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// production error handler&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// no stacktraces leaked to user&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.use(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, req, res, next&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  res.status(err.status || &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  res.render(&lt;span class=&quot;string&quot;&gt;&#39;error&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    message: err.message,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    error: &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = app;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;从mongodb中读取数据并渲染到前端&quot;&gt;从mongodb中读取数据并渲染到前端&lt;/h3&gt;&lt;p&gt;在&lt;code&gt;routes&lt;/code&gt;文件夹下找到&lt;code&gt;index.js&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;module.exports = router&lt;/code&gt;这句话的上方写入如下信息：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;router.get(&lt;span class=&quot;string&quot;&gt;&#39;/users&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; db = req.db;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; user = db.get(&lt;span class=&quot;string&quot;&gt;&#39;nodetest&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  user.find(&amp;#123;&amp;#125;,&amp;#123;&amp;#125;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;e,docs&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.render(&lt;span class=&quot;string&quot;&gt;&#39;users&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;string&quot;&gt;&quot;users&quot;&lt;/span&gt; : docs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解释一下，我们之前创建了一个叫做&lt;code&gt;nodetest&lt;/code&gt;的数据表，我们通过&lt;code&gt;db.get()&lt;/code&gt;方式将其取出。但是这样的话不能直接用，必须通过调用&lt;code&gt;.find()&lt;/code&gt;方法中的回调函数里的第二个参数&lt;code&gt;docs&lt;/code&gt;——这个参数才是真正取出来的&lt;code&gt;json&lt;/code&gt;数据，才是我们要用到输出到前端的数据。&lt;/p&gt;
&lt;p&gt;然后我们到&lt;code&gt;view&lt;/code&gt;文件夹下创建一个叫做&lt;code&gt;users.jade&lt;/code&gt;的文件。注意，这里的&lt;code&gt;users&lt;/code&gt;就是对应着路由文件里的&lt;code&gt;.get(&amp;#39;/users&amp;#39;, *** )&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;然后我们往jade文件里输入东西：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;extends layout&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  h1.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    User List&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ul&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    each user, i in users&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      li&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        span= user.name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        span= user.age&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        span= user.sex&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里我们用到了一个很关键的东西，注意这句话：&lt;br&gt;&lt;code&gt;each user, i in users&lt;/code&gt;，这里的&lt;code&gt;user&lt;/code&gt;是自己定义的数组元素名，i是这个元素在&lt;code&gt;users&lt;/code&gt;这个表中的位置。而&lt;code&gt;user&lt;/code&gt;可以随便自己改，但是&lt;code&gt;users&lt;/code&gt;却是对应着我们之前在路由文件中render的数据名：&lt;code&gt;&amp;quot;users&amp;quot; : docs&lt;/code&gt;，这个是不能随便改的，要改的话需要路由文件也更改，jade里面也更改才可以。&lt;/p&gt;
&lt;p&gt;而&lt;code&gt;user.name&lt;/code&gt;很明显就是取出了我们之前存在里面的数据。在这里应该是取出为&lt;code&gt;Jack&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;至此我们已经从&lt;code&gt;mongodb&lt;/code&gt;中读出了数据。下一节是讲述如何从express往mongodb中写入数据。&lt;/p&gt;
&lt;h3 id=&quot;将数据写入mongodb中并渲染到前端&quot;&gt;将数据写入mongodb中并渲染到前端&lt;/h3&gt;&lt;p&gt;这里我们创建一个叫做&lt;code&gt;adduser.jade&lt;/code&gt;的前端页面来输入数据并提交到后台。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;extends layout&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  h1= title&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  form(name=&lt;span class=&quot;string&quot;&gt;&quot;adduser&quot;&lt;/span&gt;,method=&lt;span class=&quot;string&quot;&gt;&quot;post&quot;&lt;/span&gt;,action=&lt;span class=&quot;string&quot;&gt;&quot;/adduser&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    input(type=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;, placeholder=&lt;span class=&quot;string&quot;&gt;&quot;username&quot;&lt;/span&gt;, name=&lt;span class=&quot;string&quot;&gt;&quot;username&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    input(type=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;, placeholder=&lt;span class=&quot;string&quot;&gt;&quot;userage&quot;&lt;/span&gt;, name=&lt;span class=&quot;string&quot;&gt;&quot;userage&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    input(type=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;, placeholder=&lt;span class=&quot;string&quot;&gt;&quot;usersex&quot;&lt;/span&gt;, name=&lt;span class=&quot;string&quot;&gt;&quot;usersex&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    button(type=&lt;span class=&quot;string&quot;&gt;&quot;submit&quot;&lt;/span&gt;) submit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;仅有这个jade是不够的，因为express不知道它的提交会提交到哪。所以需要在router里写指定的方法并返回数据。&lt;/p&gt;
&lt;p&gt;继续在&lt;code&gt;index.js&lt;/code&gt;里写入如下的东西：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;router.post(&lt;span class=&quot;string&quot;&gt;&#39;/adduser&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; db = req.db;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; userName = req.body.username;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; userAge = req.body.userage;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; userSex = req.body.usersex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; user = db.get(&lt;span class=&quot;string&quot;&gt;&#39;nodetest&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  user.insert(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt; : userName,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;age&quot;&lt;/span&gt; : userAge,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;sex&quot;&lt;/span&gt; : userSex&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;err, doc&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        res.send(&lt;span class=&quot;string&quot;&gt;&quot;Error&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        res.redirect(&lt;span class=&quot;string&quot;&gt;&quot;users&quot;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 重定向到 /users&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;通过这个post的请求，我们将获取从adduser这个页面发送的提交信息。然后再将它组装后&lt;code&gt;insert&lt;/code&gt;到mongodb中。成功后再重定向（跳转）到&lt;code&gt;users&lt;/code&gt;这个页面，然后你就能看到刚刚输入的信息出现在&lt;code&gt;users&lt;/code&gt;这个页面了。&lt;/p&gt;
&lt;p&gt;整个前后都由js由自己掌控，是不是非常酷？&lt;/p&gt;
&lt;h3 id=&quot;结语&quot;&gt;结语&lt;/h3&gt;&lt;p&gt;作为一个前端开发人员，在nodejs诞生前，如果只会js你是无法在后端进行操作的。要做后台的处理，就必须依赖后端的语言例如php，python等等。如今，nodejs已经大面积渗透到前端的世界中，哪怕你只会用js也能前后都靠前端工程师来构建。本文就是采用了最简单的方式阐述了express最简单的前后交互。希望能给想用nodejs做开发的前端er一些启发~这毕竟也是作为我的nodejs学习日志，如果不出意外，每周都将更新新的干货。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;前段时间，把之前用Nodejs做的爬虫程序（参看之前的&lt;a href=&quot;http://molunerfinn.com/nodejs-1/&quot;&gt;cheerio爬虫&lt;/a&gt;)，整合了一下。采用Nodejs市面上最普遍最常见的Express框架，简易地做了一个北邮人论坛每日十大的记录，暂且叫为&lt;a href=&quot;http://topten.piegg.cn&quot;&gt;论坛日报&lt;/a&gt;。在应用框架的过程中，我发现绝大部分的教程，还仅是在教你用Express写个简单的&lt;code&gt;Hello World&lt;/code&gt;，然后就没有然后了。或者就是写多人博客，但是在一些关键的地方如数据的录入，读取等地方却没有详尽的描述。导致我在这个项目一开始真的是寸步难行。有数据但是不知道怎么写进数据库，怎么读出来-&amp;gt;渲染到前端。  &lt;/p&gt;
&lt;p&gt;这篇文章算是我自己做项目的切身体会，能够了解到Express基本使用、路由基本使用、数据写入读出、模板引擎渲染等等。希望能够帮上想要用Nodejs、Express做些简单应用的小伙伴们吧。  &lt;/p&gt;
&lt;p&gt;上一篇&lt;a href=&quot;http://molunerfinn.com/nodejs-2/&quot;&gt;文章&lt;/a&gt;已经讲到了将mongodb开启以及我们输出了第一个页面了，从后台向前台render了数据并渲染。这次我们讲讲如何从mongodb里取数据、写数据并输出前端。&lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
      <category term="Nodejs" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/Nodejs/"/>
    
    
      <category term="Nodejs" scheme="https://molunerfinn.com/tags/Nodejs/"/>
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs学习日志（二）——Express+jade+stylus+mongodb搭建简单应用（上）</title>
    <link href="https://molunerfinn.com/nodejs-2/"/>
    <id>https://molunerfinn.com/nodejs-2/</id>
    <published>2016-04-04T09:06:00.000Z</published>
    <updated>2016-04-07T10:28:39.662Z</updated>
    
    <content type="html">&lt;p&gt;前段时间，把之前用Nodejs做的爬虫程序（参看之前的&lt;a href=&quot;http://molunerfinn.com/nodejs-1/&quot;&gt;cheerio爬虫&lt;/a&gt;)，整合了一下。采用Nodejs市面上最普遍最常见的Express框架，简易地做了一个北邮人论坛每日十大的记录，暂且叫为&lt;a href=&quot;http://topten.piegg.cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;论坛日报&lt;/a&gt;。在应用框架的过程中，我发现绝大部分的教程，还仅是在教你用Express写个简单的&lt;code&gt;Hello World&lt;/code&gt;，然后就没有然后了。或者就是写多人博客，但是在一些关键的地方如数据的录入，读取等地方却没有详尽的描述。导致我在这个项目一开始真的是寸步难行。有数据但是不知道怎么写进数据库，怎么读出来-&amp;gt;渲染到前端。  &lt;/p&gt;
&lt;p&gt;这篇文章算是我自己做项目的切身体会，能够了解到Express基本使用、路由基本使用、数据写入读出、模板引擎渲染等等。希望能够帮上想要用Nodejs、Express做些简单应用的小伙伴们吧。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Express的安装和使用&quot;&gt;Express的安装和使用&lt;/h2&gt;&lt;p&gt;要做一个Express应用，首先要先下载、安装Express。在命令行界面下（WIN用CMD，MAC，LINUX就用终端就行），输入&lt;code&gt;npm install -g express-generator&lt;/code&gt;或者如果你装了cnpm也可以用&lt;code&gt;cnpm install -g express-generator&lt;/code&gt;（下同）。之所以不直接安装&lt;code&gt;express&lt;/code&gt;，是因为用&lt;code&gt;express-generator&lt;/code&gt;能够直接生成一个&lt;code&gt;express&lt;/code&gt;应用的骨架。  &lt;/p&gt;
&lt;p&gt;接着，在想要创建项目的地方，输入：&lt;code&gt;express test1&lt;/code&gt;（注：test1是随便取的项目名字），于是命令行就会出现大致是如下的结果：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;create : test1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/package.json&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/app.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/public&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/public/javascripts&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/public/images&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/public/stylesheets&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/public/stylesheets/style.css&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/routes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/routes/index.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/routes/users.js&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/views&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/views/index.jade&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/views/layout.jade&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/views/error.jade&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;create : test1/bin/www&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看，&lt;code&gt;express-generator&lt;/code&gt;就帮我们创建了一个基本的express应用的骨架。&lt;/p&gt;
&lt;p&gt;到项目根目录，也就是&lt;code&gt;package.json&lt;/code&gt;所在的目录，然后在命令行内输入&lt;code&gt;npm install&lt;/code&gt;或者&lt;code&gt;cnpm install&lt;/code&gt;安装依赖。&lt;/p&gt;
&lt;p&gt;然后在项目根目录下，输入&lt;code&gt;npm start&lt;/code&gt;，或者&lt;code&gt;node ./bin/www&lt;/code&gt;，就能启动express。在你的浏览器地址栏里输入&lt;code&gt;127.0.0.1:3000&lt;/code&gt;是不是就能看见效果了？&lt;/p&gt;
&lt;h2 id=&quot;来个Express版的HelloWorld&quot;&gt;来个Express版的HelloWorld&lt;/h2&gt;&lt;p&gt;作为一个程序、项目的起始，一个Helloworld，总是不可避免。那么我们也来写一个。很简单。首先找到routes目录下的&lt;code&gt;index.js&lt;/code&gt;，你能看见：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;router.get(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res, next&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  res.render(&lt;span class=&quot;string&quot;&gt;&#39;index&#39;&lt;/span&gt;, &amp;#123; title: &lt;span class=&quot;string&quot;&gt;&#39;Express&#39;&lt;/span&gt; &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们紧接这段话后面加上：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;router.get(&lt;span class=&quot;string&quot;&gt;&#39;/helloworld&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  res.render(&lt;span class=&quot;string&quot;&gt;&#39;helloworld&#39;&lt;/span&gt;, &amp;#123; title: &lt;span class=&quot;string&quot;&gt;&#39;Hello, World!&#39;&lt;/span&gt; &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;router.get是一个方法，用get方法收到来自&lt;code&gt;/helloworld&lt;/code&gt;的访问请求，然后在回调的函数里，用res.render()方法渲染所要的东西。render的第一个参数&lt;code&gt;helloworld&lt;/code&gt;对应的就是&lt;code&gt;/helloworld&lt;/code&gt;，意思是向&lt;code&gt;/helloworld&lt;/code&gt;这个地址渲染东西。而后面的&lt;code&gt;{ title: &amp;#39;Hello, World!&amp;#39; }&lt;/code&gt;是指渲染的数据。这在接下去的jade里面会用到。&lt;/p&gt;
&lt;p&gt;然后在根目录下找到views文件夹，进入，创建一个叫做&lt;code&gt;helloworld.jade&lt;/code&gt;的文件，打开，输入：&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;extends layout&amp;#10;&amp;#10;block content&amp;#10;    h1= title&amp;#10;    p Welcome to #&amp;#123;title&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后回到根目录，输入&lt;code&gt;npm start&lt;/code&gt;，或者&lt;code&gt;node ./bin/www&lt;/code&gt;，启动express。在你的浏览器地址栏里输入&lt;code&gt;127.0.0.1:3000/helloworld&lt;/code&gt;是不是就能看见&lt;strong&gt;&lt;code&gt;Hello，World！&lt;/code&gt;&lt;/strong&gt;了？&lt;/p&gt;
&lt;p&gt;可以看出，我们从render里创建的&lt;code&gt;{ title: &amp;#39;Hello, World!&amp;#39;}&lt;/code&gt;传到了jade里的&lt;code&gt;title&lt;/code&gt;了，是不是很酷？当然前提是，关于jade的语法你可能需要有所了解。&lt;/p&gt;
&lt;h2 id=&quot;Mongodb数据库的简易搭建&quot;&gt;Mongodb数据库的简易搭建&lt;/h2&gt;&lt;p&gt;由于要做的是个应用，这个应用需要跟后台的数据进行交互。如果用不上数据库的话，那么我们也就没必要用上express这个框架了，写个静态的页面就行了。在Nodejs出来之前，如果要遇到跟后台交互的部分，通常情况下用的是PHP,Python,Java等语言来实现后端的逻辑。然而Nodejs诞生之后，js也能在后端发挥它的作用后，前后都能用js来写了。扯远了。这里我们没用通常情况下耳熟能详的Mysql这个数据库，而是用Mongodb这个Nosql数据库。它能够采用json的格式进行数据存储，前期的入门来说更简单，而且速度还很快，性能还很好。更重要的是还是开源免费的项目。总之优点很多。简易说下步骤：&lt;/p&gt;
&lt;h3 id=&quot;下载mongodb&quot;&gt;下载mongodb&lt;/h3&gt;&lt;p&gt;首先去官网下载对应操作系统、版本的mongodb：&lt;code&gt;https://www.mongodb.org/downloads#production&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;windows版的安装开启&quot;&gt;windows版的安装开启&lt;/h3&gt;&lt;p&gt;对于windows用户来说，会下载到一个msi文件，点击安装。它能自动安装mongodb。然后装完之后，找到安装的目录，找到所在目录的&lt;code&gt;bin&lt;/code&gt;文件夹。（你可以将其复制到任何一个你想要的地方，然后下面的步骤的是一样的。）进入，然后打开命令行工具，输入：&lt;code&gt;mongod --logpath &amp;quot;D:/Web/Mongodb/mongodb.log&amp;quot; --logappend --dbpath &amp;quot;D:/Web/Mongodb/data&amp;quot;&lt;/code&gt;注意，我这里的路径是我自己定义的。你需要自己依照自己的情况创建相应的目录。  &lt;/p&gt;
&lt;p&gt;简要说明一下，&lt;code&gt;mongod&lt;/code&gt;是bin下的一个文件，它能执行开启mongodb服务的功能。所以如果想要直接用&lt;code&gt;mongod&lt;/code&gt;这个命令在系统的任意地方使用，你需要将其的路径添加到系统的path。&lt;br&gt;&lt;code&gt;--logpath&lt;/code&gt;是mongodb的日志文件路径，&lt;code&gt;--dbpath&lt;/code&gt;是mongodb的数据文件路径。&lt;code&gt;--logappend&lt;/code&gt;是一个追加日志的选项，可以不指定。这些路径的指定在哪里其实都并没有太多问题，因为mongodb服务一旦开启，你在哪里都能使用。&lt;/p&gt;
&lt;p&gt;如果没有报错的话，在浏览器地址栏输入&lt;code&gt;127.0.0.1:27017&lt;/code&gt;,只要能打开看到&lt;code&gt;It looks like you are trying to access MongoDB over HTTP on the native driver port.&lt;/code&gt;这句话，说明你的mongodb的服务已经成功开启。&lt;/p&gt;
&lt;h3 id=&quot;Linux版的安装开启&quot;&gt;Linux版的安装开启&lt;/h3&gt;&lt;p&gt;对于Linux用户来说，安装mongodb实际上只是个解压的过程。我习惯是将mongodb的压缩包解压到/usr/local/mongodb/下。然后创建两个文件夹，一个是data，一个是log，分别用于存放数据文件和日志文件。然后进入bin下，执行&lt;code&gt;./mongod --dbpath=/usr/local/mongodb/data –logpath=/usr/local/mongodb/log/mongo.log --logappend&lt;/code&gt;。  &lt;/p&gt;
&lt;p&gt;跟windows版一样，如果没有报错的话，在浏览器地址栏输入&lt;code&gt;*.*.*.*:27017&lt;/code&gt;，（注：&lt;code&gt;*.*.*.*&lt;/code&gt;是你的linux服务器的地址，如果本机是linux，那么就是&lt;code&gt;127.0.0.1&lt;/code&gt;）只要能打开看到&lt;code&gt;It looks like you are trying to access MongoDB over HTTP on the native driver port.&lt;/code&gt;这句话，说明你的mongodb的服务已经成功开启。&lt;/p&gt;
&lt;h3 id=&quot;Mac版的安装开启&quot;&gt;Mac版的安装开启&lt;/h3&gt;&lt;p&gt;因为手头没有Mac的机器，可以参见Linux版的安装开启。&lt;/p&gt;
&lt;h3 id=&quot;注意事项&quot;&gt;注意事项&lt;/h3&gt;&lt;p&gt;服务一旦开启，就能在系统的各个角落连上它。不过它会占用一个窗口。所以如果用linux的话推荐新开一个screen或者就是多开一个终端。用windows或者MAC的话就是多开一个终端让它的服务跑起来就是了。&lt;/p&gt;
&lt;h2 id=&quot;安装Nodejs的mongodb依赖&quot;&gt;安装Nodejs的mongodb依赖&lt;/h2&gt;&lt;p&gt;这个地方走了不少的坑，由于我用于连接mongodb的工具不是常见的&lt;code&gt;mongoose&lt;/code&gt;而是&lt;code&gt;monk&lt;/code&gt;，而&lt;code&gt;monk&lt;/code&gt;需要的Nodejs的&lt;code&gt;mongodb&lt;/code&gt;驱动的版本又是比较特别的，太高还不兼容。所以&lt;br&gt;这里就需要进行一些改动。  &lt;/p&gt;
&lt;p&gt;在test1的文件夹下，可以发现一个叫做&lt;code&gt;package.json&lt;/code&gt;的文件，在这个文件的&lt;code&gt;&amp;quot;dependence&amp;quot;&lt;/code&gt;下加入两个依赖：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;mongodb&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;^1.4.4&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;monk&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;^1.0.1&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至于为什么我没用&lt;code&gt;mongoose&lt;/code&gt;而是&lt;code&gt;monk&lt;/code&gt;，是因为&lt;code&gt;monk&lt;/code&gt;更容易上手。如果你犹豫不决的话可以参考这个：  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/23615377/monk-vs-mongoose-for-mongodb&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://stackoverflow.com/questions/23615377/monk-vs-mongoose-for-mongodb&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;然后回到项目根目录，也就是&lt;code&gt;package.json&lt;/code&gt;所在的目录，然后在命令行内输入&lt;code&gt;npm install&lt;/code&gt;或者&lt;code&gt;cnpm install&lt;/code&gt;，就能将刚才那两个mongodb的依赖加入了。&lt;/p&gt;
&lt;p&gt;注：&lt;code&gt;mongodb&lt;/code&gt;这个依赖不是安装了&lt;code&gt;mongodb&lt;/code&gt;这个数据库，而是安装了Nodejs下对于&lt;code&gt;mongodb&lt;/code&gt;数据库的驱动。而&lt;code&gt;monk&lt;/code&gt;这个库才是对于数据库进行操作的依赖。&lt;/p&gt;
&lt;h2 id=&quot;未完待续&quot;&gt;未完待续&lt;/h2&gt;&lt;p&gt;下一篇文章将会讲述如何进行数据的写入和读出，让你的页面真正不再是静态页面，而是能“动起来”。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;前段时间，把之前用Nodejs做的爬虫程序（参看之前的&lt;a href=&quot;http://molunerfinn.com/nodejs-1/&quot;&gt;cheerio爬虫&lt;/a&gt;)，整合了一下。采用Nodejs市面上最普遍最常见的Express框架，简易地做了一个北邮人论坛每日十大的记录，暂且叫为&lt;a href=&quot;http://topten.piegg.cn&quot;&gt;论坛日报&lt;/a&gt;。在应用框架的过程中，我发现绝大部分的教程，还仅是在教你用Express写个简单的&lt;code&gt;Hello World&lt;/code&gt;，然后就没有然后了。或者就是写多人博客，但是在一些关键的地方如数据的录入，读取等地方却没有详尽的描述。导致我在这个项目一开始真的是寸步难行。有数据但是不知道怎么写进数据库，怎么读出来-&amp;gt;渲染到前端。  &lt;/p&gt;
&lt;p&gt;这篇文章算是我自己做项目的切身体会，能够了解到Express基本使用、路由基本使用、数据写入读出、模板引擎渲染等等。希望能够帮上想要用Nodejs、Express做些简单应用的小伙伴们吧。&lt;br&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
      <category term="Nodejs" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/Nodejs/"/>
    
    
      <category term="Nodejs" scheme="https://molunerfinn.com/tags/Nodejs/"/>
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>setTimeout()引发的一些思考 | 循环延时和作用域、闭包</title>
    <link href="https://molunerfinn.com/something-about-settimeout/"/>
    <id>https://molunerfinn.com/something-about-settimeout/</id>
    <published>2016-03-27T14:37:00.000Z</published>
    <updated>2016-03-27T08:22:18.154Z</updated>
    
    <content type="html">&lt;h2 id=&quot;起源&quot;&gt;起源&lt;/h2&gt;&lt;p&gt;会研究起setTimeout()这个方法，还是来源于一次开发要求。这次开发的需求是要求让一些动作/动画依次延时执行，简单来说，比如让页面滚动到底部停留2秒滚回顶部，然后停留2秒点击某个按钮触发某个选项的弹出层，然后停留两秒，进入下一个页面。&lt;br&gt;看起来不就是多设几个setTimeout不就行了？  &lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;诶，这也是我一开始觉得简单的原因，我觉得不过是延时嘛，然后延时之后执行一下动作/动画就好了。&lt;/p&gt;
&lt;p&gt;关键点来了。需求中有一点比较重要：给多个页面写一套通用的方案，用于展示页面。先滚动到页面底部，后滚动到目的地点，点击按钮-&amp;gt;，然后跳转下一个页面。由于事先不知道每个页面需要的按钮数目是多少，就必须得定义一个JSON数组存放动作。然后前端用for循环来读取这个动作列表，进而执行动画。&lt;/p&gt;
&lt;h2 id=&quot;问题&quot;&gt;问题&lt;/h2&gt;&lt;p&gt;我们假设一下这个动作的JSON数组列表是&lt;code&gt;performance:[...]&lt;/code&gt;，每个页面的&lt;code&gt;performance&lt;/code&gt;的长度不一样。一开始我简单写了个循环。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; performance.length; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; target = performance[i].target,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      action = performance[i].action;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(target).trigger(action)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你猜猜这会发生什么？反正绝对不是我们字面上所想要表达出来的意思。&lt;br&gt;实际上，假如总共有n个动作需要执行的话，那么上面那串代码只会执行最后一个动作。也许你会觉得很奇怪，为什么不应该是在每个循环体内延时1秒执行动作然后再进行下一个动作呢？  &lt;/p&gt;
&lt;h2 id=&quot;分析&quot;&gt;分析&lt;/h2&gt;&lt;p&gt;要解决这个问题，首先我们必须明确几个概念：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JavaScript是单线程的&lt;/li&gt;
&lt;li&gt;浏览器不是单线程的&lt;/li&gt;
&lt;li&gt;同步和异步的区别&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先，JS是单线程的。它需要执行的任务是需要排队执行的。也就是，如果所有的任务都是以同步的情况下书写的，在主线程里，就会出现在某个任务耗时很长的情况下，它的下一个任务就迟迟无法执行。然而异步的概念是，将某些耗时的任务暂时先挂起-&amp;gt;&lt;code&gt;任务队列&lt;/code&gt;，主线程得以快速执行任务。直到&lt;br&gt;主线程空了以后，就会去任务队列里找第一个事件来执行。浏览器不是单线程的，这点很好理解。你用浏览器肯定会打开多个窗口，如果只有单线程的话，那就无法做到多窗口同时浏览啦；浏览器除了有执行js代码的一条线程，还有渲染网页效果的线程等。OK，简单明确一下这几个概念之后，我们就开始回到上面那个问题中去。  &lt;/p&gt;
&lt;p&gt;上面那个问题中，&lt;code&gt;setTimeout(function(),*)&lt;/code&gt;里面的那个function实际上是异步回调的函数了。这么理解比较容易，由于setTimeout()这个方法会让function()里的代码延时*s执行，那么实际上它就被挂起到&lt;code&gt;任务队列&lt;/code&gt;中了。for循环体内setTimeout内的function将会在1s后执行。为了方便，我们将n设成10。而让i从0跑到10，花费1s都不需要，所以等setTimeout()的时间到时之后，for循环中的i已经跑到9了。而setTimeout的function这才被执行。也就是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;for先循环10次-&amp;gt;直到setTimeout的时间结束&lt;/li&gt;
&lt;li&gt;setTimeout内的function执行&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;既然这样，为什么只执行了最后一个动作n次呢？  &lt;/p&gt;
&lt;h3 id=&quot;作用域和闭包在此的简单描述&quot;&gt;作用域和闭包在此的简单描述&lt;/h3&gt;&lt;p&gt;这里我们需要了解一下作用域和闭包。为什么只执行了最后一次动作，是因为function里&lt;code&gt;performance[i].target&lt;/code&gt;的这个i并没有保留每次循环时候的i而是留下了循环到最后一次的i。之所以没有把i留在function内部，是因为我们没有将每个i作为一个参数传入留在function内部。因此&lt;code&gt;console.log(i)&lt;/code&gt;实际上是引用着外部作用域的i-&amp;gt;而i因为循环地迅速，早已自加到了9。所以只能执行起最后一个动作了。为了让i能够留在function内部存下来，我们需要构造一个闭包。  &lt;/p&gt;
&lt;p&gt;仔细看看下面的代码跟上面的代码的区别：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; performance.length; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; target = performance[i].target,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        action = performance[i].action;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      $(target).trigger(action)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在这里，我们引入了一个匿名函数，这个函数需要一个参数传入，也就是i。通过传入的这个参数，我们将i成功传入function内部作用域保存了起来。然而这样做还是有个问题：那就是，所有的动作都在同一个时刻触发了。也就是延迟1s之后同时触发了所有的动作。这又是为什么？&lt;/p&gt;
&lt;h2 id=&quot;解决&quot;&gt;解决&lt;/h2&gt;&lt;p&gt;分析中有个地方不知道有没有说清楚，那就是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;for先循环10次-&amp;gt;直到setTimeout的时间结束&lt;/li&gt;
&lt;li&gt;setTimeout内的function执行&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这块地方的东西实际上是这样的。直到setTimeout结束实际上是指第一个setTimeout结束后，开始触发内部function。然而所有的setTimeout都是在1s后触发，那就会出现同时触发的情况。为了解决这个问题，我们需要手动进行延时计算。其实也很简单，由于这里我们是希望每个动作都是在上一个动作延时1秒后发生。那么就可以这样：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; performance.length; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; target = performance[i].target,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        action = performance[i].action;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      $(target).trigger(action)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;*i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样的话就能解决动作\动画延时循环的问题了。&lt;/p&gt;
&lt;p&gt;实际上，还可以采用promise的方法，下一次我会将promise带入这个话题，在循环中进行更精确的延时操作。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;起源&quot;&gt;起源&lt;/h2&gt;&lt;p&gt;会研究起setTimeout()这个方法，还是来源于一次开发要求。这次开发的需求是要求让一些动作/动画依次延时执行，简单来说，比如让页面滚动到底部停留2秒滚回顶部，然后停留2秒点击某个按钮触发某个选项的弹出层，然后停留两秒，进入下一个页面。&lt;br&gt;看起来不就是多设几个setTimeout不就行了？  &lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs学习日志（一）——cheerio爬虫</title>
    <link href="https://molunerfinn.com/nodejs-1/"/>
    <id>https://molunerfinn.com/nodejs-1/</id>
    <published>2016-02-23T14:02:00.000Z</published>
    <updated>2017-01-02T07:47:41.507Z</updated>
    
    <content type="html">&lt;p&gt;等了好久的寒假等了好久的空闲时间。大三的课还是忙到想学东西都没有足够的时间。学习新事物的速度跟大二的时候一比简直不忍直视。不过也有一部分原因是在于入门前端后，现在所处的阶段正好是瓶颈期。发发牢骚，有时间了，该学还是要学的。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Nodejs的基本认知&quot;&gt;Nodejs的基本认知&lt;/h2&gt;&lt;p&gt;第一次接触Nodejs这个名词的具体时间已经忘了。但是自我15年5月开始学习前端后，这个名词就一直没从我的视线里消失过。官方解释，不管是英文的还是中文的版本，大部分人都已经看过了。我只说说我自己的理解：&lt;strong&gt;Nodejs是个可以运行在服务器端的一个js运行环境；得益于谷歌的V8引擎，对于js解析的速度非常快；单线程，但是由于事件驱动与非阻塞的I/O让它轻量而高效。&lt;/strong&gt;从此前端（js）开发人员手中有了一个利器——前后都能由前端人员用js来写了。&lt;br&gt;因为Nodejs的出现，一大堆因此衍生的东西从此不可阻挡地诞生在前端世界中。&lt;/p&gt;
&lt;h2 id=&quot;Nodejs的基本安装&quot;&gt;Nodejs的基本安装&lt;/h2&gt;&lt;p&gt;我手头的机器的操作系统目前只有Windows和Linux。Mac版的我想应该也跟Windows一样很容易安装吧。 &lt;/p&gt;
&lt;h3 id=&quot;Windows版本Nodejs的安装&quot;&gt;Windows版本Nodejs的安装&lt;/h3&gt;&lt;p&gt;进nodejs的&lt;a href=&quot;https://nodejs.org/en/&quot; title=&quot;https://nodejs.org/en/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;英文官网&lt;/a&gt;,首先映入眼帘的就是两个大大的For windows用户的两个版本：LTS版本（长期支持版本）和STABLE稳定版本（拥有最新特性）。不管你选择哪个版本都是可以的。当然作为喜欢尝鲜的人自然会选择后者。这两个都是msi格式的文件，下载后可以傻瓜式地安装，并且会自动地将系统的环境变量PATH写好，以及装上相应版本的NPM（nodejs的插件包管理工具）。&lt;/p&gt;
&lt;h3 id=&quot;Linux版本Nodejs的安装&quot;&gt;Linux版本Nodejs的安装&lt;/h3&gt;&lt;p&gt;我不是很推荐用各个发行版自带的包管理工具例如&lt;code&gt;yum&lt;/code&gt;,&lt;code&gt;apt-get&lt;/code&gt;来直接install nodejs。因为版本跟不上。很多都还是node在0.10.&lt;em&gt;的版本。我自己的经验走来，可以推荐以下的步骤（安装&lt;em&gt;*已编译&lt;/em&gt;&lt;/em&gt;的nodejs）：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;首先可以去&lt;code&gt;http://nodejs.org/download/&lt;/code&gt;这里找到所需要的版本&lt;/li&gt;
&lt;li&gt;然后在命令行下，选好下载的路径，&lt;code&gt;wget https://nodejs.org/download/release/v5.7.0/node-v5.7.0-linux-x64.tar.gz&lt;/code&gt;(我这里选的是5.7的以编译好的版本)&lt;/li&gt;
&lt;li&gt;接着&lt;code&gt;sudo tar --strip-components 1 -xzvf node-v* -C /usr/local&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;安装好后可以用&lt;code&gt;node --version&lt;/code&gt;或者&lt;code&gt;node -v&lt;/code&gt;检查一下是否安装成功&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;而且这样做的话，更新还方便。&lt;/p&gt;
&lt;h3 id=&quot;MacOS版本Nodejs的安装&quot;&gt;MacOS版本Nodejs的安装&lt;/h3&gt;&lt;p&gt;可以直接去官网下载dmg镜像文件安装，当然也可以用过brew直接&lt;code&gt;brew install nodejs&lt;/code&gt;的方式来安装。装好nodejs之后可以通过&lt;code&gt;npm install -g n&lt;/code&gt;安装一个管理nodejs版本的工具n，可以很方便的进行nodejs的升级。&lt;/p&gt;
&lt;h3 id=&quot;cnpm安装&quot;&gt;cnpm安装&lt;/h3&gt;&lt;p&gt;由于自己吃了亏，所以不想让读者也吃亏。在国内的朋友，最好还是将官方的npm工具换成&lt;a href=&quot;https://github.com/cnpm/cnpm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cnpm&lt;/a&gt;，这是因为npm的源在国外，会导致经常性的模块、插件下载失败。而cnpm这个工具，官方解释：&lt;code&gt;npm client for China mirror of npm&lt;/code&gt;，npm的中国镜像的客户端。这个镜像源是淘宝做的：&lt;code&gt;https://npm.taobao.org/&lt;/code&gt;。在这里衷心感谢淘宝的前端团队为国内前端开发人员做出的巨大贡献。这个镜像源跟官方同步是每10分钟一次，所以不必担心模块和插件包的版本跟不上的问题。而且下载速度是真心快。&lt;/p&gt;
&lt;p&gt;安装方法官方给出两个：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;$ npm install -g cnpm --registry=https://registry.npm.taobao.org&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;figure class=&quot;highlight haml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;`alias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-&lt;span class=&quot;ruby&quot;&gt;-cache=&lt;span class=&quot;variable&quot;&gt;$HOME&lt;/span&gt;/.npm/.cache/cnpm \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;-disturl=&lt;span class=&quot;symbol&quot;&gt;https:&lt;/span&gt;/&lt;span class=&quot;regexp&quot;&gt;/npm.taobao.org/dist&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt;-userconfig=&lt;span class=&quot;variable&quot;&gt;$HOME&lt;/span&gt;/.cnpmrc&lt;span class=&quot;string&quot;&gt;&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# Or alias it in .bashrc or .zshrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ echo &#39;\n#alias for cnpm\nalias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  -&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;string&quot;&gt;-cache=$HOME/.npm/.cache/cnpm \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;  -&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;string&quot;&gt;-disturl=https://npm.taobao.org/dist \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;/span&gt;  -&lt;span class=&quot;ruby&quot;&gt;&lt;span class=&quot;string&quot;&gt;-userconfig=$HOME/.cnpmrc&quot;&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39; &amp;gt;&amp;gt; ~/.zshrc &amp;amp;&amp;amp; source ~/.zshr`&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;安装结束后，就可以用&lt;code&gt;cnpm&lt;/code&gt;这个命令代替&lt;code&gt;npm&lt;/code&gt;这个命令了。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;Nodejs-爬虫初探&quot;&gt;Nodejs-爬虫初探&lt;/h2&gt;&lt;p&gt;曾经自己用2小时看完教程模仿着写出过python的小爬虫，很方便也很强大。这次正好有爬取数据的需求。我就想着能否用nodejs来完成爬虫的任务——因为我觉得这对于nodejs来说应该是很容易的吧。但是事实上并没有想象中那么简单。至少从搜索结果上来说，用nodejs来做爬虫还并没有用python来做爬虫受欢迎。毕竟相对来说，nodejs是新鲜事物以及准入门槛也相对高了点。不过还是让我发现了叫做&lt;a href=&quot;https://github.com/cheeriojs/cheerio&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cheerio&lt;/a&gt;的这个nodejs里用来处理网页文档的利器。  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：以下的内容需要稍微有些前端的知识。  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我们来分析一下，一个网络爬虫要做的事情：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;获取网页内容（http\request\superagent等）&lt;/li&gt;
&lt;li&gt;筛选网页信息（cheerio）&lt;/li&gt;
&lt;li&gt;输出或存储信息（console\fs\mongodb等）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这篇文章标题之所以没有涉及到其他模块仅仅提到了cheerio，是因为你可以看到，无论是第一步还是第三步都有多种可选项。而关键的筛选网页信息的部分只有cheerio是目前最优的选择。&lt;/p&gt;
&lt;h3 id=&quot;cheerio-最优选之一&quot;&gt;cheerio-最优选之一&lt;/h3&gt;&lt;p&gt;简单来说，cheerio就是服务器端的jQuery，去掉了jQuery的一些效果类和请求类等等功能后，仅保留核心对dom操作的部分，因此能够对dom进行和jQuery一样方便的操作。它是我们筛选数据的利器——把多余的html标签去掉，只留下我们想要的内容的重要工具。  &lt;/p&gt;
&lt;p&gt;而获取网页内容，则有很多种方案了。综合一下我能给出几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nodejs自带-http模块（异步）&lt;/li&gt;
&lt;li&gt;第三方-request模块（异步）&lt;/li&gt;
&lt;li&gt;第三方-superagent模块（异步）&lt;/li&gt;
&lt;li&gt;第三方-sync-request模块（同步）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其实作为一个很简单的爬虫——没有登录注册、没有翻页的话，这几个任何一个都是可以的。如果有涉及到相对复杂的操作（请求，cookie，验证等等）的话，推荐采用第二个模块或者第三个模块。本文由于我自己实践所限，仅会提到&lt;code&gt;superagent&lt;/code&gt;以及&lt;code&gt;sync-request&lt;/code&gt;这两个第三方模块。  &lt;/p&gt;
&lt;h3 id=&quot;引入模块&quot;&gt;引入模块&lt;/h3&gt;&lt;p&gt;好了我们就开始写第一个小爬虫吧。第一个爬虫的目标是爬取&lt;a href=&quot;http://movie.douban.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;豆瓣电影&lt;/a&gt;指定电影页的相应信息（例如，导演名，电影名，主演名，时长，类型，评分，人数等等）。&lt;/p&gt;
&lt;p&gt;这个爬虫会用到三个模块：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cheerio&lt;/li&gt;
&lt;li&gt;sync-request&lt;/li&gt;
&lt;li&gt;fs（nodejs文件系统模块）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在项目文件夹下可以输入如下命令：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;cnpm install cheerio sync-request --save&lt;/code&gt;，这样就能将模块下载好，让我们在文件中引入。新建一个&lt;code&gt;index.js&lt;/code&gt;的文件。&lt;br&gt;在头部引入模块：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cheerio = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cheerio&#39;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; request = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;sync-request&#39;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; fs = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;fs&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;程序正文&quot;&gt;程序正文&lt;/h3&gt;&lt;p&gt;然后是获取网页内容：  &lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;url = &lt;span class=&quot;string&quot;&gt;&#39;http://movie.douban.com/subject/25724855/&#39;&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;//这里是举个例子而已，豆瓣的具体的电影网址可以自己替换&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; html = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;html = request(&lt;span class=&quot;string&quot;&gt;&#39;GET&#39;&lt;/span&gt;, url).getBody().toString();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在这里，同步获取的方式的优点就体现出来了，能够直接将获取的内容输出给变量，简单方便。但是缺点就是万一内容太多，速度将会很慢，并且没有错误判断机制。而这些就是异步获取的优势了。&lt;/p&gt;
&lt;p&gt;根据我们要获取的内容，可以在网页相应部分右键-审查元素，查找相应的内容被什么标签包含着，然后用cheerio的dom操作将所需内容给剥离出来：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;handleDB&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;html&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = cheerio.load(html); &lt;span class=&quot;comment&quot;&gt;//引入cheerio的方法。这样的引入方法可以很好的结合jQuery的用法。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; info = $(&lt;span class=&quot;string&quot;&gt;&#39;#info&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取电影名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; movieName = $(&lt;span class=&quot;string&quot;&gt;&#39;#content&amp;gt;h1&amp;gt;span&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;property&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;v:itemreviewed&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取影片导演名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; directories = &lt;span class=&quot;string&quot;&gt;&#39;- 导演：&#39;&lt;/span&gt; + $(&lt;span class=&quot;string&quot;&gt;&#39;#info span a&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;rel&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;v:directedBy&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取影片演员&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; starsName = &lt;span class=&quot;string&quot;&gt;&#39;- 主演：&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  $(&lt;span class=&quot;string&quot;&gt;&#39;.actor .attrs a&#39;&lt;/span&gt;).each(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,elem&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      starsName += $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).text() + &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取片长&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; runTime = &lt;span class=&quot;string&quot;&gt;&#39;- 片长：&#39;&lt;/span&gt; + $(&lt;span class=&quot;string&quot;&gt;&#39;#info span&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;property&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;v:runtime&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取影片类型  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; kind = $(&lt;span class=&quot;string&quot;&gt;&#39;#info span&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;property&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;v:genre&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 处理影片类型数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; kLength = kind.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; kinds = &lt;span class=&quot;string&quot;&gt;&#39;- 影  片类型：&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; kLength; i += &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    kinds += kind.slice(i,i+&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) + &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取电影评分和电影评分人数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 豆瓣&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; DBScore = $(&lt;span class=&quot;string&quot;&gt;&#39;.ll.rating_num&#39;&lt;/span&gt;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; DBVotes = $(&lt;span class=&quot;string&quot;&gt;&#39;a.rating_people&amp;gt;span&#39;&lt;/span&gt;).text().replace(&lt;span class=&quot;regexp&quot;&gt;/\B(?=(\d&amp;#123;3&amp;#125;)+$)/g&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;,&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; DB = &lt;span class=&quot;string&quot;&gt;&#39;- 豆  瓣评分：&#39;&lt;/span&gt; + DBScore + &lt;span class=&quot;string&quot;&gt;&#39;/10&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;(&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;from&#39;&lt;/span&gt; + DBVotes + &lt;span class=&quot;string&quot;&gt;&#39;users&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;)&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// IMDBLink&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  IMDBLink = $(&lt;span class=&quot;string&quot;&gt;&#39;#info&#39;&lt;/span&gt;).children().last().prev().attr(&lt;span class=&quot;string&quot;&gt;&#39;href&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; data = movieName + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + directories + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + starsName + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + runTime + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + kinds + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt;+ DB +&lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 输出文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  fs.appendFile(&lt;span class=&quot;string&quot;&gt;&#39;dbmovie.txt&#39;&lt;/span&gt;, data, &lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; err;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;大体信息写入成功&#39;&lt;/span&gt;+&lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + data)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从上面可以看出，对于dom的操作，cheerio和jQuery几乎是一致的。这些方法，只要你会用jQuery都不会陌生。最关键的部分基本上都是调用*.text()的方法获取文本内容。当然，获取一些链接之类的属性名自然会用相应的方法，这也是无可厚非。&lt;/p&gt;
&lt;p&gt;这个爬虫有个比较关键的地方在于，需要爬取相应电影的IMDB评分。因为在豆瓣的电影页里，会有专门的一行放置IMDB评分链接的地方。我们通过上面叫做&lt;code&gt;handleDB&lt;/code&gt;的方法能够获取到IMDB的链接，然后再用类似的办法在IMDB页中获取相应的评分和人数。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Link = request(&amp;#39;GET&amp;#39;, IMDBLink).getBody().toString();&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后再用获取豆瓣电影相应信息的方法类似的再获取一遍：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;handleIMDB&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;Link&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = cheerio.load(Link);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取IMDB评分&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; IMDBScore = $(&lt;span class=&quot;string&quot;&gt;&#39;.ratingValue span&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;itemprop&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;ratingValue&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 获取IMDB评分人数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; IMDBVotes = $(&lt;span class=&quot;string&quot;&gt;&#39;.small&#39;&lt;/span&gt;).filter(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;itemprop&#39;&lt;/span&gt;) === &lt;span class=&quot;string&quot;&gt;&#39;ratingCount&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).text();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 字符串拼接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; IMDB = &lt;span class=&quot;string&quot;&gt;&#39;- IMDB评分：&#39;&lt;/span&gt; + IMDBScore + &lt;span class=&quot;string&quot;&gt;&#39;/10&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;(&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;from&#39;&lt;/span&gt; + IMDBVotes + &lt;span class=&quot;string&quot;&gt;&#39;users&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;)&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;comment&quot;&gt;// 输出文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  fs.appendFile(&lt;span class=&quot;string&quot;&gt;&#39;dbmovie.txt&#39;&lt;/span&gt;, IMDB, &lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; err;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;IMDB信息写入成功&#39;&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + IMDB)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由于cheerio对于dom操作的部分，跟jQuery没区别所以我就不再赘述，如果你有疑惑，可以参考cheerio的&lt;a href=&quot;https://github.com/cheeriojs/cheerio#api&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方说明&lt;/a&gt;。重点说一下fs模块。这个模块在我们的爬虫里是作为输出爬取数据的最终步骤。简单的说说我们所用的api。（fs全部api官方文档请看&lt;a href=&quot;https://nodejs.org/dist/latest-v5.x/docs/api/fs.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里&lt;/a&gt;)。  &lt;/p&gt;
&lt;p&gt;&lt;code&gt;fs.appendFile(file, data[, options], callback)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fs.appendFile()&lt;/code&gt;是个异步输出文件的方法。它是的作用是追加文件内容。如果这个文件不存在那么就会新建一个，并写入追加内容。其中：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;file-&amp;gt;文件名&lt;/li&gt;
&lt;li&gt;data-&amp;gt;要写入的内容&lt;/li&gt;
&lt;li&gt;options-&amp;gt;选项，可以指定输出的文件编码格式&lt;/li&gt;
&lt;li&gt;callback-&amp;gt;回调函数，可以用于输出错误或者输出相应读写成功信息&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;其中callback中会传递一个error参数用于反馈错误所用。我们在这里主要用于输出成功信息。当然如果发生错误将会报错。让我们来看看输出结果：&lt;br&gt;&lt;code&gt;dbmovie.txt&lt;/code&gt;:  &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;房间 Room  
-&lt;span class=&quot;ruby&quot;&gt; 导演：伦尼·阿伯拉罕森  
&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt; 主演：布丽·拉尔森/雅各布·特伦布莱/琼·艾伦/肖恩·布里吉格斯/威廉姆·&lt;span class=&quot;constant&quot;&gt;H&lt;/span&gt;·梅西/梅根·帕克/阿曼达·布鲁盖尔/卡斯·安瓦尔/乔·平格/温迪·古逊/兰道尔·爱德华/杰克·富尔顿/汤姆·麦卡穆斯/  
&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt; 片长：&lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;分钟  
&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt; 影  片类型：剧情/家庭/  
&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt; 豆  瓣评分：&lt;span class=&quot;number&quot;&gt;8.7&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;(from21,&lt;span class=&quot;number&quot;&gt;211&lt;/span&gt;users)  
&lt;/span&gt;-&lt;span class=&quot;ruby&quot;&gt; &lt;span class=&quot;constant&quot;&gt;IMDB&lt;/span&gt;评分：&lt;span class=&quot;number&quot;&gt;8.3&lt;/span&gt;/&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;(from56,&lt;span class=&quot;number&quot;&gt;920&lt;/span&gt;users)  &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;是不是还不错呢？不过这个方法有个缺陷，因为node只能识别utf-8编码格式，所以一旦我们爬取的网页是非utf-8，例如GBK、GB2312等，那么该如何应对？下面将会讲述解决办法&lt;/p&gt;
&lt;h3 id=&quot;处理GBK\GB2312等编码网页的爬虫&quot;&gt;处理GBK\GB2312等编码网页的爬虫&lt;/h3&gt;&lt;p&gt;我们在爬取网页的时候尤其要注意编码格式。一旦爬取的编码格式和输出的编码格式不一致将会产生乱码。所以遇到较为早期的网站用的是非utf-8编码的将会比较头疼。不过也并不是没有办法。网上比较常见的是用&lt;a href=&quot;https://github.com/ashtuchkin/iconv-lite&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iconv-lite&lt;/a&gt;这个第三方库进行转码。不过有个更方便的第三方库&lt;a href=&quot;https://github.com/magicdawn/superagent-charset&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;superagent-charset&lt;/a&gt;，它能够在采集网页信息后调用一个&lt;code&gt;.charset()&lt;/code&gt;的方法就能实现同样的功能。因此在这篇文章里我将会简要说明一下这个方法。  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：&lt;code&gt;superagent-charset&lt;/code&gt;模块依赖于&lt;code&gt;superagent&lt;/code&gt;模块&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;举个具体实例。这个例子我们将要爬取&lt;a href=&quot;http://bbs.byr.cn&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;北邮人论坛&lt;/a&gt;的每日十大的信息，将它们封装成json数组存起来。为此我们将采取从rss作为信息源来获取我们想要的信息。    &lt;/p&gt;
&lt;p&gt;为此我们同样先安装好模块。然后新建一个&lt;code&gt;index.js&lt;/code&gt;文件。&lt;/p&gt;
&lt;h3 id=&quot;引入模块-1&quot;&gt;引入模块&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; cheerio = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cheerio&#39;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; superagent = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;superagent-charset&#39;&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; fs = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;fs&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;程序正文-1&quot;&gt;程序正文&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; url = &lt;span class=&quot;string&quot;&gt;&#39;http://bbs.byr.cn/rss/topten&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; toptens = []; &lt;span class=&quot;comment&quot;&gt;// 初始化json数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;superagent.get(url) &lt;span class=&quot;comment&quot;&gt;// 获取网页内容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .charset(&lt;span class=&quot;string&quot;&gt;&#39;gb2312&#39;&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;// 转码-将gb2312格式转成utf-8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .end(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;err, res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 常规的错误处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; next(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; $ = cheerio.load(res.text,&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      xmlMode: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;// 由于从rss里读取xml，所以这一步一定要有，切记&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; d = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; date = d.getFullYear()+&lt;span class=&quot;string&quot;&gt;&quot;-&quot;&lt;/span&gt;+(d.getMonth()+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)+&lt;span class=&quot;string&quot;&gt;&quot;-&quot;&lt;/span&gt;+(d.getDate()); &lt;span class=&quot;comment&quot;&gt;// 取得爬取的日期&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; topten = &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 设定爬取的json数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      date: date,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      info: []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 具体爬取内容，主要都是cheerio操作了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&#39;item&#39;&lt;/span&gt;).each(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i,el&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      i += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      topten.info.push(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        topno: i,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        title: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;title&#39;&lt;/span&gt;).text(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        author: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;author&#39;&lt;/span&gt;).text(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pubDate: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;pubDate&#39;&lt;/span&gt;).text(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        boardName: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;guid&#39;&lt;/span&gt;).text().replace(&lt;span class=&quot;regexp&quot;&gt;/http:\/\/bbs.byr.cn\/article\//&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;).replace(&lt;span class=&quot;regexp&quot;&gt;/\/\d+/&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;).trim(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        link: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;link&#39;&lt;/span&gt;).text(),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        content: $(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;).find(&lt;span class=&quot;string&quot;&gt;&#39;description&#39;&lt;/span&gt;).text()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    toptens.unshift(&amp;#123;topten: topten&amp;#125;); &lt;span class=&quot;comment&quot;&gt;// 从原有的json数据之前追加json数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; json = &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(toptens); &lt;span class=&quot;comment&quot;&gt;// json格式解析，这步也是一定要有&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fs.writeFile(&lt;span class=&quot;string&quot;&gt;&#39;toptens.json&#39;&lt;/span&gt;, json, &lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err) &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; err;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;JSON写入成功&#39;&lt;/span&gt;+&lt;span class=&quot;string&quot;&gt;&#39;\r\n&#39;&lt;/span&gt; + json)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从上面我们可以看出，&lt;code&gt;superagent-charset&lt;/code&gt;模块就是在&lt;code&gt;.get()&lt;/code&gt;方法之后追加了一个&lt;code&gt;.charset()&lt;/code&gt;的方法用于转换网页编码格式，这个就很方便。同时可以注意到，主程序实际上是放在一个回调函数里的——&lt;code&gt;.end(function(err,res){...})&lt;/code&gt;，在获取网页内容结束（end）后，进入function这个回调函数，进行内容的筛选。这就是&lt;code&gt;superagent&lt;/code&gt;与&lt;code&gt;sync-request&lt;/code&gt;模块的区别之处了。异步的方式对于初学者来说相对会有些难尤其是在一些输出内容上会有与想法出入的地方——这是因为node本身的原因决定了异步回调才是node的精髓与难点。&lt;/p&gt;
&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;&lt;p&gt;这次的爬虫练习跟之前用python写的爬虫感觉还是有很大的不同——python的爬虫入门更依赖于正则表达式对于网页内容的切割。然而用了node之后，用了cheerio进行的内容筛选更符合前端的思维。对于dom的操作毕竟还是比用正则表达式来的直观。并且二者实际上实现简单功能来说，程序的复杂度也都并没有很高。既然如此，对于纯前端的人员来说，爬虫从nodejs学起，其实也不是一件很难的事，而是一件很棒的事。&lt;/p&gt;
&lt;p&gt;附上cheerio的一些教程的地址以及我自己做的DEMO在github上的地址：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cheerio的学习：&lt;code&gt;http://www.hubwiz.com/course/5636b7a11bc20c980538e998/&lt;/code&gt;，讲解的很清晰。&lt;/li&gt;
&lt;li&gt;通读cheerio API： &lt;code&gt;https://cnodejs.org/topic/5203a71844e76d216a727d2e&lt;/code&gt;，没学过jQuery的人可以看看&lt;/li&gt;
&lt;li&gt;dbmovie: &lt;code&gt;https://github.com/Molunerfinn/dbmovie-spider&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Nodejs-ByrTopTen: &lt;code&gt;https://github.com/Molunerfinn/Nodejs-ByrTopTen&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;欢迎评论！有的地方写得不好请指出！作者原创，需要转载请联系我。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;等了好久的寒假等了好久的空闲时间。大三的课还是忙到想学东西都没有足够的时间。学习新事物的速度跟大二的时候一比简直不忍直视。不过也有一部分原因是在于入门前端后，现在所处的阶段正好是瓶颈期。发发牢骚，有时间了，该学还是要学的。&lt;/p&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="开发" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/"/>
    
      <category term="Nodejs" scheme="https://molunerfinn.com/categories/Web/%E5%BC%80%E5%8F%91/Nodejs/"/>
    
    
      <category term="Nodejs" scheme="https://molunerfinn.com/tags/Nodejs/"/>
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Electron vs nwjs (part 2)[译]</title>
    <link href="https://molunerfinn.com/Electron-vs-nwjs-part2/"/>
    <id>https://molunerfinn.com/Electron-vs-nwjs-part2/</id>
    <published>2016-02-16T12:30:00.000Z</published>
    <updated>2016-02-16T12:40:21.757Z</updated>
    
    <content type="html">&lt;p&gt;写在前头：最近要写点东西，准确来说是用前端技术写桌面应用。之前曾经对Electron有所了解，最近在查阅资料的时候又发现了一个“新的东西”，叫做nwjs——前身是node-webkit。作为一个还未入坑的人来说，到底选择哪个东西作为我们开发的工具会更好呢？我看了这个&lt;a href=&quot;http://www.akawebdesign.com/author/arthurakay/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;作者&lt;/a&gt;写的两篇文章，发现应该能给另外想要从事同样开发的或者有兴趣的人一些启发。文章不错，而且没发现有中文译版，所以我给出自己的翻译。只是兴趣之作，有错误之处还请指出。&lt;br&gt;这是两篇文章中的第二篇。第一篇的翻译在&lt;a href=&quot;http://molunerfinn.com/Electron-vs-nwjs/&quot;&gt;这里&lt;/a&gt;。&lt;br&gt;以下是译文：&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;几个月前我写过一个叫做&lt;a href=&quot;http://www.akawebdesign.com/2015/05/06/electron-vs-nwjs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Electron vs nwjs&lt;/a&gt;的博客，并得到了不少的阅读量。我花费了5个月的时间，用两种办法构建了相当多的应用（明确一下，是不同的应用）并由此我感觉我对于Electron和nwjs有着相当明确的喜欢或者不喜欢的地方——在我现在用这两种办法来制作的应用中也是如此。&lt;br&gt;注意：下面我所写的纯粹是因为好玩。我只是一个在互联网上制作软件和吐槽的普通人。我的建议和经历，你可以相信或者不相信，一切取决于你。  &lt;/p&gt;
&lt;h3 id=&quot;开源行为&quot;&gt;开源行为&lt;/h3&gt;&lt;p&gt;在我前面的那篇文章里，Electron仍然是我更喜欢的一个项目。对于Electron我有一点尤其喜欢的是它的发行版的更新速度之快——到11月底已经有10个发行版本了！尽管更新速度快但是本身还是很稳定的，并且bug出现后也能被很快地修复。开发团队在GitHub的issues上也一直是很活跃。  &lt;/p&gt;
&lt;p&gt;对比之下，到我写这片文章的时候，nwjs只有两个发行版本。一些相当重要的（&lt;a href=&quot;https://github.com/nwjs/nw.js/issues/1440#issuecomment-150635133&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;IMO&lt;/a&gt;）的bugs在v0.12.x版本里还未被修复。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译者注：原文发表于2015年11月2日  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;发行版更新（频率）的行为虽然并不能作为“更好的选择”的标志，但是考虑到Electron坚持在GitHub上更新的行为，我觉得这是一个很好的理由让你现在的选择倾向Electron。  &lt;/p&gt;
&lt;p&gt;Nwjs在GitHub上的文档貌似有点过时了。文档里经常能看到涉及“node-webkit”的字眼，然而这个项目已更名（nwjs）了将近一年了。  &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;胜者：Electron&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;源码保护&quot;&gt;源码保护&lt;/h3&gt;&lt;p&gt;从很高的层面上来说，Electron和nwjs几乎是同一个东西。他们都允许你将一个web应用（以及一些Node.js后端的东西）打包成一个独立的桌面应用。当然这两个项目在对于如何得到“上下文”里有着细微的差别，但总体上APIs管理着windows（视窗），menus（菜单）等等。但对于大多数来说，这两个项目中一个唯一显著的区别归结于这个特征：保护你源码的（或是相关的）能力。  &lt;/p&gt;
&lt;p&gt;Nwjs 提供了一个功能，&lt;a href=&quot;https://github.com/nwjs/nw.js/wiki/Protect-JavaScript-source-code-with-v8-snapshot&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;能够将JS源码用v8引擎快照保护起来&lt;/a&gt;。Electron则没有这个功能。  &lt;/p&gt;
&lt;p&gt;我已经对此和Electron的开发者探讨并&lt;a href=&quot;https://github.com/atom/electron/issues/3041#issuecomment-150378069&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;得出了一个结论&lt;/a&gt;。在我看来，仅这个特征就能够成为开发者为什么选择nwjs而不是Electron的理由了。然而他们貌似对推行这个理念并不感兴趣。  &lt;/p&gt;
&lt;p&gt;他们的观点是有他们的理由的——v8引擎快照并不是真正地保护了源码，它只是很好的混淆了代码——并且因此而带来了相当大的性能损失。但是如果（不采用这种方法的话）唯一的替代方法只能是完全清除源代码，开发者将会更愿意选择哪怕只是看起来保护了源码而生成应用的方法。我认为这是一件很容易添加（保护源码功能）的事；他们则不这么认为。至少到目前为止是这样。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;胜者：nwjs&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;构建过程：Grunt&quot;&gt;构建过程：Grunt&lt;/h3&gt;&lt;p&gt;在我自己的项目里我频繁地使用了Grunt去做那些本地构建的事情——它真的很简单地就能配置，并且它对于你的应用的“产品”版本有着很大的帮助。Electron和nwjs都有着存在在npm和GitHub上的非常有用的Grunt工具包。  &lt;/p&gt;
&lt;p&gt;我用在Electron里的包：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;grunt-exec&lt;/strong&gt;：运行命令行任务非常有用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-contrib-uglify&lt;/strong&gt; 和 &lt;strong&gt;grunt-scram&lt;/strong&gt;：还记得Electron里并没有v8引擎快照或者任何机制去保护你的源代码么？那么结合UglifyJS并且混淆你的代码之后至少能够阻止大部分的人窥视你的源代码了。（但这并不是安全的！）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-contrib-copy&lt;/strong&gt;：在整个文件系统里对于拷贝文件/文件夹很有用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-string-replace&lt;/strong&gt;：对于更新构建数字和其他类似的东西很有用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-electron&lt;/strong&gt;：真正意义上的构建过程。能够指定你的应用想定的名字/版本/平台。甚至包括对你的app文件夹进行.asar压缩  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我用在nwjs里的包：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;grunt-exec&lt;/strong&gt;：运行命令行任务非常有用（和我在Electron里用的一样）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-contrib-copy&lt;/strong&gt;：在整个文件系统里对于拷贝文件/文件夹很有用（和我在Electron里用的一样）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-contrib-concat&lt;/strong&gt;：对于很多事情都很有用，尤其是在如果你需要拼接许多JS文件，并将它们运用在v8引擎快照之前的时候。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;grunt-nw-builder&lt;/strong&gt;：类似于&lt;code&gt;grunt-electron&lt;/code&gt;，&lt;br&gt;对于构建过程，它能够指定你的应用想定的名字/版本/平台&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;举个例子，创建一个v8引擎快照，你可能需要做如下的事情：&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;grunt.initConfig(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    exec : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nwjc : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cwd : &#39;build/nwjc&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            cmd : &#39;nwjc app.js app.bin&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    concat : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nwjc : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            dest : &#39;build/nwjc/app.js&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            src  : [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &#39;app/js/fileA.js&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &#39;app/js/fileB.js&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &#39;app/js/fileC.js&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    nwjs : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        options : &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            platforms : [ &#39;win32&#39;, &#39;win64&#39;, &#39;osx64&#39; ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            buildDir  : &#39;build/platforms&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            version   : &#39;0.12.3&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            //macIcns : &#39;&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            //winIco  : &#39;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        src     : [ &#39;build/production/**/*&#39; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grunt.loadNpmTasks(&#39;grunt-exec&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grunt.loadNpmTasks(&#39;grunt-contrib-concat&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grunt.loadNpmTasks(&#39;grunt-nw-builder&#39;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grunt.registerTask(&#39;default&#39;, [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;concat&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;exec&#39;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &#39;nwjs&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里的最后一步（“nwjs”输出地址）以及其他一些内容是在我的构建/成品文件夹里的，所以不要生搬硬套，你懂的。  &lt;/p&gt;
&lt;p&gt;我对Electron的Grunt包安装的过程与上面的几乎相同。在个别地方上只有极细微的差别。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;胜者：平手&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;启动时间&quot;&gt;启动时间&lt;/h3&gt;&lt;p&gt;虽然我并没有尝试记录我的应用的精确启动时间，但是我还是得承认采用Electron的应用在视觉上来说不管是在OSX还是在Windows上都启动地更快——不管是在本地开发还是在构建的速度上来说都是这样。&lt;br&gt;奇怪的是，我的Electron的应用比起我的nwjs应用来说复杂得多。Nwjs的应用确实是用了v8引擎快照（为此带来了巨大的性能损失），但是连运行没有v8引擎快照的版本的应用都显得启动地更慢。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;胜者：Electron&lt;/strong&gt;  &lt;/p&gt;
&lt;h3 id=&quot;你的看法是？&quot;&gt;你的看法是？&lt;/h3&gt;&lt;p&gt;请记住：我只是一个在互联网上制作软件和吐槽的普通人。你的情况可能与这些项目有着显著的差异，但是除非你需要确保你源代码的安全，否则我将会毫不犹豫选择Electron。  &lt;/p&gt;
&lt;p&gt;如果你已经用这些项目构建了应用，那么我将很乐意去倾听你们的想法以及经历！  &lt;/p&gt;
&lt;p&gt;请分享这篇文章！&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;原文地址：&lt;a href=&quot;http://www.akawebdesign.com/2015/11/02/electron-vs-nwjs-part-2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.akawebdesign.com/2015/11/02/electron-vs-nwjs-part-2/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;写在前头：最近要写点东西，准确来说是用前端技术写桌面应用。之前曾经对Electron有所了解，最近在查阅资料的时候又发现了一个“新的东西”，叫做nwjs——前身是node-webkit。作为一个还未入坑的人来说，到底选择哪个东西作为我们开发的工具会更好呢？我看了这个&lt;a href=&quot;http://www.akawebdesign.com/author/arthurakay/&quot;&gt;作者&lt;/a&gt;写的两篇文章，发现应该能给另外想要从事同样开发的或者有兴趣的人一些启发。文章不错，而且没发现有中文译版，所以我给出自己的翻译。只是兴趣之作，有错误之处还请指出。&lt;br&gt;这是两篇文章中的第二篇。第一篇的翻译在&lt;a href=&quot;http://molunerfinn.com/Electron-vs-nwjs/&quot;&gt;这里&lt;/a&gt;。&lt;br&gt;以下是译文：&lt;br&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/Web/%E6%97%A5%E5%BF%97/"/>
    
      <category term="翻译" scheme="https://molunerfinn.com/categories/Web/%E6%97%A5%E5%BF%97/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Electron vs nwjs[译]</title>
    <link href="https://molunerfinn.com/Electron-vs-nwjs/"/>
    <id>https://molunerfinn.com/Electron-vs-nwjs/</id>
    <published>2016-02-09T09:20:00.000Z</published>
    <updated>2016-02-16T12:31:35.683Z</updated>
    
    <content type="html">&lt;p&gt;写在前头：最近要写点东西，准确来说是用前端技术写桌面应用。之前曾经对Electron有所了解，最近在查阅资料的时候又发现了一个“新的东西”，叫做nwjs——前身是node-webkit。作为一个还未入坑的人来说，到底选择哪个东西作为我们开发的工具会更好呢？我看了这个作者写的两篇文章，发现应该能给另外想要从事同样开发的或者有兴趣的人一些启发。文章不错，而且没发现有中文译版，所以我给出自己的翻译。只是兴趣之作，有错误之处还请指出。&lt;br&gt;以下是译文：&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;我最近一直在对&lt;a href=&quot;https://github.com/atom/electron&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Electron&lt;/a&gt;和&lt;a href=&quot;https://github.com/nwjs/nw.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nwjs&lt;/a&gt;进行深入研究，它们是能将web应用部署到PC电脑上成为可安装文件的一类办法。它们的背后都采用了相似的技术——Node.js和Chromium（Chrome浏览器的引擎），而我自己也已经发现了一些细微的区别，这些区别也影响了我的开发工作（超出了纯粹的技术差异）。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;更新&lt;/em&gt;：我写了一篇文章作为这篇文章的&lt;a href=&quot;http://www.akawebdesign.com/2015/11/02/electron-vs-nwjs-part-2/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;跟进&lt;/a&gt;。  &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译者注：跟进的文章的翻译在&lt;a href=&quot;http://molunerfinn.com/Electron-vs-nwjs-part2/&quot;&gt;这里&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;公平比较&quot;&gt;公平比较&lt;/h3&gt;&lt;p&gt;出于公平公开的考虑，我将这两个工具的准确版本公布如下：  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Electron v0.25.2&lt;/li&gt;
&lt;li&gt;nwjs v0.12.0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在写这篇文章的时候，它们都是最新的版本。 &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;译者注：原文发表于2015年5月6号  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Electron官方有篇很好的文章阐述了&lt;a href=&quot;https://github.com/atom/electron/blob/master/docs/development/atom-shell-vs-node-webkit.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;他们所认为的electron和nwjs的差异&lt;/a&gt;——要确保你读过它。至于我，那些技术性的差异并不是真正影响我对于这两个工具所持看法的原因，不过（对于你们来说）还是绝对值得关注的。  &lt;/p&gt;
&lt;h3 id=&quot;构建输出&quot;&gt;构建输出&lt;/h3&gt;&lt;p&gt;Electron和nwjs都是十分容易上手的，我曾经各自用它们在几分钟之内就成功运行了应用。&lt;br&gt;然而我注意到了我构建出来的“产品”它们在文件的体积上有着巨大的差异。二者的工程在多平台下转译成二进制文件都有不少不错的说明文档——对于我的应用（18M的压缩过的静态网页内容），从electron里输出的构建文件大小（在OSX下总共117MB，没有asar压缩）明显小于从nwjs里输的构建文件的大小——在OSX下220MB（没有V8引擎的快照版本）。&lt;br&gt;我并没有对于这些工具进行科学的研究，并且很有可能是我自己并没有使一些东西最优化……但是18MB的压缩过的静态网页文件（我的应用）确实被打包成了一个更大的体积（100/200MB）的文件。&lt;br&gt;此外，我采用electron制作的应用貌似启动地更快——这可能只是把从Node背景下启动（electron)和Web背景下启动(nwjs)的二者比较的结果罢了。&lt;/p&gt;
&lt;h3 id=&quot;构建过程&quot;&gt;构建过程&lt;/h3&gt;&lt;p&gt;另一方面，用nwjs来创建跨平台的应用貌似更加容易。&lt;br&gt;我使用grunt为我本地应用进行构建，并且nwjs有着成堆的grunt插件让构建过程平稳而简单。（尽管我实际上并没有尝试为Windows系统构建可执行文件）&lt;br&gt;Electron有些grunt插件——但是它们并不频繁更新，并且使用上来说也有着不少困惑。特别地，&lt;a href=&quot;https://github.com/paulcbetts/grunt-build-atom-shell&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;grunt-build-atom-shell&lt;/a&gt;是一个超级奇怪的插件，你必须告诉它electron使用什么tag/commit以及tag/commit所依赖的Node的定制版本。因为我清楚地知道它们。(所以为什么还要告诉它令我很困惑)  &lt;/p&gt;
&lt;h3 id=&quot;保护源码&quot;&gt;保护源码&lt;/h3&gt;&lt;p&gt;利用nwjs你可以将源文件打包成一个利用某种形式的V8快照版本的可执行文件。我并没有真正深入它是什么或者它是怎么实现的，但是说明里明确地告诉我说你将会因此而造成30%的性能损失。真疼！&lt;br&gt;对于electron，你可以将你的应用打包成一个ASAR文件。这个操作真的是非常，非常简单——因为有个非常棒的grunt插件为你做了这些事！不过让我并不怎么开心的是，我已经能想象到一个ASAR文件将会相对地容易被破解——不过也已经比什么都不做的强。  &lt;/p&gt;
&lt;h3 id=&quot;所以胜者是……&quot;&gt;所以胜者是……&lt;/h3&gt;&lt;p&gt;在这篇文章结束之际，我个人更倾向electron。我喜欢它有一部分原因还来自于Github官方赞助了它——并且&lt;strong&gt;Visual Studio Code&lt;/strong&gt;也基于它发布了release版本，所以这是相当赞的支持。&lt;br&gt;定制的二进制文件对我来说将会有点麻烦，但是剩下的构建过程都挺好。当然，最后的更小体积的可执行文件也是加分项啊！  &lt;/p&gt;
&lt;h3 id=&quot;你的看法是？&quot;&gt;你的看法是？&lt;/h3&gt;&lt;p&gt;有没有谁用了这些工具？你们的看法是什么呢？&lt;br&gt;请随意提供你们的一些观点——我喜欢了解一下是否有其他的注意事项我应该要考虑到的，亦或是我没有做到最好的地方。  &lt;/p&gt;
&lt;p&gt;请分享这篇文章！&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;原文地址：&lt;a href=&quot;http://www.akawebdesign.com/2015/05/06/electron-vs-nwjs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.akawebdesign.com/2015/05/06/electron-vs-nwjs/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;写在前头：最近要写点东西，准确来说是用前端技术写桌面应用。之前曾经对Electron有所了解，最近在查阅资料的时候又发现了一个“新的东西”，叫做nwjs——前身是node-webkit。作为一个还未入坑的人来说，到底选择哪个东西作为我们开发的工具会更好呢？我看了这个作者写的两篇文章，发现应该能给另外想要从事同样开发的或者有兴趣的人一些启发。文章不错，而且没发现有中文译版，所以我给出自己的翻译。只是兴趣之作，有错误之处还请指出。&lt;br&gt;以下是译文：&lt;br&gt;
    
    </summary>
    
      <category term="Web" scheme="https://molunerfinn.com/categories/Web/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/Web/%E6%97%A5%E5%BF%97/"/>
    
      <category term="翻译" scheme="https://molunerfinn.com/categories/Web/%E6%97%A5%E5%BF%97/%E7%BF%BB%E8%AF%91/"/>
    
    
      <category term="前端" scheme="https://molunerfinn.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>一周一部好电影【WEEK93】头脑特工队</title>
    <link href="https://molunerfinn.com/WEEK93/"/>
    <id>https://molunerfinn.com/WEEK93/</id>
    <published>2015-12-19T16:30:00.000Z</published>
    <updated>2015-12-19T16:37:38.496Z</updated>
    
    <content type="html">&lt;p&gt;头脑特工队———————————————————————————————Inside Out&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week93.jpg&quot; alt=&quot;头脑特工队&quot; title=&quot;头脑特工队&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演: 彼特·道格特 / 罗纳尔多·德尔·卡门&lt;/li&gt;
&lt;li&gt;片长: 94分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.7/10(from109,905users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.4/10(from216,156users)&lt;/li&gt;
&lt;li&gt;影  片类型：动画、剧情&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi,各位，这次给大家推荐的是皮克斯的高分动画电影《头脑特工队》。首先这个中文翻译还是有点欠妥。不过我也不知道改怎么让翻译更贴切，总之看着英文Inside Out，再看完整场电影后还是英文原题取得好啊。&lt;br&gt;首先这部电影的创新、想象力真的是太赞。把情绪，记忆，性格等等抽象的东西具象化，有种完全被颠覆的感觉——但是却不得不佩服制作者的想象力。关键是并没有完全脱离我们的认知而肆意天马行空，相对的，正是结合着我们的认知，结合着我们熟悉的东西——比如长期记忆、短期记忆、思维、遗忘等等东西，让我们在看着这部电影的时候，不知不觉得进入那个神奇的世界，结合自身，发现自己的一些问题。我们是去支配情绪还是被情绪支配？&lt;br&gt;人物设计独有风格，情节也一波三折。色彩斑斓，音乐欢快。祝大家观影愉快~&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;头脑特工队———————————————————————————————Inside Out&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week93.jpg&quot; alt=&quot;头脑特工队&quot; title=&quot;头脑特工队&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>一周一部好电影【WEEK92】秘密特工</title>
    <link href="https://molunerfinn.com/WEEK92/"/>
    <id>https://molunerfinn.com/WEEK92/</id>
    <published>2015-12-14T07:55:46.000Z</published>
    <updated>2015-12-14T08:28:35.982Z</updated>
    
    <content type="html">&lt;p&gt;秘密特工———————————————————————————————The Man from U.N.C.L.E.&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/WEEK92.jpg&quot; alt=&quot;秘密特工&quot; title=&quot;秘密特工&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演: 盖·里奇&lt;/li&gt;
&lt;li&gt;片长: 116分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：7.4/10(from101,470users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.0/10(from35,305users)&lt;/li&gt;
&lt;li&gt;影  片类型：剧情、动作&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi各位，本周带来的推荐是由盖里奇导演的《秘密特工》。名字没什么亮点，而且也是中文的意译。不过平凡的译名背后，这部电影的剧情才是吸引我的地方。有别于其他的特工电影，比如《碟中谍》、《007》等，这部电影的开头就有种扑面而来地刺激感，一开始的节奏就是快的。&lt;br&gt;不过张弛有度，快慢衔接地自然，剧情转换的令人瞠目而啼笑才是本片最大的亮点。全片充满着英式幽默，不知不觉就能逗乐观众。而且在剧情上，大大小小的伏笔埋了特别多。本片的剧情转换靠着一个个小伏笔的揭示以及一两个大伏笔的大转弯进行剧情刷新，并且总是令人意想不到。也就是猜不透导演在想什么，也给本片增添了不少的乐趣。而一些夸张的表现和一些大场面的展示也给本片增色不少。&lt;br&gt;不过相比于传统的间谍、特工片，本片在发现问题、解决问题上的一些欠缺却是不容忽视的，这也是它的评分不够高的一点。不过我觉得与其把它当做一部严肃的特工片来看的话，不如把它当做一部欢乐的剧情片来看会更好~&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;秘密特工———————————————————————————————The Man from U.N.C.L.E.&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/WEEK92.jpg&quot; alt=&quot;秘密特工&quot; title=&quot;秘密特工&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>一周一部好电影【WEEK91】老男孩</title>
    <link href="https://molunerfinn.com/WEEK91/"/>
    <id>https://molunerfinn.com/WEEK91/</id>
    <published>2015-12-06T10:12:46.000Z</published>
    <updated>2015-12-06T12:08:40.000Z</updated>
    
    <content type="html">&lt;p&gt;老男孩———————————————————————————————올드보이&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/WEEK91.jpg&quot; alt=&quot;老男孩&quot; title=&quot;老男孩&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演: 朴赞郁&lt;/li&gt;
&lt;li&gt;片长: 120分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.4/10(from326,511users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.2/10(from104,270users)&lt;/li&gt;
&lt;li&gt;影  片类型：悬疑、惊悚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hi，各位。这次又来推荐一部相当不错的韩国电影。电影的名字叫做老男孩（又译为原罪犯）。&lt;br&gt;原罪犯，这个词很有意思。有些事的对与错真的是没有办法有个很好的界定。而看完这个故事之后你也会深深的对自己的价值观产生新的认识。&lt;br&gt;对于剧情来说，这部电影在编剧上也是没小下功夫。以至于你明明知道埋了很多的伏笔但是却始终不知道什么时候揭开谜底——这部电影有点像《追击者》一样，一点一点给你展开真相，但是过程却很令人难受。&lt;br&gt;导演在镜头和关键点的配乐上很有自己的见解。整体的风格是暗色调的电影，虽然压抑，但是一波未平一波又起的剧情也抵掉了不少的视觉疲劳。&lt;br&gt;复仇的路上注定不平。男主人公的经历令人揪心，令人同情但是也同时在问责着人性。揭开谜底的时候，真的会让人觉得整个故事又荒唐又无奈又令人惋惜。&lt;br&gt;同样，演员的演技也是给电影加分的一个筹码。整场电影，心理变化之明显，性格变化之大让人惊叹不已，驾驭地很好，这个真的是很赞的一点。&lt;br&gt;再回来说到原罪犯，这部电影的原罪犯是谁呢，需要你自己来找出。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;老男孩———————————————————————————————올드보이&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/WEEK91.jpg&quot; alt=&quot;老男孩&quot; title=&quot;老男孩&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>一周一部好电影【WEEK90】火星救援</title>
    <link href="https://molunerfinn.com/WEEK90/"/>
    <id>https://molunerfinn.com/WEEK90/</id>
    <published>2015-11-27T15:42:46.000Z</published>
    <updated>2015-11-27T16:17:33.085Z</updated>
    
    <content type="html">&lt;p&gt;火星救援———————————————————————————————The Martian&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week90.jpg&quot; alt=&quot;火星救援&quot; title=&quot;火星救援&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;导演: 雷德利·斯科特&lt;/li&gt;
&lt;li&gt;片长: 144分钟&lt;/li&gt;
&lt;li&gt;IMDB评分：8.2/10(from173,495users)&lt;/li&gt;
&lt;li&gt;豆  瓣评分：8.4/10(from37,212users)&lt;/li&gt;
&lt;li&gt;影  片类型：科幻、剧情&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这几年的科幻电影总是有能让人眼前一亮的。相比于软科幻电影，我还是更喜欢硬科幻电影。相比于软科幻的天马行空，怎么说都行的那种，硬科幻电影不管从剧本、编剧、拍摄、原理解释、准备等等来说都要更小心谨慎。&lt;/p&gt;
&lt;p&gt;这几年的例如《地心引力》（2013），《星际穿越》（2014）都是相当不错的硬科幻、太空题材的电影。而这同时期的两部《重返地球》、《木星上行》等电影的评价就跟它们二者差距甚远了。这些不仅是因为导演、编剧。而更多的是不合情理、过分地天马行空的超出了观众的承受范围了。&lt;/p&gt;
&lt;p&gt;回头来说说火星救援。其实整个电影的情节、结局都已经被这个翻译名暴露地完美无疑。但是还是不妨碍观众对整个过程的关注度。硬科幻的电影对数字和物理会格外重视格外注意地暴露给观众（虽然有些部分为了剧情需要可能会违背一些物理原理），本片也是如此，不断地有新的数字在刷新你与马特蒙德的距离。到最后我们都已经浸入了他在火星的生活中。仿佛就在他的身边看他的一举一动。&lt;/p&gt;
&lt;p&gt;带入感太强了。因为太接近我们的认知与我们的生活了。所以格外真实，同时也格外感人。男主的精湛的演技也让我们看出了一个内心强大的宇航员的基本素养。美国式的幽默贯穿全片，给一部其实挺严肃的电影带来了时不时的气氛调节。荒凉而广袤的火星平原、跌宕起伏的剧情、令人发笑而感动的背景音乐、音效、火箭发射的、宇宙飞船的视觉特效等等这些都是让这部电影留住观众注意的点。&lt;/p&gt;
&lt;p&gt;全程没有尿点，并且有特殊彩蛋，不妨看看。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;火星救援———————————————————————————————The Martian&lt;br&gt;&lt;img src=&quot;http://7xog0l.com1.z0.glb.clouddn.com/week90.jpg&quot; alt=&quot;火星救援&quot; title=&quot;火星救援&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="周电" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/"/>
    
      <category term="日志" scheme="https://molunerfinn.com/categories/%E5%91%A8%E7%94%B5/%E6%97%A5%E5%BF%97/"/>
    
    
      <category term="电影" scheme="https://molunerfinn.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
</feed>
